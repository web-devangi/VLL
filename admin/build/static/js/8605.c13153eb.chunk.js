"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[8605],{75049:(e,t,a)=>{a.d(t,{Z:()=>o});var s=a(10976),n=(a(47313),a(47168)),l=a(24511),i=a(2717),r=a(97421),d=a(46417);function o(e){let{setLocation:t,form:a,item:o,idx:c,defaultLang:u}=e;const{t:m}=(0,l.$)(),{google_map_key:g}=(0,i.v9)((e=>e.globalSettings.settings),i.wU),{ref:p}=(0,n.usePlacesWidget)({apiKey:g||r.kr,onPlaceSelected:e=>{const s={lat:null===e||void 0===e?void 0:e.geometry.location.lat(),lng:null===e||void 0===e?void 0:e.geometry.location.lng()};t(s),a.setFieldsValue({["address[".concat(u,"]")]:null===e||void 0===e?void 0:e.formatted_address})}});return(0,d.jsx)(s.Z.Item,{label:m("address"),name:"address[".concat(null===o||void 0===o?void 0:o.locale,"]"),rules:[{required:(null===o||void 0===o?void 0:o.locale)===u,message:m("required")}],hidden:(null===o||void 0===o?void 0:o.locale)!==u,children:(0,d.jsx)("input",{className:"address-input",ref:p,placeholder:""})},"address"+c)}},80812:(e,t,a)=>{a.d(t,{Z:()=>F});var s=a(47313),n=a(10976),l=a(45705),i=a(59491),r=a(97890),d=a(68197),o=a(59624),c=a(77181),u=a(66672),m=a(86345),g=a(16124),p=a(46155),h=a(74294),x=a(52421),Z=a(49986),j=a(2717),v=a(24511),_=a(30763),f=a(97388),y=a(75049),b=a(5764),w=a(98447),I=a(74551),q=a(45005),L=a(13622),S=a(61197),k=a(46417);const O=e=>{let{logoImage:t,setLogoImage:a,backImage:l,setBackImage:r,form:O,location:A,setLocation:P,user:C}=e;const{t:F}=(0,v.$)(),[E,M]=(0,s.useState)(null),[N,B]=(0,s.useState)(null),[R,U]=(0,s.useState)(null),{defaultLang:T,languages:G}=(0,j.v9)((e=>e.formLang),j.wU);const H=()=>{M(!0),U(!0)},Y=()=>{B(!0),U(!0)},D=()=>{M(!1),B(!1)};return(0,k.jsxs)(d.Z,{gutter:12,children:[(0,k.jsx)(o.Z,{span:24,children:(0,k.jsx)(c.Z,{children:(0,k.jsxs)(d.Z,{gutter:12,children:[(0,k.jsx)(o.Z,{span:4,children:(0,k.jsx)(n.Z.Item,{label:F("logo.image"),children:(0,k.jsx)(b.Z,{type:"shops/logo",imageList:t,setImageList:a,form:O,multiple:!1,name:"logo_img"})})}),(0,k.jsx)(o.Z,{span:4,children:(0,k.jsx)(n.Z.Item,{label:F("background.image"),children:(0,k.jsx)(b.Z,{type:"shops/background",imageList:l,setImageList:r,form:O,multiple:!1,name:"background_img"})})}),(0,k.jsx)(o.Z,{span:10,children:(0,k.jsx)(n.Z.Item,{label:F("status.note"),name:"status_note",children:(0,k.jsx)(x.Z,{rows:4})})}),(0,k.jsx)(o.Z,{span:4,children:(0,k.jsx)(n.Z.Item,{name:"status",label:F("status"),children:(0,k.jsx)(u.Z,{disabled:!0})})}),(0,k.jsx)(o.Z,{span:2,children:(0,k.jsx)(n.Z.Item,{label:F("open"),name:"open",valuePropName:"checked",children:(0,k.jsx)(m.Z,{disabled:!0})})})]})})}),(0,k.jsx)(o.Z,{span:24,children:(0,k.jsx)(c.Z,{title:F("general"),children:(0,k.jsxs)(d.Z,{gutter:12,children:[(0,k.jsx)(o.Z,{span:12,children:(0,k.jsxs)(d.Z,{gutter:12,children:[(0,k.jsx)(o.Z,{span:24,children:G.map(((e,t)=>(0,k.jsx)(n.Z.Item,{label:F("title"),name:"title[".concat(e.locale,"]"),rules:[{required:e.locale===T,message:F("required")},{min:2,message:F("title.required")}],hidden:e.locale!==T,children:(0,k.jsx)(u.Z,{})},"title"+t)))}),(0,k.jsx)(o.Z,{span:24,children:(0,k.jsx)(n.Z.Item,{label:F("phone"),name:"phone",rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(g.Z,{min:0,className:"w-100"})})})]})}),(0,k.jsx)(o.Z,{span:12,children:G.map(((e,t)=>(0,k.jsx)(n.Z.Item,{label:F("description"),name:"description[".concat(e.locale,"]"),rules:[{required:e.locale===T,message:F("required")},{min:3,message:F("required")}],hidden:e.locale!==T,children:(0,k.jsx)(x.Z,{rows:4})},"desc"+t)))}),(0,k.jsx)(o.Z,{span:8,children:(0,k.jsx)(n.Z.Item,{label:F("restaurant.tags"),name:"tags",rules:[{required:!1,message:F("required")}],children:(0,k.jsx)(L.R,{mode:"multiple",fetchOptions:async function(e){U(!1);const t={search:e};return S.Z.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:(null===(t=e.translation)||void 0===t?void 0:t.title)||"no name",value:e.id}}))}))},refetch:R})})}),(0,k.jsx)(o.Z,{span:8,children:(0,k.jsx)(n.Z.Item,{label:F("seller"),name:"user",rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(L.R,{disabled:C,fetchOptions:async function(e){const t={search:e,roles:"user","empty-shop":1};return U(!1),Z.Z.search(t).then((e=>e.data.map((e=>({label:e.firstname+" "+(e.lastname?e.lastname:""),value:e.id})))))},refetch:R,dropdownRender:e=>(0,k.jsxs)(k.Fragment,{children:[e,(0,k.jsx)(p.Z,{style:{margin:"8px 0"}}),(0,k.jsx)(i.Z,{className:"w-100",disabled:C,icon:(0,k.jsx)(w.Z,{}),onClick:H,children:F("add.user")})]})})})}),(0,k.jsx)(o.Z,{span:8,children:(0,k.jsx)(n.Z.Item,{label:F("categories"),name:"categories",rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(L.R,{mode:"multiple",fetchOptions:async function(e){const t={search:e,type:"shop"};return U(!1),_.Z.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t;return{label:(null===(t=e.translation)||void 0===t?void 0:t.title)||"no name",value:e.id}}))}))},refetch:R,dropdownRender:e=>(0,k.jsxs)(k.Fragment,{children:[e,(0,k.jsx)(p.Z,{style:{margin:"8px 0"}}),(0,k.jsx)(i.Z,{className:"w-100",icon:(0,k.jsx)(w.Z,{}),onClick:Y,children:F("add.category")})]})})})})]})})}),(0,k.jsx)(o.Z,{span:8,children:(0,k.jsx)(c.Z,{title:F("delivery"),children:(0,k.jsxs)(d.Z,{gutter:8,children:[(0,k.jsx)(o.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{name:"price",label:F("min.price"),rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(g.Z,{className:"w-100"})})}),(0,k.jsx)(o.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{name:"price_per_km",label:F("price.per.km"),rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(g.Z,{className:"w-100"})})})]})})}),(0,k.jsx)(o.Z,{span:8,children:(0,k.jsx)(c.Z,{title:F("delivery.time"),children:(0,k.jsxs)(d.Z,{gutter:12,children:[(0,k.jsx)(o.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{name:"delivery_time_type",label:F("delivery_time_type"),rules:[{required:!0,message:F("required")}],children:(0,k.jsxs)(h.Z,{className:"w-100",children:[(0,k.jsx)(h.Z.Option,{value:"minute",label:F("minutes")}),(0,k.jsx)(h.Z.Option,{value:"hour",label:F("hour")})]})})}),(0,k.jsx)(o.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{name:"delivery_time_from",label:F("delivery_time_from"),rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(g.Z,{className:"w-100"})})}),(0,k.jsx)(o.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{name:"delivery_time_to",label:F("delivery_time_to"),rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(g.Z,{className:"w-100"})})})]})})}),(0,k.jsx)(o.Z,{span:8,children:(0,k.jsx)(c.Z,{title:F("order.info"),children:(0,k.jsxs)(d.Z,{gutter:12,children:[(0,k.jsx)(o.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{label:F("min.amount"),name:"min_amount",rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(g.Z,{min:0,className:"w-100"})})}),(0,k.jsx)(o.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{label:F("tax"),name:"tax",rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(g.Z,{min:0,addonAfter:"%",className:"w-100"})})}),(0,k.jsx)(o.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{label:F("admin.comission"),name:"percentage",rules:[{required:!0,message:F("required")}],children:(0,k.jsx)(g.Z,{min:0,className:"w-100",addonAfter:"%"})})})]})})}),(0,k.jsx)(o.Z,{span:24,children:(0,k.jsx)(c.Z,{title:F("address"),children:(0,k.jsxs)(d.Z,{gutter:12,children:[(0,k.jsx)(o.Z,{span:12,children:G.map(((e,t)=>(0,k.jsx)(y.Z,{setLocation:P,form:O,item:e,idx:t,defaultLang:T},t)))}),(0,k.jsx)(o.Z,{span:24,children:(0,k.jsx)(f.Z,{location:A,setLocation:P,setAddress:e=>O.setFieldsValue({["address[".concat(T,"]")]:e})})})]})})}),E&&(0,k.jsx)(I.Z,{visible:E,handleCancel:()=>D()}),N&&(0,k.jsx)(q.Z,{visible:N,handleCancel:()=>D()})]})};var A=a(90954),P=a(53149),C=a(17649);const F=e=>{var t,a,d,o,c,u,m,g,p;let{next:h,action_type:x="",user:Z}=e;const{t:_}=(0,v.$)(),[f]=n.Z.useForm(),y=(0,r.s0)(),b=(0,j.I0)(),{uuid:w}=(0,r.UO)(),{activeMenu:I}=(0,j.v9)((e=>e.menu),j.wU),[q,L]=(0,s.useState)(!1),[S,F]=(0,s.useState)(null!==(t=I.data)&&void 0!==t&&t.logo_img?[null===(a=I.data)||void 0===a?void 0:a.logo_img]:[]),[E,M]=(0,s.useState)(null!==(d=I.data)&&void 0!==d&&d.background_img?[null===(o=I.data)||void 0===o?void 0:o.background_img]:[]),{settings:N}=(0,j.v9)((e=>e.globalSettings),j.wU),[B,R]=(0,s.useState)(null!==I&&void 0!==I&&null!==(c=I.data)&&void 0!==c&&c.location?{lat:parseFloat(null===I||void 0===I||null===(u=I.data)||void 0===u||null===(m=u.location)||void 0===m?void 0:m.latitude),lng:parseFloat(null===I||void 0===I||null===(g=I.data)||void 0===g||null===(p=g.location)||void 0===p?void 0:p.longitude)}:(0,C.Z)(N));(0,s.useEffect)((()=>()=>{const e=f.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),b((0,A.nc)({activeMenu:I,data:{...I.data,...e}}))}),[]);return(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)(n.Z,{form:f,name:"basic",layout:"vertical",onFinish:e=>{var t,a,s;L(!0);const n={...e,"images[0]":null===(t=S[0])||void 0===t?void 0:t.name,"images[1]":null===(a=E[0])||void 0===a?void 0:a.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to,delivery_time_from:e.delivery_time_from,categories:e.categories.map((e=>e.value)),tags:null===e||void 0===e||null===(s=e.tags)||void 0===s?void 0:s.map((e=>e.value)),user_id:e.user.value,open:void 0,"location[latitude]":B.lat,"location[longitude]":B.lng,user:void 0,delivery_time:0,type:"restaurant"};"edit"===x?function(e,t){P.Z.update(w,t).then((()=>{b((0,A.nc)({activeMenu:I,data:e})),h()})).catch((e=>console.error(e))).finally((()=>L(!1)))}(e,n):function(e,t){P.Z.create(t).then((t=>{let{data:a}=t;b((0,A.SS)({id:"restaurant-".concat(a.uuid),url:"restaurant/".concat(a.uuid),name:_("add.restaurant"),data:{...a,background_img:{name:null===a||void 0===a?void 0:a.background_img},logo_img:{name:null===a||void 0===a?void 0:a.logo_img},...e},refetch:!1})),y("/restaurant/".concat(a.uuid,"?step=1"))})).catch((e=>console.error(e))).finally((()=>L(!1)))}(e,n)},initialValues:{open:!1,status:"new",...I.data},children:[(0,k.jsx)(O,{logoImage:S,setLogoImage:F,backImage:E,setBackImage:M,form:f,location:B,setLocation:R,user:Z}),(0,k.jsx)(l.Z,{children:(0,k.jsx)(i.Z,{type:"primary",htmlType:"submit",loading:q,children:_("next")})})]})})}},49062:(e,t,a)=>{a.r(t),a.d(t,{default:()=>h,steps:()=>p});var s=a(47313),n=a(2717),l=a(73431),i=a(24511),r=a(83999),d=a(77181),o=a(80812),c=a(48662),u=a(47918),m=a(46417);const{Step:g}=r.Z,p=[{title:"restaurant",content:"First-content"},{title:"map",content:"Second-content"},{title:"delivery",content:"Third-content"}],h=()=>{var e;const{t:t}=(0,i.$)(),{activeMenu:a}=(0,n.v9)((e=>e.menu),n.wU),[h,x]=(0,s.useState)((null===(e=a.data)||void 0===e?void 0:e.step)||0),Z=()=>{x(h+1)},j=()=>{x(h-1)};return(0,m.jsxs)(d.Z,{title:t("add.restaurant"),extra:(0,m.jsx)(l.Z,{}),children:[(0,m.jsx)(r.Z,{current:h,children:p.map((e=>(0,m.jsx)(g,{title:t(e.title)},e.title)))}),(0,m.jsxs)("div",{className:"steps-content",children:["First-content"===p[h].content&&(0,m.jsx)(o.Z,{next:Z,user:!1}),"Second-content"===p[h].content&&(0,m.jsx)(u.Z,{next:Z,prev:j}),"Third-content"===p[h].content&&(0,m.jsx)(c.Z,{next:Z,prev:j})]})]})}},48662:(e,t,a)=>{a.d(t,{Z:()=>p});var s=a(10976),n=a(47313),l=a(51282),i=a(70816),r=a.n(i),d=a(78790),o=a(49682),c=a(97890),u=a(21429),m=a(22899),g=a(46417);const p=e=>{let{next:t,prev:a}=e;const[i]=s.Z.useForm(),[p,h]=(0,n.useState)([]),[x,Z]=(0,n.useState)(new Array(7).fill(!1)),[j,v]=(0,n.useState)(!1),[_,f]=(0,n.useState)(!1),{uuid:y}=(0,c.UO)();return(0,n.useEffect)((()=>{i.setFieldsValue({working_days:u.P}),y&&(f(!0),o.Z.getById(y).then((e=>{h(e.data.closed_dates.filter((e=>e.day>r()(new Date).format("YYYY-MM-DD"))).map((e=>new Date(e.day))))})),d.Z.getById(y).then((e=>{Z(0!==e.data.dates.length?e.data.dates.map((e=>e.disabled)):[]),0!==e.data.dates.length&&i.setFieldsValue({working_days:e.data.dates.map((e=>({title:e.day,from:r()(e.from,"HH:mm:ss"),to:r()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)})))})})).finally((()=>f(!1))))}),[]),(0,g.jsx)(g.Fragment,{children:_?(0,g.jsx)(l.Z,{}):(0,g.jsx)(m.Z,{onFinish:e=>{v(!0);const a={dates:p?p.map((e=>r()(e).format("YYYY-MM-DD"))):void 0},s={dates:e.working_days.map((e=>({day:e.title,from:r()(e.from?e.from:"00").format("HH-mm"),to:r()(e.to?e.to:"00").format("HH-mm"),disabled:e.disabled})))};o.Z.update(y,a).then((()=>{t()})).finally((()=>v(!1))),0!==e.working_days.length&&d.Z.update(y,s).then((()=>{t()})).finally((()=>v(!1)))},prev:a,form:i,lines:x,loadingBtn:j,days:p,setDays:h,setLines:Z,weeks:u.P})})}},56236:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GOOGLE_MAP_SCRIPT_BASE_URL=void 0;t.GOOGLE_MAP_SCRIPT_BASE_URL="https://maps.googleapis.com/maps/api/js"},39003:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.loadGoogleMapScript=t.isBrowser=void 0;var a="undefined"!==typeof window&&window.document;t.isBrowser=a;t.loadGoogleMapScript=function(e,t){if(!a)return Promise.resolve();if("undefined"!==typeof google&&google.maps&&google.maps.api)return Promise.resolve();var s=document.querySelectorAll('script[src*="'.concat(e,'"]'));if(s&&s.length)return new Promise((function(e){if("undefined"!==typeof google)return e();s[0].addEventListener("load",(function(){return e()}))}));var n=new URL(t);n.searchParams.set("callback","__REACT_GOOGLE_AUTOCOMPLETE_CALLBACK__");var l=document.createElement("script");return l.src=n.toString(),new Promise((function(e){window.__REACT_GOOGLE_AUTOCOMPLETE_CALLBACK__=e,document.body.appendChild(l)}))}}}]);