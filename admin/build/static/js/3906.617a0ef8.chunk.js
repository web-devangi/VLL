"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[3906],{49655:(e,t,l)=>{l.d(t,{_:()=>d});var i=l(47313),n=l(12279),a=l.n(n),s=l(74294),o=l(72652),r=l(46417);const d=e=>{let{fetchOptions:t,debounceTimeout:l=400,hasMore:n,...d}=e;const[c,u]=(0,i.useState)(!1),[v,h]=(0,i.useState)([]),[g,p]=(0,i.useState)(!1),[m,x]=(0,i.useState)(null),[Z,j]=(0,i.useState)(1),f=(0,i.useMemo)((()=>a()((e=>{h([]),x(e),u(!0),t({search:e}).then((e=>{h(e),j(2),u(!1)})).finally((()=>p(!1)))}),l)),[t,l,Z]);return(0,r.jsxs)(s.Z,{showSearch:!0,allowClear:!0,onPopupScroll:async e=>{const l=e.target;g||l.scrollTop+l.offsetHeight!==l.scrollHeight||n&&(p(!0),l.scrollTo(0,l.scrollHeight),t({search:m,page:Z}).then((e=>{j((e=>e+1)),h([...v,...e])})).finally((()=>p(!1))))},labelInValue:!0,filterOption:!1,onSearch:f,notFoundContent:c?(0,r.jsx)(o.Z,{size:"small"}):"no results",onFocus:()=>{v.length||f("")},...d,children:[v.map(((e,t)=>(0,r.jsx)(s.Z.Option,{value:e.value,children:e.label},t))),g&&(0,r.jsx)(s.Z.Option,{children:(0,r.jsx)(o.Z,{size:"small"})})]})}},73431:(e,t,l)=>{l.d(t,{Z:()=>d});var i=l(47313),n=l(39180),a=l(2717),s=l(28830),o=l(60535),r=l(46417);const d=()=>{const e=(0,a.I0)(),{languages:t,defaultLang:l}=(0,a.v9)((e=>e.formLang),a.wU);(0,i.useEffect)((()=>{o.Z.getAllActive().then((t=>{let{data:l}=t;e((0,s.dc)(l)),e((0,s.mh)(l.find((e=>1===e.default)).locale))}))}),[]);return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.ZP.Group,{value:l,onChange:t=>{let{target:{value:l}}=t;e((0,s.mh)(l))},className:"float-right",buttonStyle:"solid",children:null===t||void 0===t?void 0:t.map((e=>(0,r.jsx)(n.ZP.Button,{value:e.locale,children:e.title},e.id)))})})}},41481:(e,t,l)=>{l.d(t,{Z:()=>r});var i=l(47313),n=l(66672),a=l(16031),s=l(40765),o=l(46417);function r(e){let{handleChange:t,defaultValue:l,resetSearch:r,...d}=e;const[c,u]=(0,i.useState)(l),v=(0,i.useMemo)((()=>(0,a.debounce)((e=>{t(e)}),800)),[]);return(0,i.useEffect)((()=>{u(l)}),[r]),(0,o.jsx)(n.Z,{value:c,onChange:e=>{u(e.target.value),v(e.target.value)},prefix:(0,o.jsx)(s.Z,{}),...d})}},43906:(e,t,l)=>{l.r(t),l.d(t,{default:()=>A});var i=l(47313),n=l(86345),a=l(45705),s=l(59491),o=l(77181),r=l(78508),d=l(29466),c=l(97890),u=l(74580),v=l(2717),h=l(90954),g=l(23560),p=l(24511),m=l(3225),x=l(41481),Z=l(80314),j=l(47139),f=l(10976),y=l(9274),b=l(72652),S=l(68197),_=l(59624),C=l(66672),k=l(73431),I=l(49655),w=l(27453),O=l(46417);function P(e){let{visible:t,setVisible:l,id:a,setId:o}=e;const[r]=f.Z.useForm(),d=(0,v.I0)(),{t:c}=(0,p.$)(),{defaultLang:u,languages:h}=(0,v.v9)((e=>e.formLang),v.wU),[x,Z]=(0,i.useState)(!1),[P,z]=(0,i.useState)(!1),[V,A]=(0,i.useState)(null),E=()=>{A(null),l(!1),r.resetFields(),o(null)};function F(e){if(null===e||void 0===e||!e.translations)return{};const{translations:t}=e,l=h.map((e=>{var l;return{["title[".concat(e.locale,"]")]:null===(l=t.find((t=>t.locale===e.locale)))||void 0===l?void 0:l.title}}));return Object.assign({},...l)}return(0,i.useEffect)((()=>{a&&(z(!0),j.Z.show(a).then((e=>{let{data:t}=e;A(t),r.setFieldsValue({active:null===t||void 0===t?void 0:t.active,code:null===t||void 0===t?void 0:t.code,region_id:{label:t.region.translation.title,value:t.region.id},...F(t)})})).finally((()=>z(!1))))}),[a]),(0,O.jsx)(y.Z,{visible:t,onCancel:E,onOk:E,footer:null,loading:P,title:c("add.country"),children:(0,O.jsxs)(f.Z,{form:r,onFinish:e=>{Z(!0),null!==V&&void 0!==V&&V.id?(e=>{var t;j.Z.update(V.id,{region_id:null===e||void 0===e||null===(t=e.region_id)||void 0===t?void 0:t.value,active:e.active,code:e.code,title:{...Object.assign({},...h.map((t=>({[t.locale]:e["title[".concat(t.locale,"]")]}))))}}).then((()=>{g.Am.success(c("successfully.updated")),(0,v.dC)((()=>{d((0,m.t)({}))})),E()})).finally((()=>Z(!1)))})(e):(e=>{var t;j.Z.create({active:e.active,code:e.code,region_id:null===e||void 0===e||null===(t=e.region_id)||void 0===t?void 0:t.value,title:{...Object.assign({},...h.map((t=>({[t.locale]:e["title[".concat(t.locale,"]")]}))))}}).then((()=>{g.Am.success(c("successfully.added")),(0,v.dC)((()=>{d((0,m.t)({}))})),E()})).finally((()=>Z(!1)))})(e)},layout:"vertical",initialValues:{active:!0},children:[(0,O.jsx)(b.Z,{spinning:P,children:(0,O.jsxs)(S.Z,{gutter:24,children:[(0,O.jsx)(_.Z,{span:24,children:(0,O.jsx)(k.Z,{})}),(0,O.jsx)(_.Z,{span:24,children:h.map((e=>(0,O.jsx)(f.Z.Item,{label:c("title"),name:"title[".concat(e.locale,"]"),hidden:e.locale!==u,rules:[{validator:(t,l)=>l||(null===e||void 0===e?void 0:e.locale)!==u?l&&""===(null===l||void 0===l?void 0:l.trim())?Promise.reject(new Error(c("no.empty.space"))):l&&(null===l||void 0===l?void 0:l.trim().length)<2?Promise.reject(new Error(c("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(c("required")))}],children:(0,O.jsx)(C.Z,{})},"title"+e.id)))}),(0,O.jsx)(_.Z,{span:24,children:(0,O.jsx)(f.Z.Item,{name:"region_id",label:c("region_id"),rules:[{required:!0,message:c("required")}],children:(0,O.jsx)(I._,{fetchOptions:e=>{let{search:t,page:l}=e;return w.Z.get({search:t,page:l,has_price:!0}).then((e=>e.data.map((e=>{var t;return{label:null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id}}))))}})})}),(0,O.jsx)(_.Z,{span:24,children:(0,O.jsx)(f.Z.Item,{label:c("code"),name:"code",children:(0,O.jsx)(C.Z,{})})}),(0,O.jsx)(_.Z,{span:4,children:(0,O.jsx)(f.Z.Item,{label:c("active"),name:"active",valuePropName:"checked",children:(0,O.jsx)(n.Z,{defaultChecked:!0})})})]})}),(0,O.jsx)(s.Z,{type:"primary",htmlType:"submit",loading:x,children:c("submit")})]})})}var z=l(12019),V=l(47515);const A=()=>{const{t:e}=(0,p.$)(),t=(0,v.I0)(),l=(0,c.s0)(),{setIsModalVisible:f}=(0,i.useContext)(u._);let[y,b]=(0,d.lr)();const{activeMenu:S}=(0,v.v9)((e=>e.menu),v.wU),_=null===S||void 0===S?void 0:S.data,C=y.get("region_id"),{list:k,meta:I,loading:w}=(0,v.v9)((e=>e.deliveryCountries),v.wU),[A,E]=(0,i.useState)(!1),[F,M]=(0,i.useState)(!1),[L,T]=(0,i.useState)(!1),[U,q]=(0,i.useState)(null),B=[{title:e("id"),dataIndex:"id",key:"id"},{title:e("name"),dataIndex:"translation",key:"translation",render:(i,n)=>(0,O.jsx)("div",{style:{cursor:"pointer",textDecoration:"underline"},onClick:()=>(i=>{t((0,h.bL)({url:"deliveryzone/city?country_id=".concat(i.id),id:"city",name:e("city")})),l("/deliveryzone/city?country_id=".concat(i.id))})(n),children:(null===i||void 0===i?void 0:i.title)||"-"})},{title:e("active"),dataIndex:"active",key:"active",render:(l,i)=>(0,O.jsx)(n.Z,{onChange:()=>(l=>{E(l),j.Z.status(l).then((()=>{f(!1),t((0,m.t)({region_id:C})),g.Am.success(e("successfully.updated"))})).finally((()=>{E(null)}))})(i.id),checked:l,loading:Boolean(A===i.id)},i.id)},{title:e("options"),dataIndex:"options",is_show:!0,render:(l,i)=>(0,O.jsxs)(a.Z,{children:[(0,O.jsx)(s.Z,{type:"primary",icon:(0,O.jsx)(z.Z,{}),onClick:()=>(e=>{M(!0),q(e)})(i.id)}),(0,O.jsx)(s.Z,{loading:Boolean(L===i.id),icon:(0,O.jsx)(V.Z,{onClick:()=>(l=>{T(l),j.Z.delete(l).then((()=>{t((0,m.t)()),g.Am.success(e("successfully.deleted"))})).finally((()=>{T(!1)}))})(i.id)})})]})}];(0,i.useEffect)((()=>{S.refetch&&(t((0,m.t)({region_id:C})),t((0,h.A_)(S)))}),[S.refetch]),(0,Z.Z)((()=>{const e={search:null===_||void 0===_?void 0:_.search,region_id:C};t((0,m.t)(e))}),[null===S||void 0===S?void 0:S.data]);return(0,O.jsxs)(o.Z,{title:e("countries"),extra:(0,O.jsxs)(a.Z,{children:[(0,O.jsx)(x.Z,{placeholder:e("search"),handleChange:e=>{return l=e,i="search",void t((0,h.nc)({activeMenu:S,data:{..._,[i]:l}}));var l,i},defaultValue:null===_||void 0===_?void 0:_.search,resetSearch:!(null!==_&&void 0!==_&&_.search)}),(0,O.jsx)(s.Z,{type:"primary",onClick:()=>M(!0),children:e("add.country")})]}),children:[(0,O.jsx)(r.Z,{columns:B,dataSource:k,pagination:{pageSize:I.per_page,page:I.current_page,total:I.total},rowKey:e=>e.id,loading:w,onChange:e=>{const{pageSize:l,current:i}=e;t((0,m.t)({perPage:l,page:i,region_id:C}))}}),(0,O.jsx)(P,{visible:F,setVisible:M,id:U,setId:q})]})}}}]);