"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[4630],{13945:(e,l,n)=>{function d(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}n.d(l,{Z:()=>d})},84630:(e,l,n)=>{n.r(l),n.d(l,{default:()=>A});var d=n(47313),i=n(45705),a=n(26824),t=n(66204),o=n(59491),s=n(77181),r=n(78508),u=n(2717),v=n(90954),c=n(24511),h=n(33175),m=n(80314),x=n(13945),p=n(12019),j=n(31741),g=n(9274),Z=n(83371),b=n(46417);function f(e){var l,n,d,i,a,t,s,r,u,v;let{data:h,handleClose:m}=e;const{t:x}=(0,c.$)();return(0,b.jsx)(g.Z,{title:x("request.details"),visible:!!h,onCancel:m,footer:(0,b.jsx)(o.Z,{type:"default",onClick:m,children:x("cancel")}),children:(0,b.jsxs)(Z.Z,{bordered:!0,children:[(0,b.jsx)(Z.Z.Item,{span:3,label:x("id"),children:null===h||void 0===h?void 0:h.id}),(0,b.jsx)(Z.Z.Item,{span:3,label:x("firstname"),children:x(null===h||void 0===h||null===(l=h.model)||void 0===l?void 0:l.firstname)}),(0,b.jsx)(Z.Z.Item,{span:3,label:x("lastname"),children:x(null===h||void 0===h||null===(n=h.model)||void 0===n?void 0:n.lastname)}),(0,b.jsxs)(Z.Z.Item,{span:3,label:x("car"),children:[x(null===h||void 0===h||null===(d=h.data)||void 0===d?void 0:d.brand)," ",x(null===h||void 0===h||null===(i=h.data)||void 0===i?void 0:i.model)]}),(0,b.jsx)(Z.Z.Item,{span:3,label:x("car.number"),children:x(null===h||void 0===h||null===(a=h.data)||void 0===a?void 0:a.number)}),(0,b.jsx)(Z.Z.Item,{span:3,label:x("color"),children:x(null===h||void 0===h||null===(t=h.data)||void 0===t?void 0:t.color)}),(0,b.jsxs)(Z.Z.Item,{span:3,label:x("height"),children:[x(null===h||void 0===h||null===(s=h.data)||void 0===s?void 0:s.height),"  ",x("m")]}),(0,b.jsxs)(Z.Z.Item,{span:3,label:x("width"),children:[x(null===h||void 0===h||null===(r=h.data)||void 0===r?void 0:r.width),"  ",x("m")]}),(0,b.jsx)(Z.Z.Item,{span:3,label:x("status"),children:null!==h&&void 0!==h&&null!==(u=h.data)&&void 0!==u&&u.online?x("online"):x("offline")}),(0,b.jsx)(Z.Z.Item,{span:3,label:x("fuel"),children:x(null===h||void 0===h||null===(v=h.data)||void 0===v?void 0:v.type_of_technique)})]})})}var w=n(10976),y=n(68197),C=n(59624),I=n(74294),k=n(66672);const _=["pending","approved","canceled"];function S(e){let{data:l,handleClose:n,handleChange:i}=e;const{t:a}=(0,c.$)(),[t]=w.Z.useForm(),[s,r]=(0,d.useState)(!1),[u,v]=(0,d.useState)(null===l||void 0===l?void 0:l.status);return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(g.Z,{title:a("status.change"),visible:!!l,onCancel:n,footer:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.Z,{type:"default",onClick:n,children:a("cancel")}),(0,b.jsx)(o.Z,{type:"primary",onClick:()=>t.submit(),loading:s,children:a("save")})]}),children:(0,b.jsx)(w.Z,{form:t,layout:"vertical",onFinish:e=>{r(!0),i(null===l||void 0===l?void 0:l.id,e).finally((()=>r(!1)))},initialValues:{status:null===l||void 0===l?void 0:l.status},children:(0,b.jsx)(y.Z,{gutter:12,children:(0,b.jsxs)(C.Z,{span:24,children:[(0,b.jsx)(w.Z.Item,{label:a("status"),name:"status",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(I.Z,{onChange:e=>v(e),children:_.map(((e,l)=>(0,b.jsx)(I.Z.Option,{value:e,children:a(e)},e+l)))})}),"canceled"===u?(0,b.jsx)(w.Z.Item,{name:"status_note",label:a("note"),rules:[{validator:(e,l)=>l?l&&""===(null===l||void 0===l?void 0:l.trim())?Promise.reject(new Error(a("no.empty.space"))):l&&(null===l||void 0===l?void 0:l.trim().length)<2?Promise.reject(new Error(a("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(a("required")))}],children:(0,b.jsx)(k.Z.TextArea,{maxLength:250,showCount:!0})}):""]})})})})})}var P=n(14349),q=n(23560);function A(){const e=(0,u.I0)(),{t:l}=(0,c.$)(),{activeMenu:n}=(0,u.v9)((e=>e.menu),u.wU),{deliverymanRequestData:g,meta:Z,loading:w}=(0,u.v9)((e=>e.deliverymanRequest),u.wU),[y,C]=(0,d.useState)(null),[I,k]=(0,d.useState)(null),[_,A]=(0,d.useState)(null),z=n.data,E={perPage:null===z||void 0===z?void 0:z.perPage,page:null===z||void 0===z?void 0:z.page,search:null===z||void 0===z?void 0:z.search,columns:null===z||void 0===z?void 0:z.columns};(0,m.Z)((()=>{e((0,h.A)(E))}),[null===n||void 0===n?void 0:n.data]),(0,d.useEffect)((()=>{null!==n&&void 0!==n&&n.refetch&&(e((0,h.A)(E)),e((0,v.A_)(n)))}),[null===n||void 0===n?void 0:n.refetch]);const F={selectedRowKeys:y,onChange:e=>{C(e)}};const R=[{title:l("id"),dataIndex:"id",key:"id",is_show:!0},{title:l("name"),dataIndex:"name",key:"name",is_show:!0,render:(e,l)=>{var n,d;return(null===l||void 0===l||null===(n=l.model)||void 0===n?void 0:n.firstname)+" "+(null===l||void 0===l||null===(d=l.model)||void 0===d?void 0:d.lastname)}},{title:l("delivery.man.setting"),dataIndex:"setting",key:"setting",is_show:!0,render:(e,n)=>{var d,a,t,o;return(0,b.jsx)(i.Z,{children:(0,b.jsxs)("span",{children:[l("brand"),": ",null===n||void 0===n||null===(d=n.data)||void 0===d?void 0:d.brand,(0,b.jsx)("br",{}),l("model"),": ",null===n||void 0===n||null===(a=n.data)||void 0===a?void 0:a.model,(0,b.jsx)("br",{}),l("number"),": ",null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.number,(0,b.jsx)("br",{}),l("color"),": ",null===n||void 0===n||null===(o=n.data)||void 0===o?void 0:o.color]})})}},{title:l("image"),dataIndex:"image",key:"image",is_show:!0,render:(e,l)=>{var n;return(0,b.jsx)(a.Z,{src:(null===l||void 0===l||null===(n=l.data)||void 0===n?void 0:n["images[0]"])||"https://via.placeholder.com/100",alt:"img",width:100,className:"rounded",preview:!0,placeholder:!0})}},{title:l("status"),dataIndex:"status",key:"status",is_show:!0,render:(e,n)=>(0,b.jsxs)("div",{children:["pending"===e?(0,b.jsx)(t.Z,{color:"blue",children:l(e)}):"canceled"===e?(0,b.jsx)(t.Z,{color:"error",children:l(e)}):(0,b.jsx)(t.Z,{color:"cyan",children:l(e)}),n.deleted_at?"":(0,b.jsx)(p.Z,{onClick:()=>A(n)})]})},{title:l("options"),key:"options",dataIndex:"options",is_show:!0,render:(e,l)=>(0,b.jsx)(i.Z,{children:(0,b.jsx)(o.Z,{icon:(0,b.jsx)(j.Z,{}),onClick:e=>{e.stopPropagation(),k(l)}})})}];return(0,b.jsxs)(s.Z,{title:l("deliveryman.request"),children:[(0,b.jsx)(r.Z,{scroll:{x:!0},rowSelection:F,columns:null===R||void 0===R?void 0:R.filter((e=>null===e||void 0===e?void 0:e.is_show)),dataSource:g,pagination:{pageSize:null===Z||void 0===Z?void 0:Z.perPage,total:null===Z||void 0===Z?void 0:Z.total,current:null===z||void 0===z?void 0:z.page,page:(null===z||void 0===z?void 0:z.page)||1,defaultCurrent:null===z||void 0===z?void 0:z.page},onChange:function(l,d,i){const{pageSize:a,current:t}=l,{field:o,order:s}=i,r=(0,x.Z)(s);e((0,v.nc)({activeMenu:n,data:{...null===n||void 0===n?void 0:n.data,perPage:a,page:t,column:o,sort:r}}))},rowKey:e=>null===e||void 0===e?void 0:e.id,loading:w}),I?(0,b.jsx)(f,{data:I,handleClose:()=>k(null)}):null,_?(0,b.jsx)(S,{data:_,handleChange:(d,i)=>{const a={status_note:null===i||void 0===i?void 0:i.status_note,status:null===i||void 0===i?void 0:i.status};return P.Z.changeStatus(d,a).then((()=>{A(null),q.Am.success(l("successfully.updated")),e((0,h.A)(E)),e((0,v.A_)(n))}))},handleClose:()=>A(null)}):null]})}}}]);