"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[1011],{75565:function(e,t,n){n.r(t),n.d(t,{default:function(){return H}});var a=n(29439),i=n(47313),r=n(73591),s=n(97890),l=n(24511),o=n(59308),d=n(1413),c=n(45705),u=n(26824),v=n(59491),h=n(77181),m=n(78508),f=n(9274),x=n(45464),p=n(12019),Z=n(54757),j=n(90954),g=n(2717),y=n(23560),w=n(69658),b=n(74580),k=n(53233),C=n(13945),_=n(80314),I=n(71810),S=n(4901),q=n(14349),P=n(70816),T=n.n(P),M=n(10976),N=n(68197),U=n(59624),z=n(66672),A=n(46417);function E(e){var t=e.data,n=e.handleCancel,r=e.handleOk,s=e.visible,o=(0,l.$)().t,c=M.Z.useForm(),u=(0,a.Z)(c,1)[0],h=(0,i.useState)(!1),m=(0,a.Z)(h,2),x=m[0],p=m[1];return(0,A.jsx)(f.Z,{title:o(t.title),visible:s,onCancel:n,footer:[(0,A.jsx)(v.Z,{type:"primary",onClick:function(){return u.submit()},loading:x,children:o("save")}),(0,A.jsx)(v.Z,{type:"default",onClick:n,children:o("cancel")})],children:(0,A.jsx)(M.Z,{layout:"vertical",onFinish:function(e){p(!0);var t=(0,d.Z)((0,d.Z)({},e),{},{status:"canceled"});r(t)},form:u,children:(0,A.jsx)(M.Z.Item,{children:(0,A.jsx)(N.Z,{className:"mt-4",children:(0,A.jsx)(U.Z,{span:24,children:(0,A.jsx)(M.Z.Item,{name:"status_note",label:o("note"),rules:[{validator:function(e,t){return t?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(o("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(o("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(o("required")))}}],children:(0,A.jsx)(z.Z.TextArea,{maxLength:250,showCount:!0})})})})})})})}var F={type:"category"};function Y(e){var t,n,r,o=e.parentId,P=(e.type,e.activeTab),M=void 0===P?"request":P,N=(0,l.$)().t,U=(0,i.useContext)(b._).setIsModalVisible,z=(0,i.useState)(!1),Y=(0,a.Z)(z,2),H=Y[0],K=Y[1],O=(0,i.useState)(!1),$=(0,a.Z)(O,2),B=$[0],D=$[1],L=(0,i.useState)(!1),R=(0,a.Z)(L,2),W=R[0],V=R[1],G=(0,i.useState)(""),J=(0,a.Z)(G,2),Q=J[0],X=J[1],ee=(0,i.useState)(null),te=(0,a.Z)(ee,2),ne=te[0],ae=te[1],ie=(0,g.I0)(),re=(0,s.s0)(),se=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,le=(0,g.v9)((function(e){return e.requestModels}),g.wU),oe=le.data,de=le.meta,ce=le.loading,ue=le.params,ve=se.data,he=(0,s.UO)().uuid,me={search:null===ve||void 0===ve?void 0:ve.search,sort:null===ve||void 0===ve?void 0:ve.sort,column:null===ve||void 0===ve?void 0:ve.column,perPage:null===ve||void 0===ve?void 0:ve.perPage,page:null===ve||void 0===ve?void 0:ve.page,parent_id:o},fe=(0,i.useState)([{title:N("created.by"),dataIndex:"createdBy",key:"createdBy",is_show:!0,render:function(e){return(0,A.jsxs)("span",{children:[e.firstname," ",null===e||void 0===e?void 0:e.lastname," ",(0,A.jsx)("a",{href:"tel:".concat(null===e||void 0===e?void 0:e.phone),children:null===e||void 0===e?void 0:e.phone})]})}},{title:N("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:function(e){return T()(e).format("YYYY-MM-DD HH:mm")}},{title:N("name"),dataIndex:"name",key:"name",is_show:!0,render:function(e,t){return(0,A.jsxs)(c.Z,{children:[t.model.translation.title," ",(0,A.jsx)(S.WFu,{})," ",t.data.title[t.model.translation.locale]]})}},{title:N("image"),dataIndex:"img",key:"img",is_show:!0,render:function(e,t){return(0,A.jsxs)(c.Z,{children:[(0,A.jsx)(u.Z,{src:(0,x.Z)(t.model.img),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0}),(0,A.jsx)(S.WFu,{}),(0,A.jsx)(u.Z,{src:(0,x.Z)(t.data.images.at(0)),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0})]})}},{title:N("options"),key:"options",dataIndex:"options",is_show:!0,render:function(e,t){return(0,A.jsxs)(c.Z,{children:[(0,A.jsx)(v.Z,{icon:(0,A.jsx)(p.Z,{}),onClick:function(){return function(e){ie((0,j.bL)({url:"category-request/".concat(e.id),id:"request_edit",name:N("request.edit")})),re("/category-request/".concat(e.id),{state:{parentId:o,parentUuid:he}})}(t)}}),"canceled"===(null===t||void 0===t?void 0:t.status)&&(null===t||void 0===t?void 0:t.status_note)&&(0,A.jsx)(v.Z,{icon:(0,A.jsx)(Z.Z,{}),onClick:function(){X(t.status_note),V(!0)}}),(0,A.jsx)(v.Z,{type:"primary",onClick:function(){ae([{id:t.id,status:"approved"}]),U(!0)},children:N("accept")}),(0,A.jsx)(v.Z,{type:"primary",danger:!0,onClick:function(){ae([{id:t.id,status:"canceled"}]),K(!0)},children:N("decline")})]})}}]),xe=(0,a.Z)(fe,2),pe=xe[0],Ze=xe[1];(0,i.useEffect)((function(){se.refetch&&"request"===M&&(ie((0,I.aw)(me)),ie((0,j.A_)(se)))}),[se.refetch]),(0,_.Z)((function(){"request"===M&&ie((0,I.aw)(me))}),[se.data,M]);var je=function(e){D(!0);var t={status:null===ne||void 0===ne?void 0:ne.at(0).status,status_note:null===e||void 0===e?void 0:e.status_note};q.Z.changeStatus(null===ne||void 0===ne?void 0:ne.at(0).id,t).then((function(){y.Am.success(N("successfully.changed")),ie((0,I.aw)(F)),U(!1),ae(null)})).finally((function(){K(!1),D(!1)}))},ge={selectedRowKeys:ne,onChange:function(e){ae(e)}};return(0,A.jsxs)(h.Z,{title:N("requests"),extra:(0,A.jsx)(c.Z,{wrap:!0,children:(0,A.jsx)(k.Z,{columns:pe,setColumns:Ze})}),children:[(0,A.jsx)(m.Z,{scroll:{x:!0},rowSelection:ge,columns:null===pe||void 0===pe?void 0:pe.filter((function(e){return e.is_show})),dataSource:oe,pagination:{pageSize:ue.perPage,page:(null===(t=se.data)||void 0===t?void 0:t.page)||1,total:de.total,defaultCurrent:null===(n=se.data)||void 0===n?void 0:n.page,current:null===(r=se.data)||void 0===r?void 0:r.page},rowKey:function(e){return e.key},onChange:function(e,t,n){var a=e.pageSize,i=e.current,r=n.field,s=n.order,l=(0,C.Z)(s);ie((0,j.nc)({activeMenu:se,data:(0,d.Z)((0,d.Z)({},se.data),{},{perPage:a,page:i,column:r,sort:l})}))},loading:ce}),(0,A.jsx)(w.Z,{click:je,text:N("change.status"),setText:ae,loading:B}),(0,A.jsx)(E,{data:{title:"decline"},visible:H,handleCancel:function(){return K(!1)},handleOk:je,laoding:B}),(0,A.jsxs)(f.Z,{title:"Reject message",closable:!1,visible:W,footer:null,centered:!0,children:[(0,A.jsx)("p",{children:Q}),(0,A.jsx)("div",{className:"d-flex justify-content-end",children:(0,A.jsx)(v.Z,{type:"primary",className:"mr-2",onClick:function(){return V(!1)},children:N("close")})})]})]})}function H(){var e,t,n=(0,l.$)().t,d=(0,s.TH)(),c=(0,g.I0)(),u=(0,g.v9)((function(e){return e.menu}),g.wU).activeMenu,v=(0,i.useState)((null===(e=d.state)||void 0===e?void 0:e.tab)||"list"),h=(0,a.Z)(v,2),m=h[0],f=h[1];return(0,A.jsxs)(r.Z,{defaultActiveKey:(null===(t=d.state)||void 0===t?void 0:t.tab)||"list",destroyInactiveTabPane:!0,onChange:function(e){c((0,j.xo)(u)),f(e)},children:[(0,A.jsx)(r.Z.TabPane,{tab:n("category.list"),children:(0,A.jsx)(o.Z,{activeTab:m})},"list"),(0,A.jsx)(r.Z.TabPane,{tab:n("requests"),children:(0,A.jsx)(Y,{activeTab:m})},"request")]})}}}]);