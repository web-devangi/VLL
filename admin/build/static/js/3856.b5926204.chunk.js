(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[3856],{33834:function(t,n,e){"use strict";e.d(n,{K:function(){return l}});var i=e(4942),a=e(1413),r=e(97890),o=e(74776),u=e.n(o),l=function(){var t=(0,r.s0)(),n=(0,r.TH)(),e=u().parse(n.search,{ignoreQueryPrefix:!0});return{values:e,set:function(n,r){return t({search:u().stringify((0,a.Z)((0,a.Z)({},e),{},(0,i.Z)({},n,r)))})},reset:function(n){var i=(0,a.Z)({},e);i[n]&&delete i[n],t({search:u().stringify((0,a.Z)({},i))})},clear:function(){return t({search:u().stringify({})})},merge:function(n){return t({search:u().stringify((0,a.Z)((0,a.Z)({},e),n))})}}}},52509:function(t,n,e){"use strict";e.r(n);var i=e(4942),a=e(93433),r=e(1413),o=e(29439),u=e(47313),l=e(96077),c=e(83999),d=e(77181),s=e(72652),v=e(35321),f=e(78873),p=e(8597),x=e(47668),g=e(97307),Z=e(73431),m=e(97890),h=e(17101),y=e(2717),_=e(90954),j=e(24511),k=e(33834),b=e(34144),w=e(87882),S=e(56326),q=e(46417),O=c.Z.Step;n.default=function(){var t,n,e,F,M,E=(0,j.$)().t,N=(0,m.UO)().uuid,z=(0,k.K)(),C=(0,y.v9)((function(t){return t.menu}),y.wU).activeMenu,U=(0,y.v9)((function(t){return t.formLang}),y.wU).languages,A=(0,y.I0)(),B=Number((null===(t=z.values)||void 0===t?void 0:t.step)||0),G=(0,u.useState)(C.refetch),I=(0,o.Z)(G,2),K=I[0],P=I[1],T=(0,u.useState)(l.S),V=(0,o.Z)(T,2),D=V[0],H=V[1],L=((null===C||void 0===C?void 0:C.data)||{}).extras,Q=null===C||void 0===C||null===(n=C.data)||void 0===n?void 0:n.digital,$=null===L||void 0===L?void 0:L.some((function(t){var n;return"color"===(null===t||void 0===t||null===(n=t.group)||void 0===n?void 0:n.type)})),J=(0,u.useMemo)((function(){return null===L||void 0===L?void 0:L.find((function(t){var n;return"color"===(null===t||void 0===t||null===(n=t.group)||void 0===n?void 0:n.type)}))}),[L]);Array.from(new Set(null===J||void 0===J||null===(e=J.values)||void 0===e?void 0:e.map((function(t){return t.value})))).map((function(t){var n;return null===J||void 0===J||null===(n=J.values)||void 0===n?void 0:n.find((function(n){return n.value===t}))})).filter((function(t){return"color"===t.group_type}));(0,u.useEffect)((function(){Q?H(l.S.filter((function(t){return"product.extras"!==t.title}))):!1===Q&&H(l.S.filter((function(t){return"product.digital"!==t.title}))),H($?function(t){return t}:function(t){return t.filter((function(t){return"Gallery"!==t.title}))})}),[$,Q]);var R=function(){var t=B+1;z.set("step",t)},W=function(){var t=B-1;z.set("step",t)},X=function(t){var n={images:[],previews:[]},e=t.filter((function(t){return t.preview})).map((function(t){return{uid:t.id,name:t.preview,url:t.preview}})),i=t.filter((function(t){return t.preview})).map((function(t){return{uid:t.id,name:t.path,url:t.path,isVideo:!0}}));return n.previews=e,n.images=i,n},Y=function(t){return t?{label:null!==t&&void 0!==t&&t.translation?t.translation.title:t.title,value:t.id,key:t.id}:null};function tt(t){P(!0),h.Z.getById(t).then((function(t){var n,e,o,u,l,c,d={};t.data.stocks.forEach((function(t){t.extras.forEach((function(n){var e,i,a,r,o;n.extra_group_id in d?null!==(e=d[n.extra_group_id].values)&&void 0!==e&&e.some((function(t){var e;return t.value===(null===(e=n.value)||void 0===e?void 0:e.id)}))||null===(i=d[n.extra_group_id].values)||void 0===i||i.push({value:n.value.id,label:null===(a=n.value)||void 0===a?void 0:a.value,stock_id:t.id}):d[n.extra_group_id]={group:n.group,label:null===(r=n.group.translation)||void 0===r?void 0:r.title,value:n.extra_group_id,id:n.extra_group_id,stock_id:t.id,values:[{value:n.value.id,label:null===(o=n.value)||void 0===o?void 0:o.value,stock_id:t.id}]}}))}));var s,v=(0,r.Z)((0,r.Z)((0,r.Z)({},t.data),function(t){if(null===t||void 0===t||!t.translations)return{};var n=t.translations,e=U.map((function(t){var e,a,r;return r={},(0,i.Z)(r,"title[".concat(t.locale,"]"),null===(e=n.find((function(n){return n.locale===t.locale})))||void 0===e?void 0:e.title),(0,i.Z)(r,"description[".concat(t.locale,"]"),null===(a=n.find((function(n){return n.locale===t.locale})))||void 0===a?void 0:a.description),r}));return Object.assign.apply(Object,[{}].concat((0,a.Z)(e)))}(t.data)),{},{shop:Y(t.data.shop),category:Y(t.data.category),brand:Y(t.data.brand),unit:Y(t.data.unit),images:(s=t.data.galleries,s.map((function(t){return{uid:t.id,name:t.path,url:t.path,isVideo:Boolean(t.preview)}}))),initialMediaFile:X(t.data.galleries),extras:Object.values(d),stocks:t.data.stocks.map((function(t){return(0,r.Z)((0,r.Z)((0,r.Z)({},t),Object.assign.apply(Object,[{}].concat((0,a.Z)(t.extras.map((function(t,n){return(0,i.Z)({},"extras[".concat(n,"]"),t.id)})))))),{},{quantity:t.quantity||0,price:t.price||0,extras:void 0})})),stocksData:null===t||void 0===t||null===(n=t.data)||void 0===n?void 0:n.stocks,properties:t.data.properties.map((function(t,n){var e;return e={id:n},(0,i.Z)(e,"key[".concat(t.locale,"]"),t.key),(0,i.Z)(e,"value[".concat(t.locale,"]"),t.value),e})),translation:void 0,translations:void 0,min_qty:null===(e=t.data)||void 0===e?void 0:e.min_qty,max_qty:null===(o=t.data)||void 0===o?void 0:o.max_qty,tax:null===(u=t.data)||void 0===u?void 0:u.tax,interval:null===(l=t.data)||void 0===l?void 0:l.interval,age_limit:null===(c=t.data)||void 0===c?void 0:c.age_limit});A((0,_.nc)({activeMenu:C,data:v}))})).finally((function(){P(!1),A((0,_.A_)(C))}))}(0,u.useEffect)((function(){C.refetch&&tt(N)}),[C.refetch]);return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(d.Z,{title:E("edit.product"),extra:(0,q.jsx)(Z.Z,{}),children:(0,q.jsx)(c.Z,{current:B,onChange:function(t){A((0,_.nc)({activeMenu:C,data:(0,r.Z)((0,r.Z)({},C.data),{},{step:t})})),z.set("step",t)},children:D.map((function(t){return(0,q.jsx)(O,{title:E(t.title)},t.title)}))})}),K?(0,q.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,q.jsx)(s.Z,{size:"large",className:"py-5"})}):(0,q.jsxs)("div",{className:"",children:["First-content"===D[B].content&&(0,q.jsx)(g.Z,{next:R,action_type:"edit"}),(null===(F=C.data)||void 0===F?void 0:F.digital)&&"Product-digital"===D[B].content&&(0,q.jsx)(w.Z,{next:R,prev:W}),!(null!==(M=C.data)&&void 0!==M&&M.digital)&&"Second-content"===D[B].content&&(0,q.jsx)(x.Z,{next:R,prev:W}),"Third-content"===D[B].content&&(0,q.jsx)(p.Z,{next:R,prev:W}),"wholesale-content"===D[B].content&&(0,q.jsx)(S.Z,{next:R,prev:W}),$>0&&"Gallery-content"===D[B].content&&(0,q.jsx)(b.Z,{next:R,prev:W}),"Fourth-content"===D[B].content&&(0,q.jsx)(v.Z,{next:R,prev:W}),"Finish-content"===D[B].content&&(0,q.jsx)(f.Z,{prev:W})]})]})}},24654:function(){}}]);