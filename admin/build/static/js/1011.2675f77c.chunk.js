"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[1011],{75565:(e,t,a)=>{a.r(t),a.d(t,{default:()=>F});var s=a(47313),n=a(73591),i=a(97890),l=a(24511),d=a(59308),o=a(45705),r=a(26824),c=a(59491),u=a(77181),v=a(78508),m=a(9274),h=a(45464),x=a(12019),p=a(54757),j=a(90954),g=a(2717),Z=a(23560),y=a(69658),f=a(74580),w=a(53233),b=a(13945),k=a(80314),C=a(71810),_=a(4901),I=a(14349),S=a(70816),q=a.n(S),P=a(10976),T=a(68197),M=a(59624),N=a(66672),U=a(46417);function z(e){let{data:t,handleCancel:a,handleOk:n,visible:i}=e;const{t:d}=(0,l.$)(),[o]=P.Z.useForm(),[r,u]=(0,s.useState)(!1);return(0,U.jsx)(m.Z,{title:d(t.title),visible:i,onCancel:a,footer:[(0,U.jsx)(c.Z,{type:"primary",onClick:()=>o.submit(),loading:r,children:d("save")}),(0,U.jsx)(c.Z,{type:"default",onClick:a,children:d("cancel")})],children:(0,U.jsx)(P.Z,{layout:"vertical",onFinish:e=>{u(!0);const t={...e,status:"canceled"};n(t)},form:o,children:(0,U.jsx)(P.Z.Item,{children:(0,U.jsx)(T.Z,{className:"mt-4",children:(0,U.jsx)(M.Z,{span:24,children:(0,U.jsx)(P.Z.Item,{name:"status_note",label:d("note"),rules:[{validator:(e,t)=>t?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(d("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(d("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(d("required")))}],children:(0,U.jsx)(N.Z.TextArea,{maxLength:250,showCount:!0})})})})})})})}const A={type:"category"};function E(e){var t,a,n;let{parentId:d,type:S="main",activeTab:P="request"}=e;const{t:T}=(0,l.$)(),{setIsModalVisible:M}=(0,s.useContext)(f._),[N,E]=(0,s.useState)(!1),[F,Y]=(0,s.useState)(!1),[H,K]=(0,s.useState)(!1),[O,$]=(0,s.useState)(""),[B,D]=(0,s.useState)(null),L=(0,g.I0)(),R=(0,i.s0)(),{activeMenu:W}=(0,g.v9)((e=>e.menu),g.wU),{data:V,meta:G,loading:J,params:Q}=(0,g.v9)((e=>e.requestModels),g.wU),X=W.data,{uuid:ee}=(0,i.UO)(),te={search:null===X||void 0===X?void 0:X.search,sort:null===X||void 0===X?void 0:X.sort,column:null===X||void 0===X?void 0:X.column,perPage:null===X||void 0===X?void 0:X.perPage,page:null===X||void 0===X?void 0:X.page,parent_id:d},[ae,se]=(0,s.useState)([{title:T("created.by"),dataIndex:"createdBy",key:"createdBy",is_show:!0,render:e=>(0,U.jsxs)("span",{children:[e.firstname," ",null===e||void 0===e?void 0:e.lastname," ",(0,U.jsx)("a",{href:"tel:".concat(null===e||void 0===e?void 0:e.phone),children:null===e||void 0===e?void 0:e.phone})]})},{title:T("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:e=>q()(e).format("YYYY-MM-DD HH:mm")},{title:T("name"),dataIndex:"name",key:"name",is_show:!0,render:(e,t)=>(0,U.jsxs)(o.Z,{children:[t.model.translation.title," ",(0,U.jsx)(_.WFu,{})," ",t.data.title[t.model.translation.locale]]})},{title:T("image"),dataIndex:"img",key:"img",is_show:!0,render:(e,t)=>(0,U.jsxs)(o.Z,{children:[(0,U.jsx)(r.Z,{src:(0,h.Z)(t.model.img),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0}),(0,U.jsx)(_.WFu,{}),(0,U.jsx)(r.Z,{src:(0,h.Z)(t.data.images.at(0)),alt:"img_gallery",width:100,className:"rounded",preview:!0,placeholder:!0})]})},{title:T("options"),key:"options",dataIndex:"options",is_show:!0,render:(e,t)=>(0,U.jsxs)(o.Z,{children:[(0,U.jsx)(c.Z,{icon:(0,U.jsx)(x.Z,{}),onClick:()=>(e=>{L((0,j.bL)({url:"category-request/".concat(e.id),id:"request_edit",name:T("request.edit")})),R("/category-request/".concat(e.id),{state:{parentId:d,parentUuid:ee}})})(t)}),"canceled"===(null===t||void 0===t?void 0:t.status)&&(null===t||void 0===t?void 0:t.status_note)&&(0,U.jsx)(c.Z,{icon:(0,U.jsx)(p.Z,{}),onClick:()=>{$(t.status_note),K(!0)}}),(0,U.jsx)(c.Z,{type:"primary",onClick:()=>{D([{id:t.id,status:"approved"}]),M(!0)},children:T("accept")}),(0,U.jsx)(c.Z,{type:"primary",danger:!0,onClick:()=>{D([{id:t.id,status:"canceled"}]),E(!0)},children:T("decline")})]})}]);(0,s.useEffect)((()=>{W.refetch&&"request"===P&&(L((0,C.aw)(te)),L((0,j.A_)(W)))}),[W.refetch]),(0,k.Z)((()=>{"request"===P&&L((0,C.aw)(te))}),[W.data,P]);const ne=e=>{Y(!0);const t={status:null===B||void 0===B?void 0:B.at(0).status,status_note:null===e||void 0===e?void 0:e.status_note};I.Z.changeStatus(null===B||void 0===B?void 0:B.at(0).id,t).then((()=>{Z.Am.success(T("successfully.changed")),L((0,C.aw)(A)),M(!1),D(null)})).finally((()=>{E(!1),Y(!1)}))},ie={selectedRowKeys:B,onChange:e=>{D(e)}};return(0,U.jsxs)(u.Z,{title:T("requests"),extra:(0,U.jsx)(o.Z,{wrap:!0,children:(0,U.jsx)(w.Z,{columns:ae,setColumns:se})}),children:[(0,U.jsx)(v.Z,{scroll:{x:!0},rowSelection:ie,columns:null===ae||void 0===ae?void 0:ae.filter((e=>e.is_show)),dataSource:V,pagination:{pageSize:Q.perPage,page:(null===(t=W.data)||void 0===t?void 0:t.page)||1,total:G.total,defaultCurrent:null===(a=W.data)||void 0===a?void 0:a.page,current:null===(n=W.data)||void 0===n?void 0:n.page},rowKey:e=>e.key,onChange:function(e,t,a){const{pageSize:s,current:n}=e,{field:i,order:l}=a,d=(0,b.Z)(l);L((0,j.nc)({activeMenu:W,data:{...W.data,perPage:s,page:n,column:i,sort:d}}))},loading:J}),(0,U.jsx)(y.Z,{click:ne,text:T("change.status"),setText:D,loading:F}),(0,U.jsx)(z,{data:{title:"decline"},visible:N,handleCancel:()=>E(!1),handleOk:ne,laoding:F}),(0,U.jsxs)(m.Z,{title:"Reject message",closable:!1,visible:H,footer:null,centered:!0,children:[(0,U.jsx)("p",{children:O}),(0,U.jsx)("div",{className:"d-flex justify-content-end",children:(0,U.jsx)(c.Z,{type:"primary",className:"mr-2",onClick:()=>K(!1),children:T("close")})})]})]})}function F(){var e,t;const{t:a}=(0,l.$)(),o=(0,i.TH)(),r=(0,g.I0)(),{activeMenu:c}=(0,g.v9)((e=>e.menu),g.wU),[u,v]=(0,s.useState)((null===(e=o.state)||void 0===e?void 0:e.tab)||"list");return(0,U.jsxs)(n.Z,{defaultActiveKey:(null===(t=o.state)||void 0===t?void 0:t.tab)||"list",destroyInactiveTabPane:!0,onChange:e=>{r((0,j.xo)(c)),v(e)},children:[(0,U.jsx)(n.Z.TabPane,{tab:a("category.list"),children:(0,U.jsx)(d.Z,{activeTab:u})},"list"),(0,U.jsx)(n.Z.TabPane,{tab:a("requests"),children:(0,U.jsx)(E,{activeTab:u})},"request")]})}}}]);