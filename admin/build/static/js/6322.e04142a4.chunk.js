"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[6322],{32380:(e,l,t)=>{t.d(l,{o:()=>s});var a=t(47313),i=t(84762),n=t(72652),r=t(46417);const s=e=>{let{fetchOptions:l,refetch:t=!1,...s}=e;const[d,o]=(0,a.useState)(!1),[u,c]=(0,a.useState)([]);return(0,r.jsx)(i.Z,{treeLine:!0,treeData:d?[]:u,treeDefaultExpandAll:!0,labelInValue:!0,onFocus:()=>{u.length&&!t||(o(!0),l().then((e=>{c(e),o(!1)})))},notFoundContent:d?(0,r.jsx)(n.Z,{size:"small"}):"no results",...s})}},73431:(e,l,t)=>{t.d(l,{Z:()=>o});var a=t(47313),i=t(39180),n=t(2717),r=t(28830),s=t(60535),d=t(46417);const o=()=>{const e=(0,n.I0)(),{languages:l,defaultLang:t}=(0,n.v9)((e=>e.formLang),n.wU);(0,a.useEffect)((()=>{s.Z.getAllActive().then((l=>{let{data:t}=l;e((0,r.dc)(t)),e((0,r.mh)(t.find((e=>1===e.default)).locale))}))}),[]);return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(i.ZP.Group,{value:t,onChange:l=>{let{target:{value:t}}=l;e((0,r.mh)(t))},className:"float-right",buttonStyle:"solid",children:null===l||void 0===l?void 0:l.map((e=>(0,d.jsx)(i.ZP.Button,{value:e.locale,children:e.title},e.id)))})})}},26322:(e,l,t)=>{t.r(l),t.d(l,{default:()=>_});var a=t(47313),i=t(10976),n=t(77181),r=t(68197),s=t(59624),d=t(66672),o=t(74294),u=t(16124),c=t(86345),m=t(59491),v=t(72652),p=t(23560),h=t(97890),g=t(73431),j=t(52421),x=t(2717),y=t(90954),Z=t(30763),f=t(97421),b=t(24511),w=t(5764),I=t(42472),k=t(32380),P=t(46417);const _=()=>{var e,l;const{t:t}=(0,b.$)(),_=(0,h.s0)(),E=(0,x.I0)(),[S,q]=(0,a.useState)("main"),[F,L]=(0,a.useState)(!1),{activeMenu:A}=(0,x.v9)((e=>e.menu),x.wU),{state:U}=(0,h.TH)(),[V,C]=(0,a.useState)(!1),[N,z]=(0,a.useState)(null!==(e=A.data)&&void 0!==e&&e.image?[null===(l=A.data)||void 0===l?void 0:l.image]:[]),[O]=i.Z.useForm(),[B,D]=(0,a.useState)(!1),[M,T]=(0,a.useState)(null),{uuid:G}=(0,h.UO)(),{params:H}=(0,x.v9)((e=>e.category),x.wU),{defaultLang:$,languages:J}=(0,x.v9)((e=>e.formLang),x.wU);(0,a.useEffect)((()=>()=>{const e=O.getFieldsValue(!0);E((0,y.nc)({activeMenu:A,data:e})),E((0,I.pE)({...H,type:S,parent_id:null===U||void 0===U?void 0:U.parentId}))}),[]);const K=e=>({name:e,url:f.bV+e});function Q(e){if(!e)return{};const{translations:l}=e,t=J.map((e=>{var t,a;return{["title[".concat(e.locale,"]")]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.title,["description[".concat(e.locale,"]")]:null===(a=l.find((l=>l.locale===e.locale)))||void 0===a?void 0:a.description}}));return Object.assign({},...t)}(0,a.useEffect)((()=>{var e;e=G,C(!0),Z.Z.getById(e).then((e=>{var l,t,a,i;let n=e.data;const r={...n,...Q(n),input:(null===n||void 0===n?void 0:n.input)||0,image:[K(n.img)],keywords:null===n||void 0===n||null===(l=n.keywords)||void 0===l?void 0:l.split(","),parent_id:{label:null===(t=n.parent)||void 0===t||null===(a=t.translation)||void 0===a?void 0:a.title,value:n.parent_id,key:n.parent_id}};q(null===n||void 0===n?void 0:n.type),O.setFieldsValue(r),z([K(n.img)]),(null===n||void 0===n||null===(i=n.children)||void 0===i?void 0:i.length)>0&&"main"===(null===n||void 0===n?void 0:n.type)&&L(!0)})).finally((()=>{C(!1),E((0,y.A_)(A))}))}),[A.refetch,G,null===U||void 0===U?void 0:U.parentId]);return(0,P.jsx)(P.Fragment,{children:(0,P.jsx)(n.Z,{title:null!==U&&void 0!==U&&U.parentId?t("edit.sub.category"):t("edit.category"),extra:(0,P.jsx)(g.Z,{}),children:V?(0,P.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,P.jsx)(v.Z,{size:"large",className:"mt-5 pt-5"})}):(0,P.jsxs)(i.Z,{name:"basic",layout:"vertical",onFinish:e=>{var l,a,i;D(!0);const n={...e,type:null!==(l=e.parent_id)&&void 0!==l&&l.value?S:"main",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(a=e.parent_id)||void 0===a?void 0:a.value,"images[0]":null===(i=N[0])||void 0===i?void 0:i.name},r="catalog/categories";Z.Z.update(G,n).then((()=>{p.Am.success(t("successfully.updated")),E((0,y.ph)({...A,nextUrl:r})),_("/".concat(r))})).catch((e=>T(e.response.data.params))).finally((()=>D(!1)))},initialValues:{active:!0,...A.data},form:O,children:[(0,P.jsxs)(r.Z,{gutter:12,children:[(0,P.jsx)(s.Z,{span:12,children:J.map(((e,l)=>(0,P.jsx)(i.Z.Item,{label:t("name"),name:"title[".concat(e.locale,"]"),help:M&&M["title.".concat($)]?M["title.".concat($)][0]:null,validateStatus:M?"error":"success",rules:[{validator:(l,a)=>a||(null===e||void 0===e?void 0:e.locale)!==$?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(t("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<2?Promise.reject(new Error(t("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(t("required")))}],hidden:e.locale!==$,children:(0,P.jsx)(d.Z,{maxLength:50})},e.title+l)))}),(0,P.jsx)(s.Z,{span:12,children:J.map(((e,l)=>(0,P.jsx)(i.Z.Item,{label:t("description"),name:"description[".concat(e.locale,"]"),rules:[{validator:(l,a)=>a||(null===e||void 0===e?void 0:e.locale)!==$?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(t("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<5?Promise.reject(new Error(t("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(t("required")))}],hidden:e.locale!==$,children:(0,P.jsx)(j.Z,{rows:4,maxLength:150})},e.locale+l)))}),(0,P.jsx)(s.Z,{span:12,children:(0,P.jsx)(i.Z.Item,{label:t("keywords"),name:"keywords",rules:[{required:!0,message:t("required")}],children:(0,P.jsx)(o.Z,{mode:"tags",style:{width:"100%"}})})}),(0,P.jsx)(s.Z,{span:12,children:(0,P.jsx)(i.Z.Item,{label:t("parent.category"),name:"parent_id",rules:[{required:!1,message:t("required")}],children:(0,P.jsx)(k.o,{fetchOptions:async function(){const{id:e}=O.getFieldValue();return Z.Z.getAll({perPage:100,type:"main"}).then((l=>l.data.filter((l=>l.id!==e)).map((l=>{var t,a;return{label:null===(t=l.translation)||void 0===t?void 0:t.title,value:l.id,key:l.id,type:"main",children:null===(a=l.children)||void 0===a?void 0:a.map((l=>{var t,a;return{label:null===(t=l.translation)||void 0===t?void 0:t.title,value:l.id,key:l.id,type:"sub_main",disabled:l.id===e,children:null===(a=l.children)||void 0===a?void 0:a.map((e=>{var l;return{label:null===(l=e.translation)||void 0===l?void 0:l.title,value:e.id,key:e.id,disabled:!0,type:"child"}}))}}))}}))))},onSelect:(e,l,t)=>{const{type:a}=l||{};q("main"===a?"sub_main":"sub_main"===a?"child":"main")},allowClear:!0,disabled:F})})}),(0,P.jsx)(s.Z,{span:12,children:(0,P.jsx)(i.Z.Item,{name:"input",label:t("input"),rules:[{required:!0,message:t("required")}],children:(0,P.jsx)(u.Z,{min:0,parser:e=>parseInt(e,10),max:9999999,className:"w-100"})})}),(0,P.jsx)(s.Z,{span:4,children:(0,P.jsx)(i.Z.Item,{label:t("image"),name:"images",rules:[{required:!(null!==N&&void 0!==N&&N.length),message:t("required")}],children:(0,P.jsx)(w.Z,{type:"categories",imageList:N,setImageList:z,form:O,multiple:!1})})}),(0,P.jsx)(s.Z,{span:2,children:(0,P.jsx)(i.Z.Item,{label:t("active"),name:"active",valuePropName:"checked",children:(0,P.jsx)(c.Z,{})})})]}),(0,P.jsx)(m.Z,{type:"primary",htmlType:"submit",loading:B,children:t("submit")})]})})})}}}]);