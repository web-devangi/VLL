"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[739],{53233:function(e,n,t){var r=t(1413),a=t(29439),i=t(47313),o=t(56140),l=t(67251),s=t(45705),c=t(86345),u=t(78267),d=t(37388),f=t(59491),v=t(99587),h=t(24511),p=t(46417),m=o.Z.Text;n.Z=function(e){var n=e.columns,t=void 0===n?[]:n,o=e.setColumns,Z=e.style,x=e.size,j=void 0===x?"":x,y=e.iconOnly,g=(0,h.$)().t,b=(0,i.useState)(!1),C=(0,a.Z)(b,2),I=C[0],w=C[1],_=(0,p.jsx)(l.Z,{children:null===t||void 0===t?void 0:t.map((function(e,n){return(0,p.jsx)(l.Z.Item,{children:(0,p.jsxs)(s.Z,{className:"d-flex justify-content-between",children:[(0,p.jsx)(m,{children:e.title}),(0,p.jsx)(c.Z,{defaultChecked:!0,onClick:function(){return function(e){var n=null===t||void 0===t?void 0:t.map((function(n){return n.dataIndex===e.dataIndex&&(n.is_show=!(null!==n&&void 0!==n&&n.is_show)),n}));o(n)}(e)},disabled:1===n})]})},e+n)}))});return(0,p.jsx)(u.Z,{overlay:_,trigger:["click"],onVisibleChange:function(e){w(e)},visible:I,children:(0,p.jsx)(d.Z,{title:g("change.columns"),children:(0,p.jsx)(f.Z,{style:(0,r.Z)({},Z),size:j,icon:(0,p.jsx)(v.Z,{}),children:y?null:g("Columns")})})})}},89281:function(e,n,t){t.d(n,{h:function(){return v}});var r=t(1413),a=t(29439),i=t(45987),o=t(47313),l=t(12279),s=t.n(l),c=t(74294),u=t(72652),d=t(46417),f=["fetchOptions","debounceTimeout","onClear","refetchOptions"],v=function(e){var n=e.fetchOptions,t=e.debounceTimeout,l=void 0===t?400:t,v=e.onClear,h=e.refetchOptions,p=void 0!==h&&h,m=(0,i.Z)(e,f),Z=(0,o.useState)(!1),x=(0,a.Z)(Z,2),j=x[0],y=x[1],g=(0,o.useState)([]),b=(0,a.Z)(g,2),C=b[0],I=b[1],w=(0,o.useMemo)((function(){return s()((function(e){I([]),y(!0),n(e).then((function(e){I(e),y(!1)}))}),l)}),[n,l]);return(0,d.jsx)(c.Z,(0,r.Z)((0,r.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:w,onClear:function(){w(""),v&&v()},notFoundContent:j?(0,d.jsx)(u.Z,{size:"small"}):"no results"},m),{},{options:C,onFocus:function(){C.length&&!p||w("")}}))}},13945:function(e,n,t){function r(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}t.d(n,{Z:function(){return r}})},84017:function(e,n,t){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after",r=Number(e).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===t?"".concat(r," ").concat(n):"".concat(n," ").concat(r)}t.d(n,{Z:function(){return r}})},80739:function(e,n,t){t.r(n),t.d(n,{default:function(){return K}});var r=t(15861),a=t(1413),i=t(29439),o=t(87757),l=t.n(o),s=t(47313),c=t(73591),u=t(66204),d=t(59491),f=t(77181),v=t(45705),h=t(78508),p=t(12019),m=t(31741),Z=t(2717),x=t(90954),j=t(24511),y=t(80314),g=t(13945),b=t(89281),C=t(58328),I=t(93655),w=t(9274),_=t(83371),k=t(51282),z=t(93161),S=t(84017),H=t(70816),V=t.n(H),M=t(46417);function O(e){var n,t,r,a,o,l,c=e.id,f=e.handleCancel,v=(0,s.useState)({}),h=(0,i.Z)(v,2),p=h[0],m=h[1],Z=(0,s.useState)(!1),x=(0,i.Z)(Z,2),y=x[0],g=x[1],b=(0,j.$)().t;return(0,s.useEffect)((function(){!function(e){g(!0),z.Z.getById(e).then((function(e){return m(e.data)})).finally((function(){return g(!1)}))}(c)}),[c]),(0,M.jsx)(w.Z,{visible:!!c,title:b("transaction"),onCancel:f,footer:(0,M.jsx)(d.Z,{type:"default",onClick:f,children:b("cancel")}),children:y?(0,M.jsx)(k.Z,{}):(0,M.jsxs)(_.Z,{bordered:!0,children:[(0,M.jsx)(_.Z.Item,{span:3,label:b("transaction.id"),children:p.id}),(0,M.jsxs)(_.Z.Item,{span:3,label:b("client"),children:[null===(n=p.user)||void 0===n?void 0:n.firstname," ",null===(t=p.user)||void 0===t?void 0:t.lastname]}),(0,M.jsx)(_.Z.Item,{span:3,label:b("price"),children:(0,S.Z)(p.price,null===(r=p.payable)||void 0===r||null===(a=r.order)||void 0===a||null===(o=a.currency)||void 0===o?void 0:o.symbol)}),(0,M.jsx)(_.Z.Item,{span:3,label:b("payment.type"),children:b(null===(l=p.payment_system)||void 0===l?void 0:l.tag)}),(0,M.jsx)(_.Z.Item,{span:3,label:b("created.at"),children:V()(p.created_at).format("YYYY-MM-DD HH:mm")}),(0,M.jsx)(_.Z.Item,{span:3,label:b("status"),children:"progress"===p.status?(0,M.jsx)(u.Z,{color:"gold",children:b(p.status)}):"rejected"===p.status?(0,M.jsx)(u.Z,{color:"error",children:b(p.status)}):(0,M.jsx)(u.Z,{color:"cyan",children:b(p.status)})}),(0,M.jsx)(_.Z.Item,{span:3,label:b("status.description"),children:p.status_description}),(0,M.jsx)(_.Z.Item,{span:3,label:b("note"),children:p.note})]})})}var D=t(53233),P=t(10976),Y=t(68197),T=t(59624),$=t(74294),F=t(23560),E=["paid","canceled"];function A(e){var n=e.transactionDetails,t=e.handleCancel,r=e.paramsData,a=P.Z.useForm(),o=(0,i.Z)(a,1)[0],l=(0,Z.I0)(),c=(0,j.$)().t,u=(0,s.useState)(!1),f=(0,i.Z)(u,2),v=f[0],h=f[1];return(0,M.jsx)(w.Z,{visible:!!n,title:c("transaction.status"),closable:!1,footer:[(0,M.jsx)(d.Z,{type:"primary",onClick:function(){return o.submit()},loading:v,children:c("save")},"save-form"),(0,M.jsx)(d.Z,{type:"default",onClick:t,children:c("cancel")},"cansel-modal")],children:(0,M.jsx)(P.Z,{form:o,layout:"vertical",onFinish:function(e){h(!0),z.Z.updateTransactionStatus(n.id,e).then((function(){t(),l((0,I.J1)(r))})).catch((function(e){return F.Am.error(e.message)})).finally((function(){return h(!1)}))},initialValues:{status:n.status},children:(0,M.jsx)(Y.Z,{gutter:12,children:(0,M.jsx)(T.Z,{span:24,children:(0,M.jsx)(P.Z.Item,{label:c("status"),name:"status",rules:[{validator:function(e,n){return n&&"progress"!==n?Promise.resolve():Promise.reject(new Error(c("required")))}}],children:(0,M.jsx)($.Z,{children:E.map((function(e,n){return(0,M.jsx)($.Z.Option,{value:e,children:c(e)},n)}))})})})})})})}var J=c.Z.TabPane,N=["all","progress","paid","canceled","rejected"],B=["Order"];function K(){var e,n,t,o,w=(0,Z.I0)(),_=(0,j.$)().t,k=(0,s.useState)(null),z=(0,i.Z)(k,2),H=z[0],P=z[1],Y=(0,Z.v9)((function(e){return e.menu}),Z.wU).activeMenu,T=(0,s.useState)("all"),$=(0,i.Z)(T,2),F=$[0],E=$[1],K=(0,s.useState)(null),U=(0,i.Z)(K,2),q=U[0],R=U[1],W=(null===(e=Y.data)||void 0===e?void 0:e.role)||F,G=(0,s.useState)([{title:_("id"),dataIndex:"id",key:"id",sorter:!0,is_show:!0},{title:_("client"),dataIndex:"user",key:"user",is_show:!0,render:function(e){return null===e?(0,M.jsx)(u.Z,{color:"red",children:_("deleted.user")}):(0,M.jsxs)("div",{children:[null===e||void 0===e?void 0:e.firstname," ",(null===e||void 0===e?void 0:e.lastname)||""]})}},{title:_("amount"),dataIndex:"price",key:"price",is_show:!0,render:function(e,n){var t,r,a;return(0,S.Z)(e,null===(t=n.payable)||void 0===t||null===(r=t.order)||void 0===r||null===(a=r.currency)||void 0===a?void 0:a.symbol)}},{title:_("payment.type"),dataIndex:"payment_system",key:"payment_system",is_show:!0,render:function(e){return null===e||void 0===e?void 0:e.tag}},{title:_("status"),dataIndex:"status",key:"status",is_show:!0,render:function(e,n){return(0,M.jsxs)("div",{children:["progress"===e?(0,M.jsx)(u.Z,{color:"gold",children:_(e)}):"canceled"===e||"rejected"===e?(0,M.jsx)(u.Z,{color:"error",children:_(e)}):(0,M.jsx)(u.Z,{color:"cyan",children:_(e)}),B.includes(null===n||void 0===n?void 0:n.payable_type)&&(0,M.jsx)(p.Z,{onClick:function(){R(n)}})]})}},{title:_("status.note"),dataIndex:"status_description",key:"status_description",is_show:!0},{title:_("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:function(e){return V()(e).format("YYYY-MM-DD HH:mm")}},{title:_("options"),key:"options",is_show:!0,render:function(e,n){return(0,M.jsx)(d.Z,{icon:(0,M.jsx)(m.Z,{}),onClick:function(){return function(e){P(e.id)}(n)}})}}]),L=(0,i.Z)(G,2),Q=L[0],X=L[1],ee=(0,Z.v9)((function(e){return e.transaction}),Z.wU),ne=ee.transactions,te=ee.meta,re=ee.loading,ae=ee.params,ie=Y.data,oe={sort:null===ie||void 0===ie?void 0:ie.sort,column:null===ie||void 0===ie?void 0:ie.column,perPage:null===ie||void 0===ie?void 0:ie.perPage,page:null===ie||void 0===ie?void 0:ie.page,user_id:null===ie||void 0===ie?void 0:ie.userId,status:"all"===W?void 0:W,model:"orders"};(0,y.Z)((function(){w((0,I.J1)(oe))}),[Y.data]),(0,s.useEffect)((function(){Y.refetch&&(w((0,I.J1)(oe)),w((0,x.A_)(Y)))}),[Y.refetch]);var le=function(e){var n=Y.data;w((0,x.nc)({activeMenu:Y,data:(0,a.Z)((0,a.Z)({},n),e)}))};function se(){return se=(0,r.Z)(l().mark((function e(n){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,perPage:10},e.abrupt("return",C.Z.getAll(t).then((function(e){return e.data.map((function(e){return{label:"".concat(e.firstname," ").concat(e.lastname),value:e.id}}))})));case 2:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}return(0,M.jsxs)(f.Z,{title:_("transactions"),extra:(0,M.jsxs)(v.Z,{children:[(0,M.jsx)(b.h,{placeholder:_("select.client"),fetchOptions:function(e){return se.apply(this,arguments)},onSelect:function(e){return le({userId:e.value})},onDeselect:function(){return le({userId:null})},style:{minWidth:200}}),(0,M.jsx)(D.Z,{columns:Q,setColumns:X})]}),children:[(0,M.jsx)(c.Z,{onChange:function(e){le({role:e,page:1}),E(e)},type:"card",activeKey:W,children:N.map((function(e){return(0,M.jsx)(J,{tab:_(e)},e)}))}),(0,M.jsx)(h.Z,{scroll:{x:!0},columns:null===Q||void 0===Q?void 0:Q.filter((function(e){return e.is_show})),dataSource:ne,loading:re,pagination:{pageSize:ae.perPage,page:(null===(n=Y.data)||void 0===n?void 0:n.page)||1,total:te.total,defaultCurrent:null===(t=Y.data)||void 0===t?void 0:t.page,current:null===(o=Y.data)||void 0===o?void 0:o.page},rowKey:function(e){return e.id},onChange:function(e,n,t){var r=e.pageSize,i=e.current,o=t.field,l=t.order,s=(0,g.Z)(l);w((0,x.nc)({activeMenu:Y,data:(0,a.Z)((0,a.Z)({},ie),{},{perPage:r,page:i,column:o,sort:s})}))}}),H&&(0,M.jsx)(O,{id:H,handleCancel:function(){return P(null)}}),q&&(0,M.jsx)(A,{transactionDetails:q,handleCancel:function(){return R(null)},paramsData:oe})]})}},99587:function(e,n,t){t.d(n,{Z:function(){return s}});var r=t(1413),a=t(47313),i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 208H676V232h212v136zm0 224H676V432h212v160zM412 432h200v160H412V432zm200-64H412V232h200v136zm-476 64h212v160H136V432zm0-200h212v136H136V232zm0 424h212v136H136V656zm276 0h200v136H412V656zm476 136H676V656h212v136z"}}]},name:"table",theme:"outlined"},o=t(17469),l=function(e,n){return a.createElement(o.Z,(0,r.Z)((0,r.Z)({},e),{},{ref:n,icon:i}))};l.displayName="TableOutlined";var s=a.forwardRef(l)}}]);