"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[9114],{32380:(e,t,l)=>{l.d(t,{o:()=>s});var a=l(47313),n=l(84762),i=l(72652),r=l(46417);const s=e=>{let{fetchOptions:t,refetch:l=!1,...s}=e;const[o,d]=(0,a.useState)(!1),[c,u]=(0,a.useState)([]);return(0,r.jsx)(n.Z,{treeLine:!0,treeData:o?[]:c,treeDefaultExpandAll:!0,labelInValue:!0,onFocus:()=>{c.length&&!l||(d(!0),t().then((e=>{u(e),d(!1)})))},notFoundContent:o?(0,r.jsx)(i.Z,{size:"small"}):"no results",...s})}},73431:(e,t,l)=>{l.d(t,{Z:()=>d});var a=l(47313),n=l(39180),i=l(2717),r=l(28830),s=l(60535),o=l(46417);const d=()=>{const e=(0,i.I0)(),{languages:t,defaultLang:l}=(0,i.v9)((e=>e.formLang),i.wU);(0,a.useEffect)((()=>{s.Z.getAllActive().then((t=>{let{data:l}=t;e((0,r.dc)(l)),e((0,r.mh)(l.find((e=>1===e.default)).locale))}))}),[]);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(n.ZP.Group,{value:l,onChange:t=>{let{target:{value:l}}=t;e((0,r.mh)(l))},className:"float-right",buttonStyle:"solid",children:null===t||void 0===t?void 0:t.map((e=>(0,o.jsx)(n.ZP.Button,{value:e.locale,children:e.title},e.id)))})})}},13622:(e,t,l)=>{l.d(t,{R:()=>d});var a=l(47313),n=l(12279),i=l.n(n),r=l(74294),s=l(72652),o=l(46417);const d=e=>{let{fetchOptions:t,debounceTimeout:l=400,refetch:n=!1,...d}=e;const[c,u]=(0,a.useState)(!1),[m,v]=(0,a.useState)([]),p=(0,a.useMemo)((()=>i()((e=>{v([]),u(!0),t(e).then((e=>{v(e),u(!1)}))}),l)),[t,l]);return(0,o.jsx)(r.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,onClear:()=>p(""),filterOption:!1,onSearch:p,notFoundContent:c?(0,o.jsx)(s.Z,{size:"small"}):"no results",...d,options:m,onFocus:()=>{m.length&&!n||p("")}})}},29114:(e,t,l)=>{l.r(t),l.d(t,{default:()=>I});var a=l(47313),n=l(10976),i=l(77181),r=l(68197),s=l(59624),o=l(66672),d=l(74294),c=l(86345),u=l(59491),m=l(72652),v=l(23560),p=l(97890),h=l(73431),g=l(52421),j=l(2717),f=l(90954),x=l(30763),y=l(42472),Z=l(24511),b=l(5764),w=(l(13622),l(32380)),k=l(46417);const I=()=>{var e,t;const{t:l}=(0,Z.$)(),I=(0,p.s0)(),S=(0,j.I0)(),{activeMenu:_}=(0,j.v9)((e=>e.menu),j.wU),{state:P}=(0,p.TH)(),[E,F]=(0,a.useState)(!1),[L,q]=(0,a.useState)("main"),[C,A]=(0,a.useState)(null!==(e=_.data)&&void 0!==e&&e.image?[null===(t=_.data)||void 0===t?void 0:t.image]:[]),[O]=n.Z.useForm(),[U,z]=(0,a.useState)(!1),[V,N]=(0,a.useState)(null),{uuid:M}=(0,p.UO)(),{defaultLang:T,languages:B}=(0,j.v9)((e=>e.formLang),j.wU);(0,a.useEffect)((()=>()=>{const e=O.getFieldsValue(!0);S((0,f.nc)({activeMenu:_,data:e}))}),[]);const D=e=>({name:e,url:e});function G(e){if(!e)return{};const{translations:t}=e,l=B.map((e=>{var l,a;return{["title[".concat(e.locale,"]")]:null===(l=t.find((t=>t.locale===e.locale)))||void 0===l?void 0:l.title,["description[".concat(e.locale,"]")]:null===(a=t.find((t=>t.locale===e.locale)))||void 0===a?void 0:a.description}}));return Object.assign({},...l)}(0,a.useEffect)((()=>{var e;_.refetch&&(e=M,F(!0),x.Z.getById(e).then((e=>{var t,l;let a=e.data;const n={...a,...G(a),image:[D(a.img)],keywords:a.keywords.split(","),parent_id:{label:null===(t=a.parent)||void 0===t||null===(l=t.translation)||void 0===l?void 0:l.title,value:a.parent_id,key:a.parent_id}};O.setFieldsValue(n),A([D(a.img)])})).finally((()=>{F(!1),S((0,f.A_)(_))})))}),[_.refetch]);return(0,k.jsx)(i.Z,{title:l("category.clone"),extra:(0,k.jsx)(h.Z,{}),children:E?(0,k.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,k.jsx)(m.Z,{size:"large",className:"mt-5 pt-5"})}):(0,k.jsxs)(n.Z,{name:"basic",layout:"vertical",onFinish:e=>{var t,a,n;z(!0);const i={...e,type:null!==(t=e.parent_id)&&void 0!==t&&t.value?L:"main",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(a=e.parent_id)||void 0===a?void 0:a.value,"images[0]":null===(n=C[0])||void 0===n?void 0:n.name},r=null!==P&&void 0!==P&&P.parentId?"category/".concat(P.parentUuid):"catalog/categories";x.Z.create(i).then((()=>{v.Am.success(l("successfully.updated")),S((0,f.ph)({..._,nextUrl:r})),S((0,y.pE)({type:null!==P&&void 0!==P&&P.parentId?"sub_main":"main",parent_id:null===P||void 0===P?void 0:P.parentId})),I("/".concat(r))})).catch((e=>N(e.response.data.params))).finally((()=>z(!1)))},initialValues:{parent_id:{title:"---",value:0,key:0},active:!0,..._.data},form:O,children:[(0,k.jsxs)(r.Z,{gutter:12,children:[(0,k.jsx)(s.Z,{span:12,children:B.map(((e,t)=>(0,k.jsx)(n.Z.Item,{label:l("name"),name:"title[".concat(e.locale,"]"),help:V&&V["title.".concat(T)]?V["title.".concat(T)][0]:null,validateStatus:V?"error":"success",rules:[{validator:(t,a)=>a||(null===e||void 0===e?void 0:e.locale)!==T?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(l("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<2?Promise.reject(new Error(l("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(l("required")))}],hidden:e.locale!==T,children:(0,k.jsx)(o.Z,{maxLength:50})},e.title+t)))}),(0,k.jsx)(s.Z,{span:12,children:B.map(((e,t)=>(0,k.jsx)(n.Z.Item,{label:l("description"),name:"description[".concat(e.locale,"]"),rules:[{validator:(t,a)=>a||(null===e||void 0===e?void 0:e.locale)!==T?a&&""===(null===a||void 0===a?void 0:a.trim())?Promise.reject(new Error(l("no.empty.space"))):a&&(null===a||void 0===a?void 0:a.trim().length)<5?Promise.reject(new Error(l("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(l("required")))}],hidden:e.locale!==T,children:(0,k.jsx)(g.Z,{rows:4,maxLength:150})},e.locale+t)))}),(0,k.jsx)(s.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{label:l("keywords"),name:"keywords",rules:[{required:!0,message:l("required")}],children:(0,k.jsx)(d.Z,{mode:"tags",style:{width:"100%"}})})}),!(null!==P&&void 0!==P&&P.parentId)&&(0,k.jsx)(s.Z,{span:12,children:(0,k.jsx)(n.Z.Item,{label:l("parent.category"),name:"parent_id",rules:[{required:!1,message:l("required")}],children:(0,k.jsx)(w.o,{refetch:!0,fetchOptions:async function(){return x.Z.getAll({perPage:100,type:"main"}).then((e=>e.data.map((e=>{var t,l;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"main",children:null===(l=e.children)||void 0===l?void 0:l.map((e=>{var t,l;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"sub_main",disabled:"child"===e.type,children:null===(l=e.children)||void 0===l?void 0:l.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,disabled:!0,type:"child"}}))}}))}}))))},onSelect:(e,t,l)=>{const{type:a}=t||{};q("main"===a?"sub_main":"sub_main"===a?"child":"main")},allowClear:!0})})}),(0,k.jsx)(s.Z,{span:4,children:(0,k.jsx)(n.Z.Item,{label:l("image"),name:"images",rules:[{required:!(null!==C&&void 0!==C&&C.length),message:l("required")}],children:(0,k.jsx)(b.Z,{type:"categories",imageList:C,setImageList:A,form:O,multiple:!1})})}),(0,k.jsx)(s.Z,{span:2,children:(0,k.jsx)(n.Z.Item,{label:l("active"),name:"active",valuePropName:"checked",children:(0,k.jsx)(c.Z,{})})})]}),(0,k.jsx)(u.Z,{type:"primary",htmlType:"submit",loading:U,children:l("submit")})]})})}}}]);