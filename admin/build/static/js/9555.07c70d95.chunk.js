"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[9555],{29555:(t,e,a)=>{a.r(e),a.d(e,{default:()=>y});var i=a(47313),l=a(97890),n=a(23560),s=a(83999),o=a(10976),r=a(77181),c=a(72652),d=a(97421),u=a(2717),v=a(90954),g=a(24511),p=a(73431),m=a(10596),h=a(12545),f=a(46417);const{Step:_}=s.Z,y=()=>{var t,e,a;const{t:y}=(0,g.$)(),{activeMenu:j}=(0,u.v9)((t=>t.menu),u.wU),{id:k}=(0,l.UO)(),x=(0,u.I0)(),{defaultLang:S}=(0,u.v9)((t=>t.formLang),u.wU),[b,Z]=(0,i.useState)((null===(t=j.data)||void 0===t?void 0:t.step)||0),w=t=>({name:t,url:d.bV+t}),[F,O]=(0,i.useState)(null!==(e=j.data)&&void 0!==e&&e.galleries[0]?[w(j.data.galleries[0].path)]:[]),[U,V]=(0,i.useState)(null!==(a=j.data)&&void 0!==a&&a.galleries[1]?[w(j.data.galleries[1].path)]:[]),z=()=>{Z(b+1)},I=()=>{Z(b-1)},[M]=o.Z.useForm(),N=(0,l.s0)(),[q,A]=(0,i.useState)(!1),[B,C]=(0,i.useState)(!1);(0,i.useEffect)((()=>()=>{const t=M.getFieldsValue(!0);x((0,v.nc)({activeMenu:j,data:t}))}),[]);const E=[...F,...U];return(0,i.useEffect)((()=>{j.refetch&&(t=>{A(!0),h.Z.getById(t).then((t=>{var e,a,i;let l=t.data;M.setFieldsValue({...l,title:{[S]:l.translation.title},description:{[S]:l.translation.description},instruction:Object.assign({},...l.instructions.map((t=>({[t.locale]:t.title})))),ingredient:Object.assign({},...l.ingredients.map((t=>({[t.locale]:t.title})))),nutrition:null===(e=l.nutritions)||void 0===e?void 0:e.map((t=>{var e;return{percentage:null===t||void 0===t||null===(e=t.percentage)||void 0===e?void 0:e.toString(),weight:t.weight,...Object.assign({},...t.translations.flatMap((t=>({[t.locale]:t.title}))))}})),category_id:{value:l.category.id,label:null===(a=l.category.translation)||void 0===a?void 0:a.title},shop_id:{value:l.shop.id,label:null===(i=l.shop.translation)||void 0===i?void 0:i.title},stocks:l.stocks.map((t=>{var e,a;return{stock_id:{value:t.id,label:null===t||void 0===t||null===(e=t.product)||void 0===e||null===(a=e.translation)||void 0===a?void 0:a.title},...t}}))}),O([w(l.galleries[0].path)]),V([w(l.galleries[1].path)])})).finally((()=>{A(!1),x((0,v.A_)(j))}))})(k)}),[j.refetch]),(0,f.jsx)(r.Z,{title:y("edit.recepe"),extra:(0,f.jsx)(p.Z,{}),children:q?(0,f.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,f.jsx)(c.Z,{size:"large",className:"py-5"})}):(0,f.jsxs)(o.Z,{layout:"vertical",onFinish:t=>{var e;M.validateFields();const a={...t,category_id:t.category_id.value,images:E.map((t=>t.name)),shop_id:t.shop_id.value,active_time:t.active_time.toString(),total_time:t.total_time.toString(),nutrition:t.nutrition.map((t=>({...t,percentage:String(t.percentage),weight:String(t.weight)}))),stocks:null===(e=t.stocks)||void 0===e?void 0:e.map((t=>({min_quantity:t.min_quantity,stock_id:t.stock_id.value})))};C(!0);const i="catalog/recept";h.Z.update(k,a).then((()=>{n.Am.success(y("successfully.updated")),N("/".concat(i)),x((0,v.ph)({...j,nextUrl:i}))})).finally((()=>C(!1)))},form:M,initialValues:{active:!0,...j.data},children:[(0,f.jsx)(s.Z,{current:b,children:m.S.map((t=>(0,f.jsx)(_,{title:y(t.title)},t.title)))}),m.S.map((t=>{const e=t.content;return(0,f.jsx)("div",{className:"steps-content ".concat(t.step!==b+1&&"hidden"),children:(0,f.jsx)(e,{next:z,prev:I,loading:B,image:F,setImage:O,back:U,setBack:V})},t.title)}))]})})}}}]);