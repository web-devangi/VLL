"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[6124],{89281:function(e,t,n){n.d(t,{h:function(){return m}});var i=n(1413),u=n(29439),a=n(45987),r=n(47313),s=n(12279),l=n.n(s),c=n(74294),o=n(72652),d=n(46417),f=["fetchOptions","debounceTimeout","onClear","refetchOptions"],m=function(e){var t=e.fetchOptions,n=e.debounceTimeout,s=void 0===n?400:n,m=e.onClear,h=e.refetchOptions,p=void 0!==h&&h,Z=(0,a.Z)(e,f),v=(0,r.useState)(!1),x=(0,u.Z)(v,2),g=x[0],j=x[1],b=(0,r.useState)([]),y=(0,u.Z)(b,2),O=y[0],S=y[1],C=(0,r.useMemo)((function(){return l()((function(e){S([]),j(!0),t(e).then((function(e){S(e),j(!1)}))}),s)}),[t,s]);return(0,d.jsx)(c.Z,(0,i.Z)((0,i.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:C,onClear:function(){C(""),m&&m()},notFoundContent:g?(0,d.jsx)(o.Z,{size:"small"}):"no results"},Z),{},{options:O,onFocus:function(){O.length&&!p||C("")}}))}},72161:function(e,t,n){n.r(t);var i=n(4942),u=n(93433),a=n(1413),r=n(29439),s=n(47313),l=n(97890),c=n(23560),o=n(10976),d=n(77181),f=n(68197),m=n(59624),h=n(59491),p=n(2717),Z=n(90954),v=n(18333),x=n(89281),g=n(24511),j=n(4446),b=n(84980),y=n(51282),O=n(5764),S=n(46417);t.default=function(){var e,t,n=(0,g.$)().t,C=(0,p.v9)((function(e){return e.menu}),p.wU).activeMenu,w=(0,p.I0)(),_=o.Z.useForm(),F=(0,r.Z)(_,1)[0],I=(0,l.s0)(),k=(0,l.UO)().id,U=(0,p.v9)((function(e){return e.myShop}),p.wU).myShop,q=(0,s.useState)(null!==(e=C.data)&&void 0!==e&&e.images?[null===(t=C.data)||void 0===t?void 0:t.images[0]]:[]),N=(0,r.Z)(q,2),T=N[0],V=N[1],z=(0,s.useState)(!1),A=(0,r.Z)(z,2),M=A[0],E=A[1],L=(0,s.useState)(!1),B=(0,r.Z)(L,2),$=B[0],D=B[1];(0,s.useEffect)((function(){return function(){var e=F.getFieldsValue(!0);w((0,Z.nc)({activeMenu:C,data:e}))}}),[]);var G=function(e){return e.map((function(e){return{name:e,url:e}}))};return(0,s.useEffect)((function(){var e;C.refetch&&(e=k,D(!0),j.Z.getById(e).then((function(e){var t=e.data;F.setFieldsValue((0,a.Z)((0,a.Z)({},t),{},{image:G(t.file_urls),products:{label:t.product.translation.title,value:t.product.id}})),V(G(t.file_urls))})).finally((function(){D(!1),w((0,Z.A_)(C))})))}),[C.refetch]),(0,S.jsx)(d.Z,{title:n("edit.story"),className:"h-100",children:$?(0,S.jsx)(y.Z,{}):(0,S.jsxs)(o.Z,{name:"story-add",layout:"vertical",onFinish:function(e){var t=(0,a.Z)((0,a.Z)({},Object.assign.apply(Object,[{}].concat((0,u.Z)(T.map((function(e,t){return(0,i.Z)({},"file_urls[".concat(t,"]"),e.name)})))))),{},{product_id:e.products.value});E(!0);var r="seller/stories";j.Z.update(k,t).then((function(){var e={shop_id:U.id};c.Am.success(n("successfully.updated")),(0,p.dC)((function(){w((0,Z.ph)((0,a.Z)((0,a.Z)({},C),{},{nextUrl:r}))),w((0,b.U7)(e))})),I("/".concat(r))})).finally((function(){return E(!1)}))},form:F,initialValues:(0,a.Z)({active:!0},C.data),className:"d-flex flex-column h-100",children:[(0,S.jsxs)(f.Z,{gutter:12,children:[(0,S.jsx)(m.Z,{span:12,children:(0,S.jsx)(o.Z.Item,{label:n("products"),name:"products",rules:[{required:!1,message:n("required")}],children:(0,S.jsx)(x.h,{fetchOptions:function(e){var t={search:e,shop_id:U.id,status:"published",active:1,rest:1};return v.Z.getAll(t).then((function(e){return e.data.map((function(e){return{label:e.translation.title,value:e.id,key:e.id}}))}))},debounceTimeout:200})})}),(0,S.jsx)(m.Z,{span:12,children:(0,S.jsx)(o.Z.Item,{label:n("image"),name:"image",rules:[{required:0===T.length,message:n("required")}],children:(0,S.jsx)(O.Z,{type:"banners",imageList:T,setImageList:V,form:F,multiple:!1})})})]}),(0,S.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,S.jsx)("div",{className:"pb-5",children:(0,S.jsx)(h.Z,{type:"primary",htmlType:"submit",loading:M,children:n("submit")})})})]})})}}}]);