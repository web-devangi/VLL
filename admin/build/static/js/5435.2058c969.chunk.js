(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[5435],{55940:function(e,n,t){"use strict";t.d(n,{Z:function(){return v}});var i=t(1413),l=t(45987),o=(t(47313),t(59491)),r=t(47515),u=t(23560),a=t(24511),d=t(79492),s=t(46417),c=["size","onClick","type"];function v(e){var n=e.size,t=void 0===n?"":n,v=e.onClick,f=e.type,h=void 0===f?"default":f,Z=(0,l.Z)(e,c),m=(0,a.$)().t,p=(0,d.Z)().isDemo;return(0,s.jsx)(o.Z,(0,i.Z)({size:t,icon:(0,s.jsx)(r.Z,{}),onClick:function(e){p?u.Am.warning(m("cannot.work.demo")):v(e)},type:h},Z))}},53233:function(e,n,t){"use strict";var i=t(1413),l=t(29439),o=t(47313),r=t(56140),u=t(67251),a=t(45705),d=t(86345),s=t(78267),c=t(37388),v=t(59491),f=t(99587),h=t(24511),Z=t(46417),m=r.Z.Text;n.Z=function(e){var n=e.columns,t=void 0===n?[]:n,r=e.setColumns,p=e.style,x=e.size,y=void 0===x?"":x,j=e.iconOnly,g=(0,h.$)().t,b=(0,o.useState)(!1),C=(0,l.Z)(b,2),w=C[0],_=C[1],k=(0,Z.jsx)(u.Z,{children:null===t||void 0===t?void 0:t.map((function(e,n){return(0,Z.jsx)(u.Z.Item,{children:(0,Z.jsxs)(a.Z,{className:"d-flex justify-content-between",children:[(0,Z.jsx)(m,{children:e.title}),(0,Z.jsx)(d.Z,{defaultChecked:!0,onClick:function(){return function(e){var n=null===t||void 0===t?void 0:t.map((function(n){return n.dataIndex===e.dataIndex&&(n.is_show=!(null!==n&&void 0!==n&&n.is_show)),n}));r(n)}(e)},disabled:1===n})]})},e+n)}))});return(0,Z.jsx)(s.Z,{overlay:k,trigger:["click"],onVisibleChange:function(e){_(e)},visible:w,children:(0,Z.jsx)(c.Z,{title:g("change.columns"),children:(0,Z.jsx)(v.Z,{style:(0,i.Z)({},p),size:y,icon:(0,Z.jsx)(f.Z,{}),children:j?null:g("Columns")})})})}},73431:function(e,n,t){"use strict";var i=t(47313),l=t(39180),o=t(2717),r=t(28830),u=t(60535),a=t(46417);n.Z=function(){var e=(0,o.I0)(),n=(0,o.v9)((function(e){return e.formLang}),o.wU),t=n.languages,d=n.defaultLang;(0,i.useEffect)((function(){u.Z.getAllActive().then((function(n){var t=n.data;e((0,r.dc)(t)),e((0,r.mh)(t.find((function(e){return 1===e.default})).locale))}))}),[]);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(l.ZP.Group,{value:d,onChange:function(n){var t=n.target.value;e((0,r.mh)(t))},className:"float-right",buttonStyle:"solid",children:null===t||void 0===t?void 0:t.map((function(e){return(0,a.jsx)(l.ZP.Button,{value:e.locale,children:e.title},e.id)}))})})}},41481:function(e,n,t){"use strict";t.d(n,{Z:function(){return v}});var i=t(1413),l=t(29439),o=t(45987),r=t(47313),u=t(66672),a=t(16031),d=t(40765),s=t(46417),c=["handleChange","defaultValue","resetSearch"];function v(e){var n=e.handleChange,t=e.defaultValue,v=e.resetSearch,f=(0,o.Z)(e,c),h=(0,r.useState)(t),Z=(0,l.Z)(h,2),m=Z[0],p=Z[1],x=(0,r.useMemo)((function(){return(0,a.debounce)((function(e){n(e)}),800)}),[]);return(0,r.useEffect)((function(){p(t)}),[v]),(0,s.jsx)(u.Z,(0,i.Z)({value:m,onChange:function(e){p(e.target.value),x(e.target.value)},prefix:(0,s.jsx)(d.Z,{})},f))}},89281:function(e,n,t){"use strict";t.d(n,{h:function(){return f}});var i=t(1413),l=t(29439),o=t(45987),r=t(47313),u=t(12279),a=t.n(u),d=t(74294),s=t(72652),c=t(46417),v=["fetchOptions","debounceTimeout","onClear","refetchOptions"],f=function(e){var n=e.fetchOptions,t=e.debounceTimeout,u=void 0===t?400:t,f=e.onClear,h=e.refetchOptions,Z=void 0!==h&&h,m=(0,o.Z)(e,v),p=(0,r.useState)(!1),x=(0,l.Z)(p,2),y=x[0],j=x[1],g=(0,r.useState)([]),b=(0,l.Z)(g,2),C=b[0],w=b[1],_=(0,r.useMemo)((function(){return a()((function(e){w([]),j(!0),n(e).then((function(e){w(e),j(!1)}))}),u)}),[n,u]);return(0,c.jsx)(d.Z,(0,i.Z)((0,i.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:_,onClear:function(){_(""),f&&f()},notFoundContent:y?(0,c.jsx)(s.Z,{size:"small"}):"no results"},m),{},{options:C,onFocus:function(){C.length&&!Z||_("")}}))}},13945:function(e,n,t){"use strict";function i(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}t.d(n,{Z:function(){return i}})},84017:function(e,n,t){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after",i=Number(e).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===t?"".concat(i," ").concat(n):"".concat(n," ").concat(i)}t.d(n,{Z:function(){return i}})},33834:function(e,n,t){"use strict";t.d(n,{K:function(){return a}});var i=t(4942),l=t(1413),o=t(97890),r=t(74776),u=t.n(r),a=function(){var e=(0,o.s0)(),n=(0,o.TH)(),t=u().parse(n.search,{ignoreQueryPrefix:!0});return{values:t,set:function(n,o){return e({search:u().stringify((0,l.Z)((0,l.Z)({},t),{},(0,i.Z)({},n,o)))})},reset:function(n){var i=(0,l.Z)({},t);i[n]&&delete i[n],e({search:u().stringify((0,l.Z)({},i))})},clear:function(){return e({search:u().stringify({})})},merge:function(n){return e({search:u().stringify((0,l.Z)((0,l.Z)({},t),n))})}}}},55508:function(e,n,t){"use strict";var i=t(39180),l=(t(47313),t(58821)),o=t(54972),r=t(97890),u=t(46417),a=[{value:"seller/orders-board",title:"Board",icon:(0,u.jsx)(o.Ez2,{size:20})},{value:"seller/orders",title:"List",icon:(0,u.jsx)(l.Ps6,{size:20})}];n.Z=function(e){var n=e.listType,t=(0,r.UO)().type,l=(0,r.s0)();return(0,u.jsx)(i.ZP.Group,{value:n,onChange:function(e){l("/".concat(e.target.value).concat(t?"/".concat(t):""))},className:"float-right",buttonStyle:"solid",children:null===a||void 0===a?void 0:a.map((function(e){return(0,u.jsx)(i.ZP.Button,{value:e.value,children:(0,u.jsxs)("div",{className:"d-flex align-items-center",style:{gap:"10px"},children:[e.icon,e.title]})},e.value)}))})}},50110:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return W}});var i=t(15861),l=t(4942),o=t(1413),r=t(93433),u=t(29439),a=t(87757),d=t.n(a),s=t(47313),c=t(99096),v=t(73591),f=t(66204),h=t(45705),Z=t(59491),m=t(77181),p=t(74294),x=t(78508),y=t(97890),j=t(12019),g=t(31741),b=t(47515),C=t(55768),w=t(15386),_=t(2717),k=t(90954),S=t(24511),I=t(80314),M=t(41589),O=t(13945),Y=t(41481),P=t(73270),z=t(84017),D=t(89281),U=t(58328),A=t(53233),F=t(40197),L=t(55940),T=t(74580),B=t(23560),E=t(69658),N=t(62412),V=t(88852),H=t(27107),$=t(55508),K=t(33834),q=t(70816),G=t.n(q),R=t(46417),J=c.Z.RangePicker,Q=v.Z.TabPane;function W(){var e,n,t,a,c,q,W,X,ee,ne,te,ie=(0,_.I0)(),le=(0,y.s0)(),oe=(0,S.$)().t,re=(0,y.UO)(),ue=(0,s.useState)(null),ae=(0,u.Z)(ue,2),de=ae[0],se=ae[1],ce=(0,s.useState)(null),ve=(0,u.Z)(ce,2),fe=ve[0],he=ve[1],Ze=(0,s.useContext)(T._).setIsModalVisible,me=(0,s.useState)(!1),pe=(0,u.Z)(me,2),xe=pe[0],ye=pe[1],je=(0,_.v9)((function(e){return e.currency}),_.wU).defaultCurrency,ge=(0,_.v9)((function(e){return e.orderStatus}),_.wU).statusList,be=null===re||void 0===re?void 0:re.type,Ce=[{name:"all",id:0,active:!0,sort:0}].concat((0,r.Z)(ge)),we=(0,s.useState)(null),_e=(0,u.Z)(we,2),ke=_e[0],Se=_e[1],Ie=(0,s.useState)(null),Me=(0,u.Z)(Ie,2),Oe=Me[0],Ye=Me[1],Pe=(0,s.useState)([{title:oe("id"),dataIndex:"id",key:"id",sorter:!0,is_show:!0},{title:oe("client"),dataIndex:"user",key:"user",is_show:!0,render:function(e){return e?(0,R.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.firstname)||""," ",(null===e||void 0===e?void 0:e.lastname)||""]}):(0,R.jsx)(f.Z,{color:"red",children:oe("deleted.user")})}},{title:oe("status"),is_show:!0,dataIndex:"status",key:"status",render:function(e,n){return(0,R.jsxs)("div",{className:"cursor-pointer",children:["new"===e?(0,R.jsx)(f.Z,{color:"blue",children:oe(e)}):"canceled"===e?(0,R.jsx)(f.Z,{color:"error",children:oe(e)}):(0,R.jsx)(f.Z,{color:"cyan",children:oe(e)}),"delivered"!==e&&"canceled"!==e&&1!==n.type?(0,R.jsx)(j.Z,{onClick:function(e){e.stopPropagation(),Ye(null===n||void 0===n?void 0:n.id)}}):""]})}},{title:oe("deliveryman"),is_show:!0,dataIndex:"deliveryman",key:"deliveryman",render:function(e){return(0,R.jsxs)("div",{children:[(null===e||void 0===e?void 0:e.firstname)||"-"," ",(null===e||void 0===e?void 0:e.lastname)||"-"]})}},{title:oe("number.of.products"),dataIndex:"order_details_count",key:"order_details_count",is_show:!0,render:function(e){return(0,R.jsxs)("div",{className:"text-lowercase",children:[e||0," ",oe("products")]})}},{title:oe("amount"),dataIndex:"total_price",key:"total_price",is_show:!0,render:function(e){return(0,z.Z)(e,null===je||void 0===je?void 0:je.symbol)}},{title:oe("payment.type"),dataIndex:"transaction",key:"transaction",is_show:!0,render:function(e){var n;return oe(null===e||void 0===e||null===(n=e.payment_system)||void 0===n?void 0:n.tag)||"-"}},{title:oe("created.at"),is_show:!0,dataIndex:"created_at",key:"created_at",render:function(e){return G()(e).format("YYYY-MM-DD HH:mm")}},{title:oe("delivery.date"),is_show:!0,dataIndex:"delivery_date",key:"delivery_date",render:function(e){return G()(e).format("YYYY-MM-DD HH:mm")}},{title:oe("options"),key:"options",is_show:!0,render:function(e,n){return(0,R.jsxs)(h.Z,{children:[(0,R.jsx)(Z.Z,{icon:(0,R.jsx)(g.Z,{}),onClick:function(){return function(e){ie((0,k.bL)({url:"seller/order/details/".concat(e.id),id:"order_details",name:oe("order.details")})),le("/seller/order/details/".concat(e.id))}(n)}}),(0,R.jsx)(Z.Z,{icon:(0,R.jsx)(j.Z,{}),onClick:function(){return tn(n)},disabled:2!==(null===n||void 0===n?void 0:n.type)||"canceled"===(null===n||void 0===n?void 0:n.status)||"delivered"===(null===n||void 0===n?void 0:n.status)}),(0,R.jsx)(L.Z,{icon:(0,R.jsx)(b.Z,{}),onClick:function(){se([n.id]),Ze(!0),he(!0)}})]})}}]),ze=(0,u.Z)(Pe,2),De=ze[0],Ue=ze[1],Ae=(0,_.v9)((function(e){return e.menu}),_.wU).activeMenu,Fe=(0,K.K)(),Le=(0,s.useState)(Fe.values.status||"all"),Te=(0,u.Z)(Le,2),Be=Te[0],Ee=Te[1],Ne=(null===(e=Ae.data)||void 0===e?void 0:e.role)||Be,Ve=(0,_.v9)((function(e){return e.sellerOrders}),_.wU),He=Ve.orders,$e=Ve.meta,Ke=Ve.loading,qe=Ve.params,Ge=(0,s.useState)(null),Re=(0,u.Z)(Ge,2),Je=Re[0],Qe=Re[1],We=null===Ae||void 0===Ae?void 0:Ae.data,Xe={search:null===We||void 0===We?void 0:We.search,sort:null===We||void 0===We?void 0:We.sort,column:null===We||void 0===We?void 0:We.column,perPage:null===We||void 0===We?void 0:We.perPage,page:null===We||void 0===We?void 0:We.page,user_id:null===We||void 0===We?void 0:We.user_id,status:"all"===Ne?void 0:Ne,shop_id:null!==(null===(n=Ae.data)||void 0===n?void 0:n.shop_id)?null===(t=Ae.data)||void 0===t?void 0:t.shop_id:null,delivery_type:be||(null!==(null===(a=Ae.data)||void 0===a?void 0:a.delivery_type)?null===(c=Ae.data)||void 0===c?void 0:c.delivery_type:null),date_from:(null===Je||void 0===Je||null===(q=Je[0])||void 0===q?void 0:q.format("YYYY-MM-DD"))||void 0,date_to:(null===Je||void 0===Je||null===(W=Je[1])||void 0===W?void 0:W.format("YYYY-MM-DD"))||void 0};(0,I.Z)((function(){ie((0,M.AU)(Xe))}),[null===Ae||void 0===Ae?void 0:Ae.data,Je]),(0,s.useEffect)((function(){null!==Ae&&void 0!==Ae&&Ae.refetch&&(0,_.dC)((function(){ie((0,M.AU)(Xe)),ie((0,F.ZL)({})),ie((0,k.A_)(Ae))}))}),[null===Ae||void 0===Ae?void 0:Ae.refetch]);var en=function(e,n){ie((0,k.nc)({activeMenu:Ae,data:(0,o.Z)((0,o.Z)({},We),{},(0,l.Z)({},n,e))}))};function nn(){return nn=(0,i.Z)(d().mark((function e(n){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,perPage:10},e.abrupt("return",U.Z.getAll(t).then((function(e){return e.data.map((function(e){return{label:"".concat(e.firstname," ").concat(e.lastname),value:e.id,key:e.id}}))})));case 2:case"end":return e.stop()}}),e)}))),nn.apply(this,arguments)}var tn=function(e){(0,_.dC)((function(){ie((0,P.bn)()),ie((0,k.bL)({url:"seller/order/".concat(e.id),id:"seller_order_edit",name:oe("edit.order")}))})),le("/seller/order/".concat(e.id))},ln={selectedRowKeys:de,onChange:function(e){se(e)}},on=function(){Se(null),Ye(null)};return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(h.Z,{className:"justify-content-end w-100 mb-3",children:[(0,R.jsx)($.Z,{listType:"seller/orders"}),(0,R.jsx)(Z.Z,{type:"primary",icon:(0,R.jsx)(C.Z,{}),onClick:function(){ie((0,P.bn)()),ie((0,k.bL)({id:"pos.system",url:"seller/pos-system",name:oe("add.order")})),le("/seller/pos-system",{state:{delivery_type:be}})},style:{width:"100%"},children:oe("add.order")})]}),(0,R.jsx)(m.Z,{children:(0,R.jsxs)(h.Z,{wrap:!0,className:"p-0 mb-0",children:[(0,R.jsx)(Y.Z,{placeholder:oe("search"),handleChange:function(e){return en(e,"search")},defaultValue:null===(X=Ae.data)||void 0===X?void 0:X.search}),(0,R.jsx)(D.h,{placeholder:oe("select.client"),fetchOptions:function(e){return nn.apply(this,arguments)},onSelect:function(e){return en(e.value,"search")},onDeselect:function(){return en(null,"search")},style:{minWidth:200}}),(0,R.jsx)(J,{value:Je,onChange:function(e){en(JSON.stringify(e),"data_time"),Qe(e)},disabledDate:function(e){return e&&e>G()().endOf("day")},style:{width:"100%"}}),!be&&(0,R.jsx)(p.Z,{value:null===We||void 0===We?void 0:We.delivery_type,placeholder:oe("order.type"),onSelect:function(e){return en(e,"delivery_type")},options:[{label:oe("pickup"),value:"pickup"},{label:oe("delivery"),value:"delivery"}],allowClear:!0,style:{width:"100%"},onDeselect:function(){return en(null,"delivery_type")}}),(0,R.jsx)(Z.Z,{icon:(0,R.jsx)(w.Z,{}),onClick:function(){(0,_.dC)((function(){ie((0,M.H5)()),ie((0,k.nc)({activeMenu:Ae,data:null}))})),ie((0,M.AU)({status:"all",page:null===We||void 0===We?void 0:We.page,perPage:10}))},children:oe("clear")}),(0,R.jsx)(L.Z,{size:"",onClick:function(){null===de||0===de.length?B.Am.warning(oe("select.the.product")):(Ze(!0),he(!1))},children:oe("delete.selected")}),(0,R.jsx)(A.Z,{columns:De,setColumns:Ue})]})}),(0,R.jsxs)(m.Z,{children:[(0,R.jsx)(v.Z,{onChange:function(e){var n=e;ie((0,k.nc)({activeMenu:Ae,data:{role:n,page:1}})),Ee(e),le("?status=".concat(n))},type:"card",activeKey:Ne,children:Ce.filter((function(e){return!0===e.active})).map((function(e){return(0,R.jsx)(Q,{tab:oe(e.name)},e.name)}))}),(0,R.jsx)(x.Z,{scroll:{x:!0},rowSelection:ln,columns:null===De||void 0===De?void 0:De.filter((function(e){return e.is_show})),dataSource:He,loading:Ke,pagination:{pageSize:qe.perPage,page:(null===(ee=Ae.data)||void 0===ee?void 0:ee.page)||1,total:null===$e||void 0===$e?void 0:$e.total,defaultCurrent:null===(ne=Ae.data)||void 0===ne?void 0:ne.page,current:null===(te=Ae.data)||void 0===te?void 0:te.page},rowKey:function(e){return e.id},onChange:function(e,n,t){var i=e.pageSize,l=e.current,r=t.field,u=t.order,a=(0,O.Z)(u);ie((0,k.nc)({activeMenu:Ae,data:(0,o.Z)((0,o.Z)({},We),{},{perPage:i,page:l,column:r,sort:a})}))}}),(0,R.jsx)(E.Z,{click:function(){ye(!0);var e=(0,o.Z)({},Object.assign.apply(Object,[{}].concat((0,r.Z)(de.map((function(e,n){return(0,l.Z)({},"ids[".concat(n,"]"),e)}))))));N.Z.delete(e).then((function(){B.Am.success(oe("successfully.deleted")),Ze(!1),ie((0,M.AU)(Xe)),he(null)})).finally((function(){return ye(!1)}))},text:oe(fe?"delete":"all.delete"),loading:xe,setText:se})]}),Oe&&(0,R.jsx)(H.Z,{orderId:Oe,handleCancel:on,refetchPage:function(){return(0,_.dC)((function(){ie((0,M.AU)(Xe)),ie((0,k.A_)(Ae))}))}}),ke&&(0,R.jsx)(V.Z,{orderDetails:ke,handleCancel:on})]})}},88852:function(e,n,t){"use strict";t.d(n,{Z:function(){return x}});var i=t(29439),l=t(47313),o=t(10976),r=t(9274),u=t(59491),a=t(68197),d=t(59624),s=t(2717),c=t(62412),v=t(90954),f=t(24511),h=t(94291),Z=t(89281),m=t(58328),p=t(46417);function x(e){var n,t=e.orderDetails,x=e.handleCancel,y=(0,f.$)().t,j=(0,s.v9)((function(e){return e.menu}),s.wU).activeMenu,g=((0,s.v9)((function(e){return e.deliveryman}),s.wU).deliverymans,o.Z.useForm()),b=(0,i.Z)(g,1)[0],C=(0,s.I0)(),w=(0,l.useState)(!1),_=(0,i.Z)(w,2),k=_[0],S=_[1];(0,l.useEffect)((function(){C((0,h.EH)())}),[]);return(0,p.jsx)(r.Z,{visible:!!t,title:t.title,onCancel:x,footer:[(0,p.jsx)(u.Z,{type:"primary",onClick:function(){return b.submit()},loading:k,children:y("save")}),(0,p.jsx)(u.Z,{type:"default",onClick:x,children:y("cancel")})],children:(0,p.jsx)(o.Z,{form:b,layout:"vertical",onFinish:function(e){var n={deliveryman:e.deliveryman.value};S(!0),c.Z.updateDelivery(t.id,n).then((function(){x(),C((0,v.xo)(j))})).finally((function(){return S(!1)}))},initialValues:{deliveryman:null===(n=t.deliveryman)||void 0===n?void 0:n.id},children:(0,p.jsx)(a.Z,{gutter:12,children:(0,p.jsx)(d.Z,{span:24,children:(0,p.jsx)(o.Z.Item,{label:y("deliveryman"),name:"deliveryman",rules:[{required:!0,message:y("required")}],children:(0,p.jsx)(Z.h,{fetchOptions:function(e){var n={perPage:10,page:1,search:e};return m.Z.getDeliverymans(n).then((function(e){return e.data.map((function(e){return{label:e.firstname,value:e.id}}))}))}})})})})})})}},27107:function(e,n,t){"use strict";t.d(n,{Z:function(){return I}});var i=t(4942),l=t(93433),o=t(1413),r=t(29439),u=t(47313),a=t(35432),d=t(10976),s=t(9274),c=t(59491),v=t(68197),f=t(59624),h=t(66672),Z=t(46155),m=t(74294),p=t(2717),x=t(24511),y=t(62412),j=t(51282),g=t(73431),b=t(20052),C=t(12019),w=t(70816),_=t.n(w),k=t(46417),S=a.Z.Panel;function I(e){var n,t=e.orderId,w=e.handleCancel,I=e.refetchPage,M=(0,p.v9)((function(e){return e.orderStatus}),p.wU).statusList,O=(0,p.v9)((function(e){return e.formLang}),p.wU),Y=O.defaultLang,P=O.languages,z=d.Z.useForm(),D=(0,r.Z)(z,1)[0],U=(0,x.$)().t,A=(0,u.useRef)(null),F=(0,u.useState)(!1),L=(0,r.Z)(F,2),T=L[0],B=L[1],E=(0,u.useState)(!1),N=(0,r.Z)(E,2),V=N[0],H=N[1],$=(0,u.useState)(null!==M&&void 0!==M&&M.length?M.map((function(e){return{value:null===e||void 0===e?void 0:e.name,label:U(null===e||void 0===e?void 0:e.name),key:null===e||void 0===e?void 0:e.id}})):[]),K=(0,r.Z)($,2),q=K[0],G=K[1],R=(0,u.useState)(null),J=(0,r.Z)(R,2),Q=J[0],W=J[1],X=(0,u.useState)(null),ee=(0,r.Z)(X,2),ne=ee[0],te=ee[1],ie=(0,u.useState)(null),le=(0,r.Z)(ie,2),oe=le[0],re=le[1],ue=(0,u.useState)(null),ae=(0,r.Z)(ue,2),de=ae[0],se=ae[1];(0,u.useEffect)((function(){B(!0),y.Z.getById(t).then((function(e){var n,t,i,l;W(e.data),te(null===(n=e.data)||void 0===n||null===(t=n.notes)||void 0===t?void 0:t.filter((function(e){var n;return!(null===e||void 0===e||null===(n=e.notes)||void 0===n||!n.length)}))),se(null===(i=e.data)||void 0===i?void 0:i.status),D.setFieldsValue({status:null===e||void 0===e||null===(l=e.data)||void 0===l?void 0:l.status})})).finally((function(){return B(!1)}))}),[t]),(0,u.useEffect)((function(){var e,n;if("pause"!==(null===Q||void 0===Q?void 0:Q.status)){var t,i=M.findIndex((function(e){return e.name===(null===Q||void 0===Q?void 0:Q.status)})),l=i>=0?[M[i],i<M.length-1?"pause"===(null===(e=M[i+1])||void 0===e?void 0:e.name)?M[i+2]:M[i+1]:null]:[i<M.length-1?M[i+1]:null];if("on_a_way"===(null===(n=M[i])||void 0===n?void 0:n.name)&&l.push(M[i+3]),null!==M&&void 0!==M&&M.filter((function(e){return"pause"===(null===e||void 0===e?void 0:e.name)&&(null===e||void 0===e?void 0:e.active)})))null===l||void 0===l||l.push(null===M||void 0===M||null===(t=M.filter((function(e){return"pause"===(null===e||void 0===e?void 0:e.name)&&(null===e||void 0===e?void 0:e.active)})))||void 0===t?void 0:t[0]);l.push({name:"canceled",id:8,active:!0,sort:(null===M||void 0===M?void 0:M.length)+1}),G(l.filter(Boolean).map((function(e){return{value:null===e||void 0===e?void 0:e.name,label:U(null===e||void 0===e?void 0:e.name),key:null===e||void 0===e?void 0:e.id}})))}else G(null===M||void 0===M?void 0:M.map((function(e){return{value:null===e||void 0===e?void 0:e.name,label:U(null===e||void 0===e?void 0:e.name),key:null===e||void 0===e?void 0:e.id}})))}),[Q]);var ce=function(e){var n=Object.entries(e).filter((function(e){var n=(0,r.Z)(e,2);n[0];return!!n[1]}));if(0!==(null===n||void 0===n?void 0:n.length))return Object.fromEntries(n)};return(0,u.useEffect)((function(){var e;D.setFieldsValue((0,i.Z)({},"title[".concat(Y||"en","]"),null===oe||void 0===oe||null===(e=oe.title)||void 0===e?void 0:e[Y||"en"]))}),[Y]),(0,k.jsx)(s.Z,{visible:!!t,title:[U("order.status")],onCancel:w,footer:[(0,k.jsx)(c.Z,{type:"primary",onClick:function(){return D.submit()},loading:V,children:U("save")},"save-form"),(0,k.jsx)(c.Z,{type:"default",onClick:w,children:U("cancel")},"cansel-modal")],children:T?(0,k.jsx)(j.Z,{}):(0,k.jsx)(k.Fragment,{children:(0,k.jsxs)(d.Z,{form:D,layout:"vertical",onFinish:function(e){var n,t=null;H(!0),oe&&(null===e||void 0===e?void 0:e.status)===(null===Q||void 0===Q?void 0:Q.status)&&(t=(0,o.Z)({},Object.assign.apply(Object,[{}].concat((0,l.Z)(P.map((function(n){return(0,i.Z)({},n.locale,e["title[".concat(n.locale,"]")])})))))),t=ce(t));var r=ce((0,o.Z)({},Object.assign.apply(Object,[{}].concat((0,l.Z)(P.map((function(n){return(0,i.Z)({},n.locale,e["note[".concat(n.locale,"]")])}))))))),u=r?{title:r}:null,a=(null===Q||void 0===Q?void 0:Q.status)===(null===e||void 0===e?void 0:e.status)?null===Q||void 0===Q||null===(n=Q.notes)||void 0===n?void 0:n.filter((function(n){return(null===n||void 0===n?void 0:n.status)===(null===e||void 0===e?void 0:e.status)})).flatMap((function(e){var n;return null===e||void 0===e||null===(n=e.notes)||void 0===n?void 0:n.map((function(e,n){return n===(null===oe||void 0===oe?void 0:oe.index)?(0,o.Z)((0,o.Z)({},e),{},{title:(0,o.Z)((0,o.Z)({},null===e||void 0===e?void 0:e.title),t)}):e}))})).filter(Boolean):[],d={status:null===e||void 0===e?void 0:e.status,notes:[].concat((0,l.Z)(a),[u]).filter(Boolean)};y.Z.updateStatus(Q.id,d).then((function(){w(),I()})).finally((function(){return H(!1)}))},name:"order-status-change-form",children:[(0,k.jsx)(v.Z,{gutter:12,style:{marginBottom:"20px"},children:(0,k.jsx)(f.Z,{span:24,children:(0,k.jsx)(g.Z,{})})}),!(null===Q||void 0===Q||null===(n=Q.notes)||void 0===n||!n.some((function(e){var n;return!(null===e||void 0===e||null===(n=e.notes)||void 0===n||!n.length)})))&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(a.Z,{children:null===ne||void 0===ne?void 0:ne.map((function(e){var n;return(0,k.jsx)(S,{header:U(null===e||void 0===e?void 0:e.status),children:(null===e||void 0===e||null===(n=e.notes)||void 0===n?void 0:n.map((function(n,t){var l,o,r;return(0,k.jsxs)(v.Z,{style:{marginBottom:"15px",display:"flex",justifyContent:"space-between"},gutter:12,children:[(0,k.jsxs)(f.Z,{span:(null===e||void 0===e?void 0:e.status)===(null===Q||void 0===Q?void 0:Q.status)&&de===(null===Q||void 0===Q?void 0:Q.status)?22:24,children:[(0,k.jsxs)("div",{style:{display:"flex",columnGap:"10px"},children:[(0,k.jsxs)("span",{style:{marginTop:"3px"},children:[t+1,"."," "]}),(0,k.jsxs)("div",{style:{width:"100%"},children:[(0,k.jsx)("p",{style:{margin:0,fontSize:"15px",wordBreak:"break-all"},hidden:(null===oe||void 0===oe?void 0:oe.orderId)===(null===e||void 0===e?void 0:e.id)&&(null===oe||void 0===oe?void 0:oe.index)===t&&(null===Q||void 0===Q?void 0:Q.status)===de,children:(null===n||void 0===n||null===(l=n.title)||void 0===l?void 0:l[Y||"en"])||"--"}),(0,k.jsx)(d.Z.Item,{name:"title[".concat(Y||"en","]"),hidden:(null===oe||void 0===oe?void 0:oe.orderId)!==(null===e||void 0===e?void 0:e.id)||(null===oe||void 0===oe?void 0:oe.index)!==t||(null===Q||void 0===Q?void 0:Q.status)!==de,children:(0,k.jsx)(h.Z.TextArea,{maxLength:200,style:{width:"100%"},rows:Math.floor((null===n||void 0===n||null===(o=n.title)||void 0===o||null===(r=o[Y||"en"])||void 0===r?void 0:r.length)/41||0)+1,ref:A},t)})]})]}),(0,k.jsx)("p",{style:{fontSize:"12px",margin:0,float:"right"},children:_()(null===n||void 0===n?void 0:n.created_at).format("DD-MM-YYYY HH:mm")})]}),(null===e||void 0===e?void 0:e.status)===(null===Q||void 0===Q?void 0:Q.status)&&(null===Q||void 0===Q?void 0:Q.status)===de&&(0,k.jsx)(f.Z,{span:2,children:(null===oe||void 0===oe?void 0:oe.orderId)===(null===e||void 0===e?void 0:e.id)&&t===(null===oe||void 0===oe?void 0:oe.index)?(0,k.jsx)(c.Z,{type:"primary",icon:(0,k.jsx)(b.Z,{}),size:"small",onClick:function(){return D.submit()},loading:V}):(null===e||void 0===e?void 0:e.status)===(null===Q||void 0===Q?void 0:Q.status)&&(0,k.jsx)(c.Z,{icon:(0,k.jsx)(C.Z,{}),size:"small",onClick:function(){var l;A.current.focus(),re({orderId:null===e||void 0===e?void 0:e.id,index:t,title:null===n||void 0===n?void 0:n.title}),D.setFieldsValue((0,i.Z)({},"title[".concat(Y||"en","]"),null===n||void 0===n||null===(l=n.title)||void 0===l?void 0:l[Y||"en"]))}})})]},t)})))||"--"},null===e||void 0===e?void 0:e.id)}))}),(0,k.jsx)(Z.Z,{})]}),(0,k.jsxs)(v.Z,{gutter:12,children:[(0,k.jsx)(f.Z,{span:24,children:(0,k.jsx)(d.Z.Item,{label:U("status"),name:"status",rules:[{required:!0,message:U("required")}],children:(0,k.jsx)(m.Z,{options:q,onSelect:function(e){return se(e)}})})}),(0,k.jsx)(f.Z,{span:24,children:P.map((function(e){return(0,k.jsx)(d.Z.Item,{name:"note[".concat(null===e||void 0===e?void 0:e.locale,"]"),label:U("note"),hidden:(null===e||void 0===e?void 0:e.locale)!==Y,children:(0,k.jsx)(h.Z.TextArea,{maxLength:200})},"note_".concat(null===e||void 0===e?void 0:e.id))}))})]})]})})})}},24654:function(){}}]);