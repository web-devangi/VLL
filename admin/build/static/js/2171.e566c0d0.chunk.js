"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[2171],{56814:function(e,n,t){var r=t(15861),a=t(87757),i=t.n(a),l=(t(47313),t(52838)),o=t(19107),s=t(97421),d=t(2717),u=t(10976),c=t(74294),m=t(23885),v=t(46417);n.Z=function(e){var n=e.value,t=e.setValue,a=e.setLocation,p=(0,l.Z)({apiKey:s.kr,libraries:["places","geocode"]}),f=p.placePredictions,h=p.getPlacePredictions,g=p.isPlacePredictionsLoading,Z=(0,d.v9)((function(e){return e.formLang}),d.wU),x=Z.defaultLang,y=Z.languages;return(0,v.jsx)("div",{children:y.map((function(e,l){return(0,v.jsx)(u.Z.Item,{label:(0,m.t)("address"),name:"address[".concat(e.locale,"]"),rules:[{required:e.locale===x,message:(0,m.t)("required")}],hidden:e.locale!==x,children:(0,v.jsx)(c.Z,{allowClear:!0,searchValue:n,showSearch:!0,autoClearSearchValue:!0,loading:g,options:null===f||void 0===f?void 0:f.map((function(e){return{label:e.description,value:e.description}})),onSearch:function(e){t(e),e.length>0&&h({input:e})},onSelect:function(){var e=(0,r.Z)(i().mark((function e(n){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.Z)(n);case 2:t=e.sent,a({lat:null===t||void 0===t?void 0:t.geometry.location.lat,lng:null===t||void 0===t?void 0:t.geometry.location.lng});case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()})},"address"+l)}))})}},2772:function(e,n,t){t.d(n,{I:function(){return r}});var r=[{label:"IN_HOUSE",value:1,key:1},{label:"SELLER",value:2,key:2}]},19107:function(e,n,t){t.d(n,{Z:function(){return d}});var r=t(15861),a=t(87757),i=t.n(a),l=t(31881),o=t.n(l),s=t(97421);function d(e){return u.apply(this,arguments)}function u(){return u=(0,r.Z)(i().mark((function e(n){var t,r,a=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>1&&void 0!==a[1]?a[1]:s.kr,r={address:n,key:t},e.abrupt("return",o().get("https://maps.googleapis.com/maps/api/geocode/json",{params:r}).then((function(e){return e.data.results[0]})).catch((function(e){return"not found"})));case 3:case"end":return e.stop()}}),e)}))),u.apply(this,arguments)}},40622:function(e,n,t){t.d(n,{Z:function(){return U}});var r=t(1413),a=t(29439),i=t(47313),l=t(10976),o=t(45705),s=t(59491),d=t(97890),u=t(2717),c=t(90954),m=t(49067),v=t(24511),p=t(17649),f=t(4942),h=t(15861),g=t(87757),Z=t.n(g),x=t(74294),y=t(68197),j=t(59624),b=t(77181),_=t(66672),w=t(86345),k=t(16124),I=t(46155),q=t(52421),S=t(97388),L=t(5764),N=t(98447),P=t(13622),O=t(61197),F=t(49986),E=t(74551),C=t(45005),H=t(56814),V=t(2772),M=[{label:"minutes",value:"minute",key:"minute"},{label:"hours",value:"hour",key:"hour"},{label:"days",value:"day",key:"day"}],R=t(46417),Y=x.Z.Option,D=function(e){var n=e.backImage,t=e.setBackImage,r=e.logoImage,o=e.setLogoImage,d=e.form,c=e.user,m=e.setLocation,p=e.location,g=(0,v.$)().t,D=(0,i.useState)(null),U=(0,a.Z)(D,2),B=U[0],A=U[1],T=(0,i.useState)(null),z=(0,a.Z)(T,2),J=z[0],$=z[1],K=(0,i.useState)(null),G=(0,a.Z)(K,2),Q=G[0],W=G[1],X=(0,u.v9)((function(e){return e.formLang}),u.wU),ee=X.defaultLang,ne=X.languages,te=(0,i.useState)(""),re=(0,a.Z)(te,2),ae=re[0],ie=re[1];function le(){return(le=(0,h.Z)(Z().mark((function e(n){var t;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,roles:"user","empty-shop":1},W(!1),e.abrupt("return",F.Z.search(t).then((function(e){return e.data.map((function(e){return{label:(null===e||void 0===e?void 0:e.firstname)+" "+((null===e||void 0===e?void 0:e.lastname)||""),value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(){return(oe=(0,h.Z)(Z().mark((function e(n){var t;return Z().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return W(!1),t={search:n},e.abrupt("return",O.Z.getAll(t).then((function(e){return e.data.map((function(e){var n;return{label:(null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title)||"no name",value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var se=function(){A(!0),W(!0)},de=function(){A(!1),$(!1)};return(0,R.jsxs)(y.Z,{gutter:12,children:[(0,R.jsx)(j.Z,{span:24,children:(0,R.jsx)(b.Z,{children:(0,R.jsxs)(y.Z,{gutter:12,children:[(0,R.jsx)(j.Z,{span:4,children:(0,R.jsx)(l.Z.Item,{label:g("logo.image"),name:"logo_img",rules:[{required:!(null!==r&&void 0!==r&&r.length),message:g("required")}],children:(0,R.jsx)(L.Z,{type:"shops/logo",imageList:r,setImageList:o,form:d,multiple:!1,name:"logo_img"})})}),(0,R.jsx)(j.Z,{span:4,children:(0,R.jsx)(l.Z.Item,{label:g("background.image"),name:"background_img",rules:[{required:!(null!==n&&void 0!==n&&n.length),message:g("required")}],children:(0,R.jsx)(L.Z,{type:"shops/background",imageList:n,setImageList:t,form:d,multiple:!1,name:"background_img"})})}),(0,R.jsx)(j.Z,{span:10,children:(0,R.jsx)(l.Z.Item,{label:g("status.note"),name:"status_note",children:(0,R.jsx)(q.Z,{rows:4,maxLength:100})})}),(0,R.jsx)(j.Z,{span:4,children:(0,R.jsx)(l.Z.Item,{name:"status",label:g("status"),children:(0,R.jsx)(_.Z,{disabled:!0})})}),(0,R.jsx)(j.Z,{span:2,children:(0,R.jsx)(l.Z.Item,{label:g("open"),name:"open",valuePropName:"checked",children:(0,R.jsx)(w.Z,{disabled:!0})})})]})})}),(0,R.jsx)(j.Z,{span:24,children:(0,R.jsx)(b.Z,{title:g("general"),children:(0,R.jsxs)(y.Z,{gutter:12,children:[(0,R.jsx)(j.Z,{span:12,children:(0,R.jsxs)(y.Z,{gutter:12,children:[(0,R.jsx)(j.Z,{span:24,children:ne.map((function(e,n){return(0,R.jsx)(l.Z.Item,{label:g("title"),name:"title[".concat(e.locale,"]"),rules:[{required:(null===e||void 0===e?void 0:e.locale)===ee,message:g("required")},{validator:function(n,t){var r;return t&&(null===t||void 0===t||null===(r=t.trim())||void 0===r?void 0:r.length)<2&&(null===e||void 0===e?void 0:e.locale)===ee?Promise.reject(new Error(g("must.be.at.least.2"))):Promise.resolve()}}],hidden:e.locale!==ee,children:(0,R.jsx)(_.Z,{maxLength:50})},"title"+n)}))}),(0,R.jsx)(j.Z,{span:24,children:(0,R.jsx)(l.Z.Item,{label:g("phone"),name:"phone",rules:[{required:!0,message:g("required")},{type:"number",max:1e20,message:g("max.length.20")}],children:(0,R.jsx)(k.Z,{min:0,className:"w-100"})})})]})}),(0,R.jsx)(j.Z,{span:12,children:ne.map((function(e,n){return(0,R.jsx)(l.Z.Item,{label:g("description"),name:"description[".concat(e.locale,"]"),rules:[{required:(null===e||void 0===e?void 0:e.locale)===ee,message:g("required")},{validator:function(n,t){var r;return t&&(null===t||void 0===t||null===(r=t.trim())||void 0===r?void 0:r.length)<5&&(null===e||void 0===e?void 0:e.locale)===ee?Promise.reject(new Error(g("must.be.at.least.5"))):Promise.resolve()}}],hidden:e.locale!==ee,children:(0,R.jsx)(q.Z,{rows:4,maxLength:150})},"desc"+n)}))}),(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(l.Z.Item,{label:g("shop.tags"),name:"tags",rules:[{required:!0,message:g("required")}],children:(0,R.jsx)(P.R,{mode:"multiple",fetchOptions:function(e){return oe.apply(this,arguments)},refetch:Q})})}),(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(l.Z.Item,{label:g("shop.type"),name:"delivery_type",rules:[{required:!0,message:g("required")}],children:(0,R.jsx)(x.Z,{options:V.I})})}),(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(l.Z.Item,{label:g("seller"),name:"user",rules:[{required:!0,message:g("required")}],children:(0,R.jsx)(P.R,{disabled:c,fetchOptions:function(e){return le.apply(this,arguments)},refetch:Q,dropdownRender:function(e){return(0,R.jsxs)(R.Fragment,{children:[e,(0,R.jsx)(I.Z,{style:{margin:"8px 0"}}),(0,R.jsx)(s.Z,{className:"w-100",icon:(0,R.jsx)(N.Z,{}),onClick:se,children:g("add.user")})]})}})})})]})})}),(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(b.Z,{title:g("delivery.time"),children:(0,R.jsxs)(y.Z,{gutter:12,children:[(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(l.Z.Item,{name:"delivery_time_type",label:g("delivery_time_type"),rules:[{required:!0,message:g("required")}],children:(0,R.jsx)(x.Z,{className:"w-100",children:M.map((function(e){return(0,R.jsx)(Y,{value:e.value,label:g(e.label)},e.key)}))})})}),(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(l.Z.Item,{name:"delivery_time_from",label:g("delivery_time_from"),rules:[{required:!0,message:g("required")},{type:"number",max:9999999999,message:g("max.length.10")}],children:(0,R.jsx)(k.Z,{min:0,className:"w-100"})})}),(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(l.Z.Item,{name:"delivery_time_to",label:g("delivery_time_to"),rules:[{required:!0,message:g("required")},{type:"number",max:9999999999,message:g("max.length.10")}],children:(0,R.jsx)(k.Z,{min:0,className:"w-100"})})})]})})}),(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(b.Z,{title:g("order.info"),children:(0,R.jsxs)(y.Z,{gutter:12,children:[(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(l.Z.Item,{label:g("tax"),name:"tax",rules:[{required:!0,message:g("required")}],children:(0,R.jsx)(k.Z,{min:0,max:100,addonAfter:"%",className:"w-100"})})}),(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(l.Z.Item,{label:g("admin.commission"),name:"percentage",rules:[{required:!0,message:g("required")}],children:(0,R.jsx)(k.Z,{min:0,max:100,className:"w-100",addonAfter:"%"})})})]})})}),(0,R.jsx)(j.Z,{span:24,children:(0,R.jsx)(b.Z,{title:g("address"),children:(0,R.jsxs)(y.Z,{gutter:12,children:[(0,R.jsx)(j.Z,{span:12,children:(0,R.jsx)(H.Z,{value:ae,setValue:ie,setLocation:m})}),(0,R.jsx)(j.Z,{span:24,children:(0,R.jsx)(S.Z,{location:p,setLocation:m,setAddress:function(e){return d.setFieldsValue((0,f.Z)({},"address[".concat(ee,"]"),e))}})})]})})}),B&&(0,R.jsx)(E.Z,{visible:B,handleCancel:function(){return de()}}),J&&(0,R.jsx)(C.Z,{visible:J,handleCancel:function(){return de()}})]})},U=function(e){var n,t,f,h,g,Z,x,y,j,b,_,w,k,I,q,S,L,N,P,O,F,E=e.next,C=e.action_type,H=void 0===C?"":C,Y=e.user,U=(0,v.$)().t,B=l.Z.useForm(),A=(0,a.Z)(B,1)[0],T=(0,d.s0)(),z=(0,u.I0)(),J=(0,d.UO)().uuid,$=(0,u.v9)((function(e){return e.menu}),u.wU).activeMenu,K=(0,u.v9)((function(e){return e.globalSettings}),u.wU).settings,G=(0,i.useState)(null!==$&&void 0!==$&&null!==(n=$.data)&&void 0!==n&&n.location?{lat:parseFloat(null===$||void 0===$||null===(t=$.data)||void 0===t||null===(f=t.location)||void 0===f?void 0:f.latitude),lng:parseFloat(null===$||void 0===$||null===(h=$.data)||void 0===h||null===(g=h.location)||void 0===g?void 0:g.longitude)}:(0,p.Z)(K)),Q=(0,a.Z)(G,2),W=Q[0],X=Q[1],ee=(0,i.useState)(!1),ne=(0,a.Z)(ee,2),te=ne[0],re=ne[1],ae=(0,i.useState)(null!==(Z=$.data)&&void 0!==Z&&Z.logo_img?[null===(x=$.data)||void 0===x?void 0:x.logo_img]:[]),ie=(0,a.Z)(ae,2),le=ie[0],oe=ie[1],se=(0,i.useState)(null!==(y=$.data)&&void 0!==y&&y.background_img?[null===(j=$.data)||void 0===j?void 0:j.background_img]:[]),de=(0,a.Z)(se,2),ue=de[0],ce=de[1];(0,i.useEffect)((function(){return function(){var e=A.getFieldsValue(!0);e.open_time=JSON.stringify(null===e||void 0===e?void 0:e.open_time),e.close_time=JSON.stringify(null===e||void 0===e?void 0:e.close_time),z((0,c.nc)({activeMenu:$,data:(0,r.Z)((0,r.Z)({},$.data),e)}))}}),[]);return(0,R.jsx)(R.Fragment,{children:(0,R.jsxs)(l.Z,{form:A,name:"basic",layout:"vertical",onFinish:function(e){var n,t,a,i;re(!0);var l=(0,r.Z)((0,r.Z)({},e),{},{delivery_type:(null===e||void 0===e||null===(n=e.delivery_type)||void 0===n?void 0:n.value)||(null===e||void 0===e?void 0:e.delivery_type),"images[0]":null===(t=le[0])||void 0===t?void 0:t.name,"images[1]":null===(a=ue[0])||void 0===a?void 0:a.name,delivery_time_type:e.delivery_time_type,delivery_time_to:e.delivery_time_to||0,delivery_time_from:e.delivery_time_from||0,tags:null===e||void 0===e||null===(i=e.tags)||void 0===i?void 0:i.map((function(e){return e.value})),user_id:e.user.value,open:void 0,"location[latitude]":W.lat,"location[longitude]":W.lng,user:void 0,delivery_time:0});null===l||void 0===l||delete l.background_img,null===l||void 0===l||delete l.logo_img,"edit"===H?function(e,n){m.Z.update(J,n).then((function(){z((0,c.nc)({activeMenu:$,data:e})),E()})).catch((function(e){return console.error(e.response.data.params)})).finally((function(){return re(!1)}))}(e,l):function(e,n){m.Z.create(n).then((function(n){var t=n.data;z((0,c.SS)({id:"shop-".concat(t.uuid),url:"shop/".concat(t.uuid),name:U("add.shop"),data:(0,r.Z)((0,r.Z)({},e),{},{id:null===t||void 0===t?void 0:t.id,seller:null===t||void 0===t?void 0:t.seller}),refetch:!1})),T("/shop/".concat(t.uuid,"?step=1"))})).catch((function(e){return console.error(e.response.data.params)})).finally((function(){return re(!1)}))}(e,l)},initialValues:(0,r.Z)((0,r.Z)({open:!1,status:"new",delivery_time_type:M[0]},$.data),{},{delivery_type:null!==(b=null===(_=$.data)||void 0===_?void 0:_.delivery_type)&&void 0!==b?b:V.I[0],delivery_time_from:null!==(w=$.data)&&void 0!==w&&null!==(k=w.delivery_time)&&void 0!==k&&k.from?Number(null===(I=$.data)||void 0===I||null===(q=I.delivery_time)||void 0===q?void 0:q.from):0,delivery_time_to:null!==(S=$.data)&&void 0!==S&&null!==(L=S.delivery_time)&&void 0!==L&&L.to?Number(null===(N=$.data)||void 0===N||null===(P=N.delivery_time)||void 0===P?void 0:P.to):0,phone:null!==(O=$.data)&&void 0!==O&&O.phone?Number(null===(F=$.data)||void 0===F?void 0:F.phone):0}),children:[(0,R.jsx)(D,{form:A,user:Y,backImage:ue,setBackImage:ce,logoImage:le,setLogoImage:oe,location:W,setLocation:X}),(0,R.jsx)(o.Z,{children:(0,R.jsx)(s.Z,{type:"primary",htmlType:"submit",loading:te,children:U("next")})})]})})}},20131:function(e,n,t){var r=t(29439),a=t(47313),i=t(51282),l=t(70816),o=t.n(l),s=t(78790),d=t(49682),u=t(97890),c=t(21429),m=t(22899),v=t(10976),p=t(46417);n.Z=function(e){var n=e.next,t=e.prev,l=v.Z.useForm(),f=(0,r.Z)(l,1)[0],h=(0,a.useState)([]),g=(0,r.Z)(h,2),Z=g[0],x=g[1],y=(0,a.useState)(new Array(7).fill(!1)),j=(0,r.Z)(y,2),b=j[0],_=j[1],w=(0,a.useState)(!1),k=(0,r.Z)(w,2),I=k[0],q=k[1],S=(0,a.useState)(!1),L=(0,r.Z)(S,2),N=L[0],P=L[1],O=(0,u.UO)().uuid;return(0,a.useEffect)((function(){f.setFieldsValue({working_days:c.P}),O&&(P(!0),d.Z.getById(O).then((function(e){x(e.data.closed_dates.filter((function(e){return e.day>o()(new Date).format("YYYY-MM-DD")})).map((function(e){return new Date(e.day)})))})),s.Z.getById(O).then((function(e){_(0!==e.data.dates.length?e.data.dates.map((function(e){return e.disabled})):[]),0!==e.data.dates.length&&f.setFieldsValue({working_days:e.data.dates.map((function(e){return{title:e.day,from:o()(e.from,"HH:mm:ss"),to:o()(e.to,"HH:mm:ss"),disabled:Boolean(e.disabled)}}))})})).finally((function(){return P(!1)})))}),[]),(0,p.jsx)(p.Fragment,{children:N?(0,p.jsx)(i.Z,{}):(0,p.jsx)(m.Z,{onFinish:function(e){q(!0);var t={dates:Z?Z.map((function(e){return o()(e).format("YYYY-MM-DD")})):void 0},r={dates:e.working_days.map((function(e){return{day:e.title,from:o()(e.from?e.from:"00").format("HH:mm"),to:o()(e.to?e.to:"00").format("HH:mm"),disabled:e.disabled}}))};d.Z.update(O,t).then((function(){n()})).finally((function(){return q(!1)})),0!==e.working_days.length&&s.Z.update(O,r).then((function(){n()})).finally((function(){return q(!1)}))},prev:t,form:f,lines:b,loadingBtn:I,days:Z,setDays:x,setLines:_,weeks:c.P})})}},25050:function(e,n,t){var r=t(87462),a=t(47313),i=t(99096),l=function(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]])}return t},o=i.Z.TimePicker,s=i.Z.RangePicker,d=a.forwardRef((function(e,n){return a.createElement(s,(0,r.Z)({},e,{dropdownClassName:e.popupClassName,picker:"time",mode:void 0,ref:n}))})),u=a.forwardRef((function(e,n){var t=e.addon,i=e.renderExtraFooter,s=e.popupClassName,d=l(e,["addon","renderExtraFooter","popupClassName"]),u=a.useMemo((function(){return i||(t||void 0)}),[t,i]);return a.createElement(o,(0,r.Z)({},d,{dropdownClassName:s,mode:void 0,ref:n,renderExtraFooter:u}))}));u.displayName="TimePicker",u.RangePicker=d,n.Z=u}}]);