"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[5918],{89802:function(e,n,t){t.d(n,{q:function(){return c}});var a=t(1413),u=t(29439),s=t(45987),i=t(47313),l=t(74294),r=t(72652),o=t(46417),d=["fetchOptions","refetch","value"],c=function(e){var n=e.fetchOptions,t=e.refetch,c=void 0!==t&&t,m=e.value,f=(0,s.Z)(e,d),v=(0,i.useState)(!1),p=(0,u.Z)(v,2),x=p[0],h=p[1],b=(0,i.useState)([]),Z=(0,u.Z)(b,2),j=Z[0],_=Z[1];"object"===typeof(null===m||void 0===m?void 0:m.label)&&null!==(null===m||void 0===m?void 0:m.label)&&(m.label=m.label.value);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(l.Z,(0,a.Z)((0,a.Z)({labelInValue:!0,filterOption:!1,notFoundContent:x?(0,o.jsx)(r.Z,{size:"small"}):"no results",value:m},f),{},{options:x?[]:j,onFocus:function(){j.length&&!c||(h(!0),n().then((function(e){_(e),h(!1)})))}}))})}},95918:function(e,n,t){t.r(n);var a=t(1413),u=t(29439),s=t(47313),i=t(97890),l=t(23560),r=t(10976),o=t(77181),d=t(68197),c=t(59624),m=t(16124),f=t(99096),v=t(86345),p=t(59491),x=t(2717),h=t(90954),b=t(18333),Z=t(24511),j=t(70816),_=t.n(j),y=t(13783),g=t(73346),k=t(89802),q=t(51282),S=t(46417);n.default=function(){var e=(0,Z.$)().t,n=(0,x.v9)((function(e){return e.menu}),x.wU).activeMenu,t=(0,x.I0)(),j=r.Z.useForm(),N=(0,u.Z)(j,1)[0],w=(0,i.s0)(),I=(0,s.useState)(!1),Y=(0,u.Z)(I,2),F=Y[0],O=Y[1],M=(0,s.useState)(!1),D=(0,u.Z)(M,2),U=D[0],V=D[1],z=(0,x.v9)((function(e){return e.myShop}),x.wU).myShop,C=(0,i.UO)().id;(0,s.useEffect)((function(){return function(){var e=N.getFieldsValue(!0);e.expired_at=JSON.stringify(null===e||void 0===e?void 0:e.expired_at),t((0,h.nc)({activeMenu:n,data:e}))}}),[]);var A=function(e){V(!0),g.Z.getById(e).then((function(e){!function(e){var n,t,u,s,i;N.setFieldsValue((0,a.Z)((0,a.Z)({},e),{},{expired_at:_()(e.expired_at,"YYYY-MM-DD"),bonus_stock_id:{label:(null===e||void 0===e||null===(n=e.bonusStock)||void 0===n||null===(t=n.product)||void 0===t||null===(u=t.translation)||void 0===u?void 0:u.title)+" "+(null===(s=e.bonusStock)||void 0===s?void 0:s.extras.map((function(e){return e.value})).join(", ")),value:null===e||void 0===e||null===(i=e.bonusStock)||void 0===i?void 0:i.id}})),V(!1)}(e.data)})).finally((function(){return t((0,h.A_)(n))}))};(0,s.useEffect)((function(){n.refetch&&A(C)}),[n.refetch]);return(0,S.jsx)(o.Z,{title:e("edit.bonus"),className:"h-100",children:U?(0,S.jsx)(q.Z,{}):(0,S.jsxs)(r.Z,{name:"bonus-add",layout:"vertical",onFinish:function(u){var s={expired_at:_()(u.expired_at).format("YYYY-MM-DD"),status:u.status,type:"sum",value:u.value,bonus_stock_id:u.bonus_stock_id.value,bonus_quantity:u.bonus_quantity,bonusable_id:z.id};O(!0);var i="seller/bonus/shop";g.Z.update(C,s).then((function(){l.Am.success(e("successfully.created")),t((0,h.ph)((0,a.Z)((0,a.Z)({},n),{},{nextUrl:i}))),w("/".concat(i)),t((0,y.Q)())})).finally((function(){return O(!1)}))},form:N,initialValues:(0,a.Z)((0,a.Z)({status:!0},n.data),function(){var e,t;if(null===(e=n.data)||void 0===e||!e.expired_at)return{};var a=JSON.parse(null===(t=n.data)||void 0===t?void 0:t.expired_at);return{expired_at:_()(a,"HH:mm:ss")}}()),className:"d-flex flex-column h-100",children:[(0,S.jsxs)(d.Z,{gutter:12,children:[(0,S.jsx)(c.Z,{span:12,children:(0,S.jsx)(r.Z.Item,{label:e("order.amount"),name:"value",rules:[{required:!0,message:e("required")},{type:"number",min:1,message:e("min.1")}],children:(0,S.jsx)(m.Z,{className:"w-100"})})}),(0,S.jsx)(c.Z,{span:12,children:(0,S.jsx)(r.Z.Item,{label:e("bonus.product.stock"),name:"bonus_stock_id",rules:[{required:!0,message:e("required")}],children:(0,S.jsx)(k.q,{fetchOptions:function(){return b.Z.getStock({active:1,status:"published"}).then((function(e){return e.data.map((function(e){return{label:e.product.translation.title+"".concat(e.extras.length>0?": ".concat(e.extras.map((function(e){return e.value})).join(", ")):""),value:e.id}}))}))},debounceTimeout:200})})}),(0,S.jsx)(c.Z,{span:12,children:(0,S.jsx)(r.Z.Item,{label:e("bonus.product.quantity"),name:"bonus_quantity",rules:[{required:!0,message:e("required")},{type:"number",min:1,message:e("min.1")}],children:(0,S.jsx)(m.Z,{className:"w-100"})})}),(0,S.jsx)(c.Z,{span:12,children:(0,S.jsx)(r.Z.Item,{name:"expired_at",label:e("expired.at"),rules:[{required:!0,message:e("required")}],children:(0,S.jsx)(f.Z,{className:"w-100",placeholder:"",disabledDate:function(e){return _()().add(-1,"days")>=e}})})}),(0,S.jsx)(c.Z,{span:12,children:(0,S.jsx)(r.Z.Item,{label:e("active"),name:"status",valuePropName:"checked",children:(0,S.jsx)(v.Z,{})})})]}),(0,S.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,S.jsx)("div",{className:"pb-5",children:(0,S.jsx)(p.Z,{type:"primary",htmlType:"submit",loading:F,children:e("submit")})})})]})})}}}]);