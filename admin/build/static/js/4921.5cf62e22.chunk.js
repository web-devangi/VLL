"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[4921],{17649:function(n,e,i){i.d(e,{Z:function(){return t}});i(97421);function t(n){if(null===n||void 0===n||!n.location)return{lat:47.4143302506288,lng:8.532059477976883};var e=n.location.split(", ");return{lat:Number(null===e||void 0===e?void 0:e[0]),lng:Number(null===e||void 0===e?void 0:e[1])}}},84017:function(n,e,i){function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after",t=Number(n).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===i?"".concat(t," ").concat(e):"".concat(e," ").concat(t)}i.d(e,{Z:function(){return t}})},24921:function(n,e,i){i.r(e),i.d(e,{default:function(){return M}});var t=i(1413),l=i(29439),d=i(47313),o=i(45705),r=i(66204),a=i(26824),s=i(78508),u=i(77181),c=i(59491),v=i(72652),x=i(68197),h=i(59624),p=i(97890),m=i(90046),j=i(45464),f=i(2717),Z=i(90954),y=i(10976),g=i(9274),b=i(74294),k=i(24511),w=i(46417),_=["new","accepted","ready","on_a_way","delivered"];function N(n){var e=n.orderDetails,i=n.handleCancel,o=(0,f.v9)((function(n){return n.menu}),f.wU).activeMenu,r=y.Z.useForm(),a=(0,l.Z)(r,1)[0],s=(0,f.I0)(),u=(0,k.$)().t,v=(0,d.useState)(!1),p=(0,l.Z)(v,2),j=p[0],N=p[1],I=(0,d.useState)(_),S=(0,l.Z)(I,2),C=S[0],U=S[1];(0,d.useEffect)((function(){var n=_.findIndex((function(n){return n===e.status})),i=[_[n],_[n+1],"canceled"];n<0&&(i=[_[n+1],"canceled"]),U(i)}),[e]);return(0,w.jsx)(g.Z,{visible:!!e,title:e.title,onCancel:i,footer:[(0,w.jsx)(c.Z,{type:"primary",onClick:function(){return a.submit()},loading:j,children:u("save")}),(0,w.jsx)(c.Z,{type:"default",onClick:i,children:u("cancel")})],children:(0,w.jsx)(y.Z,{form:a,layout:"vertical",onFinish:function(n){N(!0);var l=(0,t.Z)({},n);m.Z.updateStatus(e.id,l).then((function(){i(),s((0,Z.xo)(o))})).finally((function(){return N(!1)}))},initialValues:{status:e.status},children:(0,w.jsx)(x.Z,{gutter:12,children:(0,w.jsx)(h.Z,{span:24,children:(0,w.jsx)(y.Z.Item,{label:u("status"),name:"status",rules:[{required:!0,message:u("required")}],children:(0,w.jsx)(b.Z,{children:C.map((function(n,e){return(0,w.jsx)(b.Z.Option,{value:n,children:u(n)},n+e)}))})})})})})})}var I=i(75052),S=i(84017),C=i(36967),U=i(58821),q=i(32916),D=i(70816),F=i.n(D);function M(){var n,e,i,y,g,b=(0,f.v9)((function(n){return n.menu}),f.wU).activeMenu,_=(0,f.v9)((function(n){return n.currency}),f.wU).defaultCurrency,D=(0,f.v9)((function(n){return n.orderStatus}),f.wU).statusList,M=null===b||void 0===b||null===(n=b.data)||void 0===n?void 0:n.data,R=(0,k.$)().t,$=(0,p.UO)().id,A=(0,f.I0)(),B=(0,d.useRef)(),L=(0,d.useRef)(),E=(0,d.useState)(null),P=(0,l.Z)(E,2),Y=(P[0],P[1],(0,d.useState)(!1)),z=(0,l.Z)(Y,2),H=z[0],K=z[1],O=(0,d.useState)(null),V=(0,l.Z)(O,2),G=V[0],Q=V[1],T=(0,d.useState)(null),W=(0,l.Z)(T,2),J=W[0],X=W[1],nn=(0,d.useState)(null),en=(0,l.Z)(nn,2),tn=en[0],ln=en[1],dn=[{title:R("id"),dataIndex:"id",key:"id",render:function(n,e){var i;return null===e||void 0===e||null===(i=e.shop)||void 0===i?void 0:i.id}},{title:R("shop.name"),dataIndex:"shop.name",key:"shop.name",render:function(n,e){var i;return(0,w.jsx)(o.Z,{direction:"vertical",className:"relative",children:null===e||void 0===e||null===(i=e.shop.translation)||void 0===i?void 0:i.title})}},{title:R("image"),dataIndex:"shop.img",key:"shop.img",render:function(n,e){var i;return(0,w.jsx)(a.Z,{src:(0,j.Z)(null===e||void 0===e||null===(i=e.shop)||void 0===i?void 0:i.logo_img),alt:"product",width:100,height:"auto",className:"rounded",preview:!0,placeholder:!0})}},{title:R("Phone"),dataIndex:"origin_price",key:"shop.phone",render:function(n,e){var i,t;return(0,w.jsx)("a",{href:"tel:".concat(null===e||void 0===e||null===(i=e.shop)||void 0===i?void 0:i.phone),children:null===e||void 0===e||null===(t=e.shop)||void 0===t?void 0:t.phone})}},{title:R("tax"),dataIndex:"tax",key:"tax",render:function(n,e){var i;return null===e||void 0===e||null===(i=e.shop)||void 0===i?void 0:i.tax}},{title:R("total.price"),dataIndex:"total_price",key:"total_price",render:function(n){return(0,S.Z)(n,null===_||void 0===_?void 0:_.symbol)}}],on=function(){Q(null),X(null),ln(null)};return(0,d.useEffect)((function(){b.refetch&&(K(!0),m.Z.getById($).then((function(n){var e=n.data,i=e.currency,l=e.user,d=e.id,o=e.price,r=e.created_at,a=e.details.map((function(n){var e,i;return(0,t.Z)((0,t.Z)({},n),{},{title:null===(e=n.shop)||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title})}));A((0,Z.nc)({activeMenu:b,data:{details:a,currency:i,user:l,id:d,createdAt:r,price:o,data:e}}))})).finally((function(){K(!1),A((0,Z.A_)(b))})))}),[b.refetch]),(0,w.jsxs)("div",{className:"order_details",children:[(0,w.jsx)(u.Z,{className:"order-details-info",title:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(q.Qyq,{className:"mr-2 icon"}),"".concat(R("order")," ").concat(null!==M&&void 0!==M&&M.id?"#".concat(null===M||void 0===M?void 0:M.id," "):"")," ",R("from.order")," ",null===M||void 0===M||null===(e=M.table)||void 0===e?void 0:e.name]}),extra:"delivered"!==(null===M||void 0===M?void 0:M.status)&&"canceled"!==(null===M||void 0===M?void 0:M.status)&&"accepted"!==(null===M||void 0===M?void 0:M.status)&&"cooking"!==(null===M||void 0===M?void 0:M.status)?(0,w.jsx)(c.Z,{type:"primary",onClick:function(){return Q(M)},children:R("change.status")}):null}),(0,w.jsx)(v.Z,{spinning:H,children:(0,w.jsx)(u.Z,{style:{minHeight:"200px"},children:(0,w.jsxs)(x.Z,{hidden:H,className:"mb-3 order_detail",children:[(0,w.jsx)(h.Z,{span:12,children:(0,w.jsxs)("div",{children:[R("created.date.&.time"),":",(0,w.jsxs)("span",{className:"ml-2",children:[(0,w.jsx)(U.yoA,{className:"mr-1"})," ",F()(null===M||void 0===M?void 0:M.created_at).format("YYYY-MM-DD HH:mm")," "]})]})}),(0,w.jsx)(h.Z,{span:12,children:(0,w.jsxs)("div",{children:[R("status"),":",(0,w.jsx)("span",{className:"ml-2",children:"new"===(null===M||void 0===M?void 0:M.status)?(0,w.jsx)(r.Z,{color:"blue",children:R(null===M||void 0===M?void 0:M.status)}):"canceled"===(null===M||void 0===M?void 0:M.status)?(0,w.jsx)(r.Z,{color:"error",children:R(null===M||void 0===M?void 0:M.status)}):(0,w.jsx)(r.Z,{color:"cyan",children:R(null===M||void 0===M?void 0:M.status)})})]})})," ",(0,w.jsx)(h.Z,{span:12,children:(0,w.jsxs)("div",{children:[R("table"),":",(0,w.jsx)("span",{className:"ml-2",children:(null===M||void 0===M||null===(i=M.table)||void 0===i?void 0:i.name)||R("unspecified")})]})}),(0,w.jsx)(h.Z,{span:12,children:(0,w.jsxs)("div",{children:[R("delivery_type"),":",(0,w.jsx)("span",{className:"ml-2",children:(null===M||void 0===M?void 0:M.delivery_type)||R("unspecified")})]})})]})})}),(0,w.jsxs)(u.Z,{className:"w-100 order-table",children:[(0,w.jsx)(s.Z,{ref:L,scroll:{x:!0},columns:dn,dataSource:(null===(y=b.data)||void 0===y?void 0:y.details)||[],loading:H,rowKey:function(n){return n.id},pagination:!1,expandable:{expandedRowRender:function(n){var e=[{title:R("id"),dataIndex:"id",key:"id",render:function(n,e){var i;return null===(i=e.stock)||void 0===i?void 0:i.id}},{title:R("product.name"),dataIndex:"product",key:"product",render:function(n,e){var i,t,l,d,a;return(0,w.jsxs)(o.Z,{direction:"vertical",className:"relative",children:[null===(i=e.stock)||void 0===i||null===(t=i.product)||void 0===t||null===(l=t.translation)||void 0===l?void 0:l.title,null===(d=e.stock)||void 0===d||null===(a=d.extras)||void 0===a?void 0:a.map((function(n){var e,i,t;return(0,w.jsxs)(r.Z,{children:[null===(e=n.group)||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title,": ",null===(t=n.value)||void 0===t?void 0:t.value]},null===n||void 0===n?void 0:n.id)}))]})}},{title:R("image"),dataIndex:"img",key:"img",render:function(n,e){var i,t;return(0,w.jsx)(a.Z,{src:(0,j.Z)(null===(i=e.stock)||void 0===i||null===(t=i.product)||void 0===t?void 0:t.img),alt:"product",width:100,height:"auto",className:"rounded",preview:!0,placeholder:!0})}},{title:R("price"),dataIndex:"origin_price",key:"origin_price",render:function(n){return(0,S.Z)(n,null===_||void 0===_?void 0:_.symbol)}},{title:R("quantity"),dataIndex:"quantity",key:"quantity",render:function(n){return(0,w.jsx)("span",{children:n})}},{title:R("discount"),dataIndex:"discount",key:"discount",render:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return(0,S.Z)(n,null===_||void 0===_?void 0:_.symbol)}},{title:R("tax"),dataIndex:"tax",key:"tax",render:function(n){return(0,S.Z)(n,null===_||void 0===_?void 0:_.symbol)}},{title:R("total.price"),dataIndex:"total_price",key:"total_price",render:function(n,e){return(0,S.Z)(n,null===_||void 0===_?void 0:_.symbol)}}],i=(null===n||void 0===n?void 0:n.products)||[];return(0,w.jsx)(s.Z,{columns:e,dataSource:i,pagination:!1})},defaultExpandedRowKeys:["0"]}}),(0,w.jsxs)(o.Z,{size:100,className:"d-flex justify-content-end w-100 order-table__summary",children:[(0,w.jsxs)("div",{children:[(0,w.jsxs)("span",{children:[R("delivery.fee"),":"]}),(0,w.jsx)("br",{}),(0,w.jsxs)("span",{children:[R("order.tax"),":"]}),(0,w.jsx)("br",{}),(0,w.jsxs)("span",{children:[R("product"),":"]}),(0,w.jsx)("br",{}),(0,w.jsxs)("span",{children:[R("discount"),":"]}),(0,w.jsx)("br",{}),(0,w.jsxs)("h3",{children:[R("total.price"),":"]})]}),(0,w.jsxs)("div",{children:[(0,w.jsx)("span",{children:(0,S.Z)(null!==(g=null===M||void 0===M?void 0:M.delivery_price)&&void 0!==g?g:0,null===_||void 0===_?void 0:_.symbol)}),(0,w.jsx)("br",{}),(0,w.jsx)("span",{children:(0,S.Z)(null===M||void 0===M?void 0:M.total_tax,null===_||void 0===_?void 0:_.symbol)}),(0,w.jsx)("br",{}),(0,w.jsx)("span",{children:(0,S.Z)(null===M||void 0===M?void 0:M.origin_price,null===_||void 0===_?void 0:_.symbol)}),(0,w.jsx)("br",{}),(0,w.jsx)("span",{children:(0,S.Z)(null===M||void 0===M?void 0:M.total_discount,null===_||void 0===_?void 0:_.symbol)}),(0,w.jsx)("br",{}),(0,w.jsx)("h3",{ref:B,children:(0,S.Z)(null===M||void 0===M?void 0:M.total_price,null===_||void 0===_?void 0:_.symbol)})]})]})]}),G&&(0,w.jsx)(N,{orderDetails:G,handleCancel:on,status:D}),J&&(0,w.jsx)(I.Z,{orderDetails:J,handleCancel:on}),tn&&(0,w.jsx)(C.Z,{id:tn,handleCancel:on})]})}},75052:function(n,e,i){i.d(e,{Z:function(){return j}});var t=i(1413),l=i(29439),d=i(47313),o=i(10976),r=i(9274),a=i(59491),s=i(68197),u=i(59624),c=i(74294),v=i(2717),x=i(90046),h=i(90954),p=i(24511),m=i(46417);function j(n){var e,i=n.orderDetails,j=n.handleCancel,f=(0,p.$)().t,Z=(0,v.v9)((function(n){return n.menu}),v.wU).activeMenu,y=(0,v.v9)((function(n){return n.deliveryman}),v.wU).deliverymans,g=o.Z.useForm(),b=(0,l.Z)(g,1)[0],k=(0,v.I0)(),w=(0,d.useState)(!1),_=(0,l.Z)(w,2),N=_[0],I=_[1];return(0,m.jsx)(r.Z,{visible:!!i,title:i.title,onCancel:j,footer:[(0,m.jsx)(a.Z,{type:"primary",onClick:function(){return b.submit()},loading:N,children:f("save")}),(0,m.jsx)(a.Z,{type:"default",onClick:j,children:f("cancel")})],children:(0,m.jsx)(o.Z,{form:b,layout:"vertical",onFinish:function(n){var e=(0,t.Z)({},n);I(!0),x.Z.updateDelivery(i.id,e).then((function(){j(),k((0,h.xo)(Z))})).finally((function(){return I(!1)}))},initialValues:{deliveryman:null===(e=i.deliveryman)||void 0===e?void 0:e.id},children:(0,m.jsx)(s.Z,{gutter:12,children:(0,m.jsx)(u.Z,{span:24,children:(0,m.jsx)(o.Z.Item,{label:f("deliveryman"),name:"deliveryman",rules:[{required:!0,message:f("required")}],children:(0,m.jsx)(c.Z,{children:y.map((function(n,e){return(0,m.jsxs)(c.Z.Option,{value:n.id,className:"d-block",children:[n.firstname," ",n.lastname||""]},n.id)}))})})})})})})}},36967:function(n,e,i){var t=i(29439),l=i(84697),d=i(83999),o=i(9274),r=i(59491),a=i(77181),s=i(68197),u=i(59624),c=i(66204),v=i(47313),x=i(24511),h=i(90046),p=i(51282),m=i(58821),j=i(2717),f=i(97421),Z=i(18478),y=i(84618),g=i(17649),b=i(66461),k=i(22539),w=i(3394),_=i(57864),N=i(46417),I=d.Z.Step,S=function(){return(0,N.jsx)("img",{src:Z,width:"50",alt:"Pin"})},C=function(){return(0,N.jsx)("img",{src:y,width:"50",alt:"Pin"})},U=["blue","red","gold","volcano","cyan","lime"];e.Z=function(n){var e,i,Z,y,q,D,F=n.id,M=n.handleCancel,R=(0,x.$)().t,$=(0,v.useState)(null),A=(0,t.Z)($,2),B=A[0],L=A[1],E=(0,v.useState)(null),P=(0,t.Z)(E,2),Y=P[0],z=P[1],H=(0,v.useState)(null),K=(0,t.Z)(H,2),O=K[0],V=K[1],G=(0,j.v9)((function(n){return n.globalSettings}),j.wU).settings,Q=(0,g.Z)(G),T=(0,v.useState)(0),W=(0,t.Z)(T,2),J=W[0],X=W[1],nn=(0,v.useState)((0,g.Z)(G)),en=(0,t.Z)(nn,2),tn=en[0],ln=en[1],dn=(0,v.useState)((0,g.Z)(G)),on=(0,t.Z)(dn,2),rn=on[0],an=on[1],sn=(0,v.useState)([{id:0,name:"new",icon:(0,N.jsx)(b.Z,{})},{id:1,name:"accepted",icon:(0,N.jsx)(m.IQF,{})},{id:2,name:"ready",icon:(0,N.jsx)(k.TkG,{})},{id:3,name:"on_a_way",icon:(0,N.jsx)(w.Akc,{})},{id:4,name:"delivered",icon:(0,N.jsx)(w.kme,{})}]),un=(0,t.Z)(sn,2),cn=un[0],vn=un[1];var xn=(0,j.v9)((function(n){return n.globalSettings.settings}),j.wU).google_map_key;(0,v.useEffect)((function(){L(!0),h.Z.getById(F).then((function(n){var e,i=n.data;vn("canceled"===i.status?[{id:1,name:"new",icon:(0,N.jsx)(b.Z,{})},{id:5,name:"canceled",icon:(0,N.jsx)(_.SV5,{})}]:cn),X("canceled"===i.status?1:null===(e=cn.find((function(n){return n.name===i.status})))||void 0===e?void 0:e.id),V("canceled"===i.status?"error":"success"),z(i),an({lat:i.location.latitude,lng:i.location.longitude}),ln({lat:i.shop.location.latitude,lng:i.shop.location.longitude})})).finally((function(){L(!1)}))}),[]);return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(o.Z,{visible:!!F,title:R("show.locations"),closable:!0,onCancel:M,style:{minWidth:"80vw"},footer:[(0,N.jsx)(r.Z,{type:"default",onClick:M,children:R("cancel")},"cancelBtn")],children:B?(0,N.jsx)(p.Z,{}):(0,N.jsxs)(a.Z,{children:[(0,N.jsx)(d.Z,{current:J,status:O,className:"mb-5",children:null===cn||void 0===cn?void 0:cn.map((function(n,e){return(0,N.jsx)(I,{title:R(n.name),icon:null===n||void 0===n?void 0:n.icon},n.id+e)}))}),(0,N.jsxs)(s.Z,{gutter:12,children:[(0,N.jsxs)(u.Z,{span:12,children:[(0,N.jsxs)("h3",{children:[R("order.id")," #",null===Y||void 0===Y?void 0:Y.id]}),(0,N.jsxs)("p",{children:[(0,N.jsx)(m.D73,{})," ",null===Y||void 0===Y?void 0:Y.created_at]}),(0,N.jsxs)("p",{children:[R("schedulet.at")," ",null===Y||void 0===Y?void 0:Y.delivery_date]}),(0,N.jsxs)("span",{children:[(0,N.jsx)("strong",{children:null===Y||void 0===Y||null===(e=Y.shop)||void 0===e||null===(i=e.translation)||void 0===i?void 0:i.title})," ",null===Y||void 0===Y||null===(Z=Y.details)||void 0===Z?void 0:Z.map((function(n,e){var i;return(0,N.jsx)(c.Z,{className:"mb-2",color:U[e],children:null===n||void 0===n||null===(i=n.stock)||void 0===i?void 0:i.product.translation.title})}))]})]}),(0,N.jsxs)(u.Z,{span:12,children:[(0,N.jsxs)("p",{children:[R("status")," ","new"===(null===Y||void 0===Y?void 0:Y.status)?(0,N.jsx)(c.Z,{color:"blue",children:R(null===Y||void 0===Y?void 0:Y.status)}):"canceled"===(null===Y||void 0===Y?void 0:Y.status)?(0,N.jsx)(c.Z,{color:"error",children:R(null===Y||void 0===Y?void 0:Y.status)}):(0,N.jsx)(c.Z,{color:"cyan",children:R(null===Y||void 0===Y?void 0:Y.status)})]}),(0,N.jsxs)("p",{children:[R("payment.method")," ",(0,N.jsx)("strong",{children:null===Y||void 0===Y||null===(y=Y.transaction)||void 0===y||null===(q=y.payment_system)||void 0===q?void 0:q.tag})]}),(0,N.jsxs)("p",{children:[R("order.type")," ",(0,N.jsx)("strong",{children:null===Y||void 0===Y?void 0:Y.delivery_type})]}),(0,N.jsxs)("p",{children:[R("payment.type")," ",(0,N.jsx)("strong",{children:null===Y||void 0===Y||null===(D=Y.transaction)||void 0===D?void 0:D.status})]})]}),(0,N.jsxs)(u.Z,{span:24,className:"mt-5",children:[(0,N.jsx)("h4",{children:R("map")}),(0,N.jsx)("div",{className:"map-container",style:{height:400,width:"100%"},children:(0,N.jsxs)(l.ZP,{bootstrapURLKeys:{key:xn||f.kr},defaultZoom:14,center:Q,options:{fullscreenControl:!1},onGoogleApiLoaded:function(n){for(var e=n.map,i=n.maps,t=[tn,rn].map((function(n){return{lat:Number(n.lat||"0"),lng:Number(n.lng||"0")}})),l=new i.LatLngBounds,d=0;d<t.length;d++)l.extend(t[d]);e.fitBounds(l)},children:[(0,N.jsx)(C,{lat:null===tn||void 0===tn?void 0:tn.lat,lng:null===tn||void 0===tn?void 0:tn.lng}),(0,N.jsx)(S,{lat:null===rn||void 0===rn?void 0:rn.lat,lng:null===rn||void 0===rn?void 0:rn.lng})]})})]})]})]})})})}},84618:function(n,e,i){n.exports=i.p+"static/media/shop.46d7a94ca800c711764a.png"},18478:function(n,e,i){n.exports=i.p+"static/media/user.fbe7078c52acde79652d.jpg"}}]);