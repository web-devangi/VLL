"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[8985],{88985:(e,l,i)=>{i.r(l),i.d(l,{default:()=>q});var t=i(47313),n=i(68197),r=i(59624),s=i(77181),a=i(45705),d=i(66204),o=i(26824),c=i(9274),u=i(97890),v=i(2717),m=i(90954),h=i(30763),p=i(97421),j=i(24511),x=i(59308),g=i(10976),Z=i(74294),y=i(66672),f=i(86345),w=i(59491),b=i(23560),k=i(52421),I=i(5764),P=i(46417);const _=e=>{var l,i;let{parent:s={},setId:a,setIsRefetch:d}=e;const{t:o}=(0,j.$)(),{activeMenu:c}=(0,v.v9)((e=>e.menu),v.wU),[u,m]=(0,t.useState)(null!==(l=c.data)&&void 0!==l&&l.image?[null===(i=c.data)||void 0===i?void 0:i.image]:[]),[p]=g.Z.useForm(),[x,_]=(0,t.useState)(!1),[q,E]=(0,t.useState)(null),{defaultLang:S,languages:L}=(0,v.v9)((e=>e.formLang),v.wU);(0,t.useEffect)((()=>()=>{p.resetFields()}),[]);return null!==s&&void 0!==s&&s.id?(0,P.jsxs)(g.Z,{name:"basic",layout:"vertical",onFinish:e=>{var l,i;_(!0);const t={...e,type:"main"===(null===s||void 0===s?void 0:s.type)?"sub_main":"child",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(l=e.parent_id)||void 0===l?void 0:l.value,"images[0]":null===(i=u[0])||void 0===i?void 0:i.name};h.Z.create(t).then((()=>{b.Am.success(o("successfully.created")),a(null),p.resetFields(),d(!0)})).catch((e=>E(e.response.data.params))).finally((()=>_(!1)))},initialValues:{active:!0,...s},form:p,children:[(0,P.jsxs)(n.Z,{gutter:24,children:[(0,P.jsx)(r.Z,{span:24,children:(0,P.jsx)(g.Z.Item,{label:o("parent.category"),name:"parent_id",rules:[{required:!1,message:o("required")}],children:(0,P.jsx)(Z.Z,{disabled:!0})})}),(0,P.jsx)(r.Z,{span:24,children:L.map(((e,l)=>(0,P.jsx)(g.Z.Item,{label:o("name"),name:"title[".concat(e.locale,"]"),help:q&&q["title.".concat(S)]?q["title.".concat(S)][0]:null,validateStatus:q?"error":"success",rules:[{required:!0,validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==S?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(o("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(o("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(o("required")))}],hidden:e.locale!==S,children:(0,P.jsx)(y.Z,{placeholder:o("name")})},e.title+l)))}),(0,P.jsx)(r.Z,{span:24,children:L.map(((e,l)=>(0,P.jsx)(g.Z.Item,{label:o("description"),name:"description[".concat(e.locale,"]"),rules:[{required:!0,validator:(l,i)=>i||(null===e||void 0===e?void 0:e.locale)!==S?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(o("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(o("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(o("required")))}],hidden:e.locale!==S,children:(0,P.jsx)(k.Z,{rows:4})},e.locale+l)))}),(0,P.jsx)(r.Z,{span:24,children:(0,P.jsx)(g.Z.Item,{label:o("keywords"),name:"keywords",rules:[{required:!0,message:o("required")}],children:(0,P.jsx)(Z.Z,{mode:"tags",style:{width:"100%"}})})}),(0,P.jsx)(r.Z,{span:12,children:(0,P.jsx)(g.Z.Item,{label:o("image"),name:"images",rules:[{validator:()=>0===(null===u||void 0===u?void 0:u.length)?Promise.reject(new Error(o("required"))):Promise.resolve()}],children:(0,P.jsx)(I.Z,{type:"categories",imageList:u,setImageList:m,form:p,multiple:!1})})}),(0,P.jsx)(r.Z,{span:12,children:(0,P.jsx)(g.Z.Item,{label:o("active"),name:"active",valuePropName:"checked",children:(0,P.jsx)(f.Z,{})})})]}),(0,P.jsx)(w.Z,{type:"primary",htmlType:"submit",loading:x,className:"w-100",children:o("submit")})]}):""},q=()=>{var e,l,i,g,Z;const{t:y}=(0,j.$)(),{uuid:f}=(0,u.UO)(),w=(0,v.I0)(),[b,k]=(0,t.useState)(null),[I,q]=(0,t.useState)({}),[E,S]=(0,t.useState)(null),[L,F]=(0,t.useState)(null),{activeMenu:U}=(0,v.v9)((e=>e.menu),v.wU),[A,C]=(0,t.useState)(!1),{languages:z,defaultLang:N}=(0,v.v9)((e=>e.formLang),v.wU);function O(e){if(!e)return{};const{translations:l}=e,i=z.map((e=>{var i,t;return{["title[".concat(e.locale,"]")]:null===(i=l.find((l=>l.locale===e.locale)))||void 0===i?void 0:i.title,["description[".concat(e.locale,"]")]:null===(t=l.find((l=>l.locale===e.locale)))||void 0===t?void 0:t.description}}));return Object.assign({},...i)}return(0,t.useEffect)((()=>{var e;f&&(e=f,C(!0),h.Z.getById(e).then((e=>{var l,i,t;let n=e.data;const r={...n,...O(n),image:[(s=n.img,{name:s,url:p.bV+s})],keywords:null===n||void 0===n||null===(l=n.keywords)||void 0===l?void 0:l.split(","),parent_id:{label:null===(i=n.parent)||void 0===i||null===(t=i.translation)||void 0===t?void 0:t.title,value:n.parent_id,key:n.parent_id}};var s;q(r),k(n.id)})).finally((()=>{C(!1),w((0,m.A_)(U))})))}),[U.refetch,f]),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsxs)(n.Z,{gutter:24,className:"mb-4",children:[(0,P.jsx)(r.Z,{span:8,children:(0,P.jsx)(s.Z,{title:y("basic.info"),style:{height:"100%"},loading:A,children:(0,P.jsxs)(n.Z,{gutter:[24,24],children:[(0,P.jsx)(r.Z,{span:24,children:(0,P.jsxs)(a.Z,{children:[(0,P.jsxs)("strong",{children:[y("category.name"),":"]}),(0,P.jsx)("span",{children:null===I||void 0===I||null===(e=I.translation)||void 0===e?void 0:e.title})]})}),(0,P.jsx)(r.Z,{span:24,children:(0,P.jsxs)(a.Z,{children:[(0,P.jsxs)("strong",{children:[y("category.description"),":"]}),(0,P.jsx)("span",{children:I["description[".concat(N||"en","]")]})]})})]})})}),(0,P.jsx)(r.Z,{span:8,children:(0,P.jsx)(s.Z,{title:y("organization"),style:{height:"100%"},loading:A,children:(0,P.jsxs)(n.Z,{gutter:[24,24],children:[(0,P.jsx)(r.Z,{span:24,children:(0,P.jsxs)(a.Z,{children:[(0,P.jsxs)("strong",{children:[y("keyword"),":"]}),null===I||void 0===I||null===(l=I.keywords)||void 0===l?void 0:l.map(((e,l)=>(0,P.jsx)(d.Z,{children:e},l)))]})}),(0,P.jsx)(r.Z,{span:24,children:(0,P.jsxs)(a.Z,{children:[(0,P.jsxs)("strong",{children:[y("parent.category"),":"]}),(0,P.jsx)("span",{children:null===I||void 0===I||null===(i=I.parent)||void 0===i||null===(g=i.translation)||void 0===g?void 0:g.title})]})})]})})}),(0,P.jsx)(r.Z,{span:8,children:(0,P.jsx)(s.Z,{title:y("media"),style:{height:"100%"},loading:A,children:(0,P.jsx)(a.Z,{wrap:!0,children:null===I||void 0===I||null===(Z=I.image)||void 0===Z?void 0:Z.map((e=>(0,P.jsx)(o.Z,{src:e.url,width:100,height:100})))})})})]}),!!b&&(0,P.jsx)(x.Z,{type:"main"===(null===I||void 0===I?void 0:I.type)?"sub_main":"child",parent_type:null===I||void 0===I?void 0:I.type,parentId:b,handleAddAction:e=>{S(e)},isRefetch:L}),(0,P.jsx)(c.Z,{title:y("add.subcategory"),visible:E,onCancel:()=>{S(null)},centered:!0,footer:null,destroyOnClose:!0,children:(0,P.jsx)(_,{setId:S,id:E,setIsRefetch:F,parent:{parent_id:{label:I["title[".concat(N,"]")],value:null===I||void 0===I?void 0:I.id},id:null===I||void 0===I?void 0:I.id,type:null===I||void 0===I?void 0:I.type}})})]})}}}]);