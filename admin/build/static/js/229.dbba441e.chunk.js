"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[229],{89281:(e,t,a)=>{a.d(t,{h:()=>u});var s=a(47313),r=a(12279),n=a.n(r),l=a(74294),d=a(72652),i=a(46417);const u=e=>{let{fetchOptions:t,debounceTimeout:a=400,onClear:r,refetchOptions:u=!1,...o}=e;const[c,m]=(0,s.useState)(!1),[h,p]=(0,s.useState)([]),v=(0,s.useMemo)((()=>n()((e=>{p([]),m(!0),t(e).then((e=>{p(e),m(!1)}))}),a)),[t,a]);return(0,i.jsx)(l.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:v,onClear:()=>{v(""),r&&r()},notFoundContent:c?(0,i.jsx)(d.Z,{size:"small"}):"no results",...o,options:h,onFocus:()=>{h.length&&!u||v("")}})}},81742:(e,t,a)=>{a.d(t,{Z:()=>r});var s=a(34344);const r={getAll:e=>s.Z.get("dashboard/seller/stocks/select-paginate",{params:e})}},229:(e,t,a)=>{a.r(t),a.d(t,{default:()=>D});var s=a(47313),r=a(97890),n=a(23560),l=a(10976),d=a(77181),i=a(68197),u=a(59624),o=a(74294),c=a(16124),m=a(99096),h=a(59491),p=a(70816),v=a.n(p),x=a(2717),f=a(90954),Z=a(57409),j=a(69660),g=a(89281),Y=a(24511),y=a(5764),b=a(81742),M=a(46417);function D(){var e,t;const{t:a}=(0,Y.$)(),{activeMenu:p}=(0,x.v9)((e=>e.menu),x.wU),D=(0,x.I0)(),[q]=l.Z.useForm(),N=(0,r.s0)(),[w,S]=(0,s.useState)(!1),{myShop:I}=(0,x.v9)((e=>e.myShop),x.wU),[k,O]=(0,s.useState)(null!==(e=p.data)&&void 0!==e&&e.images?[null===(t=p.data)||void 0===t?void 0:t.images[0]]:[]);(0,s.useEffect)((()=>()=>{const e=q.getFieldsValue(!0),t=JSON.stringify(e.start),a=JSON.stringify(e.end),s={...e,start:t,end:a};D((0,f.nc)({activeMenu:p,data:s}))}),[]);return(0,M.jsx)(d.Z,{title:a("add.discount"),className:"h-100",children:(0,M.jsxs)(l.Z,{name:"discount-add",layout:"vertical",onFinish:e=>{var t;if(v()(e.start).format("YYYY-MM-DD")>v()(e.end).format("YYYY-MM-DD"))return n.Am.error(a("start.date.must.be.before.end.date"));const s={price:e.price,type:e.type,stocks:e.products.map((e=>e.value)),start:e.start?v()(e.start).format("YYYY-MM-DD"):void 0,end:e.end?v()(e.end).format("YYYY-MM-DD"):void 0,images:[null===(t=k[0])||void 0===t?void 0:t.name]};S(!0);const r="seller/discounts";Z.Z.create(s).then((()=>{n.Am.success(a("successfully.created")),(0,x.dC)((()=>{D((0,f.ph)({...p,nextUrl:r})),D((0,j.k)({}))})),N("/".concat(r))})).finally((()=>S(!1)))},form:q,initialValues:{...(()=>{var e,t,a,s;const r=p.data;if(null===(e=p.data)||void 0===e||!e.start||null===(t=p.data)||void 0===t||!t.end)return r;const n=null===(a=p.data)||void 0===a?void 0:a.start,l=null===(s=p.data)||void 0===s?void 0:s.end;return{...r,start:v()(n,"YYYY-MM-DD"),end:v()(l,"YYYY-MM-DD")}})(),...p.data},className:"d-flex flex-column h-100",children:[(0,M.jsxs)(i.Z,{gutter:12,children:[(0,M.jsx)(u.Z,{span:12,children:(0,M.jsx)(l.Z.Item,{label:a("type"),name:"type",rules:[{required:!0,message:a("required")}],children:(0,M.jsxs)(o.Z,{children:[(0,M.jsx)(o.Z.Option,{value:"fix",children:a("fix")}),(0,M.jsx)(o.Z.Option,{value:"percent",children:a("percent")})]})})}),(0,M.jsx)(u.Z,{span:12,children:(0,M.jsx)(l.Z.Item,{label:a("price"),name:"price",rules:[{required:!0,message:a("required")}],children:(0,M.jsx)(c.Z,{min:0,className:"w-100"})})}),(0,M.jsx)(u.Z,{span:12,children:(0,M.jsx)(l.Z.Item,{label:a("start.date"),name:"start",rules:[{required:!0,message:a("required")}],valuePropName:"date",children:(0,M.jsx)(m.Z,{className:"w-100",placeholder:"",disabledDate:e=>v()().add(-1,"days")>=e})})}),(0,M.jsx)(u.Z,{span:12,children:(0,M.jsx)(l.Z.Item,{label:a("end.date"),name:"end",rules:[{required:!0,message:a("required")}],valuePropName:"date",children:(0,M.jsx)(m.Z,{className:"w-100",placeholder:"",disabledDate:e=>v()().add(-1,"days")>=e})})}),(0,M.jsx)(u.Z,{span:24,children:(0,M.jsx)(l.Z.Item,{label:a("products"),name:"products",rules:[{required:!0,message:a("required")}],children:(0,M.jsx)(g.h,{fetchOptions:async function(e){const t={search:e,shop_id:I.id};return b.Z.getAll(t).then((e=>{let{data:t}=e;return t.map((e=>{var t,a;return{label:null===e||void 0===e||null===(t=e.product)||void 0===t||null===(a=t.translation)||void 0===a?void 0:a.title,value:e.id,key:e.id}}))}))},mode:"multiple"})})}),(0,M.jsx)(u.Z,{span:24,children:(0,M.jsx)(l.Z.Item,{label:a("image"),name:"images",rules:[{required:!k.length,message:a("required")}],children:(0,M.jsx)(y.Z,{type:"discounts",imageList:k,setImageList:O,form:q,multiple:!1,name:"image"})})})]}),(0,M.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,M.jsx)("div",{className:"pb-5",children:(0,M.jsx)(h.Z,{type:"primary",htmlType:"submit",loading:w,children:a("submit")})})})]})})}}}]);