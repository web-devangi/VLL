"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[1760],{97388:(e,l,a)=>{a.d(l,{Z:()=>v});var r=a(47313),n=a(16609),i=a(97421);const t=a.p+"static/media/pin.0e41858db80c699cd8a2.png";var s=a(31881),o=a.n(s);async function d(e){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.kr,a={latlng:"".concat(null===e||void 0===e?void 0:e.lat,",").concat(null===e||void 0===e?void 0:e.lng),key:l};return o().get("https://maps.googleapis.com/maps/api/geocode/json",{params:a}).then((e=>{var l;let{data:a}=e;return null===(l=a.results[0])||void 0===l?void 0:l.formatted_address})).catch((e=>"not found"))}var u=a(5958),c=a(23560),m=a(24511),h=a(46417);const v=(0,n.GoogleApiWrapper)({apiKey:i.kr})((function(e){const[l,a]=(0,r.useState)(),{t:s}=(0,m.$)(),o=async()=>{await navigator.geolocation.getCurrentPosition((function(e){const l={lat:e.coords.latitude,lng:e.coords.longitude};a(l)}),(function(e){c.Am.warning(s("turn.on.gps"))}))};(0,r.useEffect)((()=>{o()}),[]);const v=[{lat:Number(e.location.lat)||0,lng:Number(e.location.lng)||0}];for(var p=new e.google.maps.LatLngBounds,g=0;g<v.length;g++)p.extend(v[g]);return(0,h.jsxs)("div",{className:"map-container",style:{height:400,width:"100%"},children:[(0,h.jsx)("button",{className:"map-button",type:"button",onClick:()=>{o(),l&&(async l=>{const a={lat:null===l||void 0===l?void 0:l.lat,lng:null===l||void 0===l?void 0:l.lng};e.setLocation(a);const r=await d(a,i.kr);e.setAddress(r)})(l)},children:(0,h.jsx)(u.nDs,{})}),(0,h.jsx)(n.Map,{cursor:"pointer",onClick:async(l,a,r)=>{const{latLng:n}=r,t={lat:n.lat(),lng:n.lng()};e.setLocation(t);const s=await d(t,i.kr);e.setAddress(s)},google:e.google,defaultZoom:12,zoom:10,className:"clickable",initialCenter:e.location,center:e.location,children:(0,h.jsx)(n.Marker,{position:e.location,icon:{url:t,scaledSize:new e.google.maps.Size(32,32)},className:"marker"})})]})}))},13622:(e,l,a)=>{a.d(l,{R:()=>d});var r=a(47313),n=a(12279),i=a.n(n),t=a(74294),s=a(72652),o=a(46417);const d=e=>{let{fetchOptions:l,debounceTimeout:a=400,refetch:n=!1,...d}=e;const[u,c]=(0,r.useState)(!1),[m,h]=(0,r.useState)([]),v=(0,r.useMemo)((()=>i()((e=>{h([]),c(!0),l(e).then((e=>{h(e),c(!1)}))}),a)),[l,a]);return(0,o.jsx)(t.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,onClear:()=>v(""),filterOption:!1,onSearch:v,notFoundContent:u?(0,o.jsx)(s.Z,{size:"small"}):"no results",...d,options:m,onFocus:()=>{m.length&&!n||v("")}})}},89281:(e,l,a)=>{a.d(l,{h:()=>d});var r=a(47313),n=a(12279),i=a.n(n),t=a(74294),s=a(72652),o=a(46417);const d=e=>{let{fetchOptions:l,debounceTimeout:a=400,onClear:n,refetchOptions:d=!1,...u}=e;const[c,m]=(0,r.useState)(!1),[h,v]=(0,r.useState)([]),p=(0,r.useMemo)((()=>i()((e=>{v([]),m(!0),l(e).then((e=>{v(e),m(!1)}))}),a)),[l,a]);return(0,o.jsx)(t.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:p,onClear:()=>{p(""),n&&n()},notFoundContent:c?(0,o.jsx)(s.Z,{size:"small"}):"no results",...u,options:h,onFocus:()=>{h.length&&!d||p("")}})}},17649:(e,l,a)=>{a.d(l,{Z:()=>r});a(97421);function r(e){if(null===e||void 0===e||!e.location)return{lat:47.4143302506288,lng:8.532059477976883};const l=e.location.split(", ");return{lat:Number(null===l||void 0===l?void 0:l[0]),lng:Number(null===l||void 0===l?void 0:l[1])}}},84805:(e,l,a)=>{a.r(l),a.d(l,{default:()=>B});var r=a(47313),n=a(10976),i=a(77181),t=a(68197),s=a(59624),o=a(66672),d=a(16124),u=a(99096),c=a(74294),m=a(46155),h=a(59491),v=a(97890),p=a(23560),g=a(2717),x=a(90954),j=a(49986),Z=a(24511),y=a(70816),b=a.n(y),f=a(5764),w=a(89281),q=a(53149),_=a(84304),k=a(45321),I=a(17649),S=a(86345),P=a(97388),C=a(46417);const N=[{label:"Benzine",value:"benzine"},{label:"Diesel",value:"diesel"},{label:"Gas",value:"gas"},{label:"Motorbike",value:"motorbike"},{label:"Bike",value:"bike"},{label:"Foot",value:"foot"},{label:"Electric",value:"electric"}],F=e=>{let{location:l,setLocation:a,form:r,image:i,setImage:d}=e;const{t:u}=(0,Z.$)();return(0,C.jsxs)(t.Z,{gutter:12,children:[(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:u("brand"),name:"brand",rules:[{required:!0,message:u("required")},{validator(e,l){var a;return l&&(null===l||void 0===l||null===(a=l.trim())||void 0===a?void 0:a.length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve()}}],children:(0,C.jsx)(o.Z,{placeholder:u("type.here"),maxLength:20})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:u("model"),name:"model",rules:[{required:!0,message:u("required")},{validator(e,l){var a;return l&&(null===l||void 0===l||null===(a=l.trim())||void 0===a?void 0:a.length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve()}}],children:(0,C.jsx)(o.Z,{placeholder:u("type.here"),maxLength:20})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:u("type.of.technique"),name:"type_of_technique",rules:[{required:!0,message:u("required")}],children:(0,C.jsx)(c.Z,{options:N,placeholder:u("select.technique")})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:u("car.number"),name:"number",rules:[{required:!0,message:u("required")},{validator(e,l){var a;return l&&(null===l||void 0===l||null===(a=l.trim())||void 0===a?void 0:a.length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve()}}],children:(0,C.jsx)(o.Z,{placeholder:u("type.here"),maxLength:20})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:u("car.color"),name:"color",rules:[{required:!0,message:u("required")},{validator(e,l){var a;return l&&(null===l||void 0===l||null===(a=l.trim())||void 0===a?void 0:a.length)<2?Promise.reject(new Error(u("must.be.at.least.2"))):Promise.resolve()}}],children:(0,C.jsx)(o.Z,{placeholder:u("type.here"),maxLength:20})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:u("image"),name:"deliveryman-settings-images",rules:[{required:!(null!==i&&void 0!==i&&i.length),message:u("required")}],children:(0,C.jsx)(f.Z,{type:"deliveryman/settings",imageList:i,setImageList:d,form:r,length:"1",multiple:!0})})}),(0,C.jsx)(s.Z,{span:6,children:(0,C.jsx)(n.Z.Item,{label:u("online"),name:"online",rules:[{required:!0,message:u("required")}],valuePropName:"checked",children:(0,C.jsx)(S.Z,{})})}),(0,C.jsx)(s.Z,{span:24,children:(0,C.jsx)(n.Z.Item,{label:u("map"),name:"location",children:(0,C.jsx)(P.Z,{location:l,setLocation:a})})})]})};var L=a(81566),O=a(27443),z=a(79637),E=a(47139),R=a(27453),A=a(13622);const M=e=>{let{form:l}=e;const{t:a}=(0,Z.$)(),[i,t]=(0,r.useState)({}),{country:o,region:d,city:u}=i;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("region"),name:"region",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(A.R,{fetchOptions:async function(e){const l={search:e,status:1,perPage:10};return R.Z.get(l).then((e=>{let{data:l}=e;return l.map((e=>({label:e.translation.title||"no name",value:e.id,key:null===e||void 0===e?void 0:e.id})))}))},dropdownRender:e=>(0,C.jsx)(C.Fragment,{children:e}),refetch:!0,onChange:e=>{t((l=>({...l,region:e}))),l.resetFields(["city","area","country"])},placeholder:a("select.region"),autoComplete:"none"})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("country"),name:"country",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(A.R,{fetchOptions:async function(e){const l={search:e,status:1,perPage:10,region_id:null===d||void 0===d?void 0:d.value};return E.Z.get(l).then((e=>{let{data:l}=e;return l.map((e=>({label:e.translation.title||"no name",value:e.id,key:null===e||void 0===e?void 0:e.id})))}))},dropdownRender:e=>(0,C.jsx)(C.Fragment,{children:e}),refetch:!0,onChange:e=>{t((l=>({...l,country:e}))),l.resetFields(["city","area"])},disabled:!Boolean(null===d||void 0===d?void 0:d.value),placeholder:a("select.country"),autoComplete:"none"})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("city"),name:"city",rules:[{required:!1,message:a("required")}],children:(0,C.jsx)(A.R,{fetchOptions:async function(e){const l={search:e,status:1,perPage:10,country_id:null===o||void 0===o?void 0:o.value};return z.Z.get(l).then((e=>{let{data:l}=e;return l.map((e=>({label:e.translation.title||"no name",value:e.id,key:null===e||void 0===e?void 0:e.id})))}))},dropdownRender:e=>(0,C.jsx)(C.Fragment,{children:e}),refetch:!0,disabled:!Boolean(null===o||void 0===o?void 0:o.value),onChange:e=>{t((l=>({...l,city:e}))),l.resetFields(["area"])},placeholder:a("select.city"),autoComplete:"none"})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("area"),name:"area",rules:[{required:!1,message:a("required")}],children:(0,C.jsx)(A.R,{fetchOptions:async function(e){const l={search:e,status:1,perPage:10,city_id:null===u||void 0===u?void 0:u.value};return O.Z.get(l).then((e=>{let{data:l}=e;return l.map((e=>{var l;return{label:(null===e||void 0===e||null===(l=e.translation)||void 0===l?void 0:l.title)||"no name",value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},dropdownRender:e=>(0,C.jsx)(C.Fragment,{children:e}),refetch:!0,disabled:!Boolean(null===u||void 0===u?void 0:u.value),placeholder:a("select.area")})})})]})};function B(){var e,l;const{t:a}=(0,Z.$)(),[y]=n.Z.useForm(),[S,P]=(0,r.useState)(),[N,O]=(0,r.useState)(null),[z,E]=(0,r.useState)(!1),R=(0,v.s0)(),A=(0,g.v9)((e=>e.user),g.wU),{role:B}=(0,v.UO)(),{settings:V}=(0,g.v9)((e=>e.globalSettings),g.wU),[$,T]=(0,r.useState)((0,I.Z)(V));(0,r.useEffect)((()=>()=>{const e=y.getFieldsValue(!0);e.birthday=JSON.stringify(null===e||void 0===e?void 0:e.birthday),G((0,x.nc)({activeMenu:D,data:{...D.data,...e}}))}),[]);const U=(0,v.TH)(),D=(0,g.v9)((e=>e.menu.activeMenu)),G=(0,g.I0)(),[J,W]=(0,r.useState)(null!==D&&void 0!==D&&null!==(e=D.data)&&void 0!==e&&e.images?null===D||void 0===D||null===(l=D.data)||void 0===l?void 0:l.images:[]),[H,K]=(0,r.useState)([]);async function Q(e){const l={search:e,status:"approved"};return q.Z.search(l).then((e=>e.data.map((e=>({label:null!==e.translation?e.translation.title:"no name",value:e.id,key:e.id})))))}return(0,C.jsx)(i.Z,{title:a("add.user"),children:(0,C.jsx)(n.Z,{form:y,layout:"vertical",initialValues:{online:!0,gender:"male",...D.data,...(()=>{var e,l;if(null===(e=D.data)||void 0===e||!e.birthday)return{};const a=JSON.parse(null===(l=D.data)||void 0===l?void 0:l.birthday);return{birthday:b()(a)}})()},onFinish:e=>{var l,r,n,i,t,s;E(!0);const o={firstname:e.firstname,lastname:e.lastname,email:e.user_email,phone:e.phone,birthday:S,gender:e.gender,password_confirmation:e.password_confirmation,password:e.password,images:J[0]?[null===(l=J[0])||void 0===l?void 0:l.name]:void 0,shop_id:null!==e&&void 0!==e&&e.shop_id?void 0!==(null===e||void 0===e?void 0:e.shop_id.length)?null===e||void 0===e||null===(r=e.shop_id)||void 0===r?void 0:r.map((e=>e.value)):[null===e||void 0===e?void 0:e.shop_id.value]:void 0,role:B||void 0,online:Number(e.online),height:e.height,kg:e.kg,length:e.length,price:e.price,price_per_km:e.price_per_km,width:e.width,area_id:null===e||void 0===e||null===(n=e.area)||void 0===n?void 0:n.value,city_id:null===e||void 0===e||null===(i=e.city)||void 0===i?void 0:i.value,country_id:null===e||void 0===e||null===(t=e.country)||void 0===t?void 0:t.value,region_id:null===e||void 0===e||null===(s=e.region)||void 0===s?void 0:s.value},d=U.pathname.search("/user/delivery/")?"deliveries/list":"users/admin";j.Z.create(o).then((l=>{let{data:r}=l;if("deliveryman"===B){var n,i,t,s;const l={color:e.color,number:e.number,type_of_technique:e.type_of_technique,brand:e.brand,model:e.model,user_id:r.id,images:J.map((e=>e.name)),location:{latitude:$.lat,longitude:$.lng},online:Number(e.online),height:e.height,kg:e.kg,length:e.length,price:e.price,price_per_km:e.price_per_km,width:e.width,area_id:null===e||void 0===e||null===(n=e.area)||void 0===n?void 0:n.value,city_id:null===e||void 0===e||null===(i=e.city)||void 0===i?void 0:i.value,country_id:null===e||void 0===e||null===(t=e.country)||void 0===t?void 0:t.value,region_id:null===e||void 0===e||null===(s=e.region)||void 0===s?void 0:s.value};k.Z.create(l).then((()=>{p.Am.success(a("successfully.created")),(0,g.dC)((()=>{G((0,x.ph)({...D,nextUrl:d})),G(U.pathname.search("/user/delivery/")?(0,L.W)({}):(0,_.uh)({role:B}))})),R("/".concat(d))}))}else{const e="users/admin",l={...A.params,role:r.role};(0,g.dC)((()=>{G((0,x.ph)({...D,menu:e})),G((0,_.uh)(l))})),R("/".concat(e))}})).catch((e=>{var l,a,r,n,i,t,s;null!==e&&void 0!==e&&null!==(l=e.response)&&void 0!==l&&null!==(a=l.data)&&void 0!==a&&a.params&&(p.Am.dismiss(),null===(i=Object.values(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(s=t.data)||void 0===s?void 0:s.params))||void 0===i||i.map((e=>p.Am.error(e[0]))));O(null===e||void 0===e||null===(r=e.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.params)})).finally((()=>E(!1)))},children:(0,C.jsxs)(t.Z,{gutter:12,children:[(0,C.jsx)(s.Z,{span:24,children:(0,C.jsx)(n.Z.Item,{rules:[{required:!(null!==J&&void 0!==J&&J.length),message:a("required")}],name:"images",label:a("avatar"),children:(0,C.jsx)(f.Z,{type:"users",imageList:J,setImageList:W,form:y,multiple:!1})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("firstname"),name:"firstname",help:null!==N&&void 0!==N&&N.firstname?N.firstname[0]:null,validateStatus:null!==N&&void 0!==N&&N.firstname?"error":"success",rules:[{required:!0,message:a("required")},{validator(e,l){var r;return l&&(null===l||void 0===l||null===(r=l.trim())||void 0===r?void 0:r.length)<2?Promise.reject(new Error(a("min.2.letters"))):Promise.resolve()}},{pattern:new RegExp(/^[A-Za-z]+$/i),message:a("only.letters")}],children:(0,C.jsx)(o.Z,{placeholder:a("type.here"),maxLength:20})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:"lastname",name:"lastname",help:null!==N&&void 0!==N&&N.lastname?N.lastname[0]:null,validateStatus:null!==N&&void 0!==N&&N.lastname?"error":"success",rules:[{required:!0,message:a("required")},{validator(e,l){var r;return l&&(null===l||void 0===l||null===(r=l.trim())||void 0===r?void 0:r.length)<2?Promise.reject(new Error(a("min.2.letters"))):Promise.resolve()}},{pattern:new RegExp(/^[A-Za-z]+$/i),message:a("only.letters")}],children:(0,C.jsx)(o.Z,{placeholder:a("type.here"),maxLength:20})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("phone"),name:"phone",help:null!==N&&void 0!==N&&N.phone?N.phone[0]:null,validateStatus:null!==N&&void 0!==N&&N.phone?"error":"success",rules:[{required:!0,message:a("required")},{type:"number",max:99999999,message:a("max.length.8")}],children:(0,C.jsx)(d.Z,{min:0,className:"w-100",placeholder:a("type.here")})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("birthday"),name:"birthday",rules:[{required:!0,message:a("required")}],valuePropName:"date",children:(0,C.jsx)(u.Z,{onChange:(e,l)=>P(l),className:"w-100",disabledDate:e=>b()().add(-18,"years")<=e,defaultPickerValue:b()().add(-18,"years")})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("gender"),name:"gender",rules:[{required:!0,message:a("required")}],children:(0,C.jsxs)(c.Z,{picker:"dayTime",className:"w-100",children:[(0,C.jsx)(c.Z.Option,{value:"male",children:a("male")}),(0,C.jsx)(c.Z.Option,{value:"female",children:a("female")})]})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("email"),name:"user_email",help:null!==N&&void 0!==N&&N.email?N.email[0]:null,validateStatus:null!==N&&void 0!==N&&N.email?"error":"success",rules:[{required:!0,message:a("required")},{type:"email",message:a("invalid.email")}],children:(0,C.jsx)(o.Z,{type:"email",placeholder:a("type.here"),maxLength:20})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("password"),name:"password",help:null!==N&&void 0!==N&&N.password?N.password[0]:null,validateStatus:null!==N&&void 0!==N&&N.password?"error":"success",rules:[{required:!0,message:a("required")},{validator:(e,l)=>l&&(null===l||void 0===l?void 0:l.length)<6?Promise.reject(new Error(a("min.6.letters"))):Promise.resolve()}],normalize:e=>""===(null===e||void 0===e?void 0:e.trim())?null===e||void 0===e?void 0:e.trim():e,children:(0,C.jsx)(o.Z.Password,{type:"password",className:"w-100",placeholder:a("type.here"),maxLength:20})})}),"admin"!==B&&"manager"!==B&&"moderator"!==B&&"seller"!==B&&"cook"!==B&&"user"!==B&&(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("shop"),name:"shop_id",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(w.h,{mode:"multiple",className:"w-100",placeholder:a("select.shop"),fetchOptions:Q,allowClear:!1})})}),"cook"===B&&(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("shop"),name:"shop_id",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(w.h,{fetchOptions:Q,className:"w-100",placeholder:a("select.shop"),allowClear:!1})})}),"moderator"===B&&(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("branches"),name:"shop_id",rules:[{required:!0,message:a("required")}],children:(0,C.jsx)(w.h,{fetchOptions:Q,className:"w-100",placeholder:a("select.shop"),allowClear:!1})})}),(0,C.jsx)(s.Z,{span:12,children:(0,C.jsx)(n.Z.Item,{label:a("password.confirmation"),help:null!==N&&void 0!==N&&N.password_confirmation?N.password_confirmation[0]:null,validateStatus:null!==N&&void 0!==N&&N.password_confirmation?"error":"success",name:"password_confirmation",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:a("required")},e=>{let{getFieldValue:l}=e;return{validator:(e,r)=>r&&l("password")!==r?Promise.reject(a("two.passwords.dont.match")):Promise.resolve()}}],normalize:e=>""===(null===e||void 0===e?void 0:e.trim())?null===e||void 0===e?void 0:e.trim():e,children:(0,C.jsx)(o.Z.Password,{type:"password",placeholder:a("type.here")})})}),"deliveryman"===B&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(m.Z,{className:"pt-3 pb-3",dashed:!0,orientation:"left",plain:!0,children:a("deliveryman.address")}),(0,C.jsx)(M,{form:y})]}),"deliveryman"===B&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(m.Z,{className:"pt-3 pb-3",dashed:!0,orientation:"left",plain:!0,children:a("deliveryman.settings")}),(0,C.jsx)(F,{setLocation:T,location:$,setImage:K,image:H,form:y})]}),(0,C.jsx)(s.Z,{span:24,children:(0,C.jsx)(h.Z,{type:"primary",htmlType:"submit",loading:z,children:a("save")})})]})})})}}}]);