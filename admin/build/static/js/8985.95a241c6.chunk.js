"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[8985],{88985:function(e,n,i){i.r(n),i.d(n,{default:function(){return F}});var t=i(1413),l=i(93433),r=i(4942),a=i(29439),s=i(47313),o=i(68197),d=i(59624),c=i(77181),u=i(45705),v=i(66204),m=i(26824),h=i(9274),p=i(97890),Z=i(2717),j=i(90954),f=i(30763),x=i(97421),g=i(24511),y=i(59308),w=i(10976),b=i(74294),k=i(66672),I=i(86345),P=i(59491),_=i(23560),q=i(52421),E=i(5764),S=i(46417),L=function(e){var n,i,l=e.parent,r=void 0===l?{}:l,c=e.setId,u=e.setIsRefetch,v=(0,g.$)().t,m=(0,Z.v9)((function(e){return e.menu}),Z.wU).activeMenu,h=(0,s.useState)(null!==(n=m.data)&&void 0!==n&&n.image?[null===(i=m.data)||void 0===i?void 0:i.image]:[]),p=(0,a.Z)(h,2),j=p[0],x=p[1],y=w.Z.useForm(),L=(0,a.Z)(y,1)[0],F=(0,s.useState)(!1),U=(0,a.Z)(F,2),A=U[0],C=U[1],O=(0,s.useState)(null),z=(0,a.Z)(O,2),N=z[0],R=z[1],M=(0,Z.v9)((function(e){return e.formLang}),Z.wU),V=M.defaultLang,$=M.languages;(0,s.useEffect)((function(){return function(){L.resetFields()}}),[]);return null!==r&&void 0!==r&&r.id?(0,S.jsxs)(w.Z,{name:"basic",layout:"vertical",onFinish:function(e){var n,i;C(!0);var l=(0,t.Z)((0,t.Z)({},e),{},{type:"main"===(null===r||void 0===r?void 0:r.type)?"sub_main":"child",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(n=e.parent_id)||void 0===n?void 0:n.value,"images[0]":null===(i=j[0])||void 0===i?void 0:i.name});f.Z.create(l).then((function(){_.Am.success(v("successfully.created")),c(null),L.resetFields(),u(!0)})).catch((function(e){return R(e.response.data.params)})).finally((function(){return C(!1)}))},initialValues:(0,t.Z)({active:!0},r),form:L,children:[(0,S.jsxs)(o.Z,{gutter:24,children:[(0,S.jsx)(d.Z,{span:24,children:(0,S.jsx)(w.Z.Item,{label:v("parent.category"),name:"parent_id",rules:[{required:!1,message:v("required")}],children:(0,S.jsx)(b.Z,{disabled:!0})})}),(0,S.jsx)(d.Z,{span:24,children:$.map((function(e,n){return(0,S.jsx)(w.Z.Item,{label:v("name"),name:"title[".concat(e.locale,"]"),help:N&&N["title.".concat(V)]?N["title.".concat(V)][0]:null,validateStatus:N?"error":"success",rules:[{required:!0,validator:function(n,i){return i||(null===e||void 0===e?void 0:e.locale)!==V?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(v("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<2?Promise.reject(new Error(v("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(v("required")))}}],hidden:e.locale!==V,children:(0,S.jsx)(k.Z,{placeholder:v("name")})},e.title+n)}))}),(0,S.jsx)(d.Z,{span:24,children:$.map((function(e,n){return(0,S.jsx)(w.Z.Item,{label:v("description"),name:"description[".concat(e.locale,"]"),rules:[{required:!0,validator:function(n,i){return i||(null===e||void 0===e?void 0:e.locale)!==V?i&&""===(null===i||void 0===i?void 0:i.trim())?Promise.reject(new Error(v("no.empty.space"))):i&&(null===i||void 0===i?void 0:i.trim().length)<5?Promise.reject(new Error(v("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(v("required")))}}],hidden:e.locale!==V,children:(0,S.jsx)(q.Z,{rows:4})},e.locale+n)}))}),(0,S.jsx)(d.Z,{span:24,children:(0,S.jsx)(w.Z.Item,{label:v("keywords"),name:"keywords",rules:[{required:!0,message:v("required")}],children:(0,S.jsx)(b.Z,{mode:"tags",style:{width:"100%"}})})}),(0,S.jsx)(d.Z,{span:12,children:(0,S.jsx)(w.Z.Item,{label:v("image"),name:"images",rules:[{validator:function(){return 0===(null===j||void 0===j?void 0:j.length)?Promise.reject(new Error(v("required"))):Promise.resolve()}}],children:(0,S.jsx)(E.Z,{type:"categories",imageList:j,setImageList:x,form:L,multiple:!1})})}),(0,S.jsx)(d.Z,{span:12,children:(0,S.jsx)(w.Z.Item,{label:v("active"),name:"active",valuePropName:"checked",children:(0,S.jsx)(I.Z,{})})})]}),(0,S.jsx)(P.Z,{type:"primary",htmlType:"submit",loading:A,className:"w-100",children:v("submit")})]}):""},F=function(){var e,n,i,w,b,k=(0,g.$)().t,I=(0,p.UO)().uuid,P=(0,Z.I0)(),_=(0,s.useState)(null),q=(0,a.Z)(_,2),E=q[0],F=q[1],U=(0,s.useState)({}),A=(0,a.Z)(U,2),C=A[0],O=A[1],z=(0,s.useState)(null),N=(0,a.Z)(z,2),R=N[0],M=N[1],V=(0,s.useState)(null),$=(0,a.Z)(V,2),B=$[0],T=$[1],D=(0,Z.v9)((function(e){return e.menu}),Z.wU).activeMenu,G=(0,s.useState)(!1),H=(0,a.Z)(G,2),J=H[0],K=H[1],Q=(0,Z.v9)((function(e){return e.formLang}),Z.wU),W=Q.languages,X=Q.defaultLang;var Y=function(e){K(!0),f.Z.getById(e).then((function(e){var n,i,a,s,o=e.data,d=(0,t.Z)((0,t.Z)((0,t.Z)({},o),function(e){if(!e)return{};var n=e.translations,i=W.map((function(e){var i,t,l;return l={},(0,r.Z)(l,"title[".concat(e.locale,"]"),null===(i=n.find((function(n){return n.locale===e.locale})))||void 0===i?void 0:i.title),(0,r.Z)(l,"description[".concat(e.locale,"]"),null===(t=n.find((function(n){return n.locale===e.locale})))||void 0===t?void 0:t.description),l}));return Object.assign.apply(Object,[{}].concat((0,l.Z)(i)))}(o)),{},{image:[(s=o.img,{name:s,url:x.bV+s})],keywords:null===o||void 0===o||null===(n=o.keywords)||void 0===n?void 0:n.split(","),parent_id:{label:null===(i=o.parent)||void 0===i||null===(a=i.translation)||void 0===a?void 0:a.title,value:o.parent_id,key:o.parent_id}});O(d),F(o.id)})).finally((function(){K(!1),P((0,j.A_)(D))}))};return(0,s.useEffect)((function(){I&&Y(I)}),[D.refetch,I]),(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(o.Z,{gutter:24,className:"mb-4",children:[(0,S.jsx)(d.Z,{span:8,children:(0,S.jsx)(c.Z,{title:k("basic.info"),style:{height:"100%"},loading:J,children:(0,S.jsxs)(o.Z,{gutter:[24,24],children:[(0,S.jsx)(d.Z,{span:24,children:(0,S.jsxs)(u.Z,{children:[(0,S.jsxs)("strong",{children:[k("category.name"),":"]}),(0,S.jsx)("span",{children:null===C||void 0===C||null===(e=C.translation)||void 0===e?void 0:e.title})]})}),(0,S.jsx)(d.Z,{span:24,children:(0,S.jsxs)(u.Z,{children:[(0,S.jsxs)("strong",{children:[k("category.description"),":"]}),(0,S.jsx)("span",{children:C["description[".concat(X||"en","]")]})]})})]})})}),(0,S.jsx)(d.Z,{span:8,children:(0,S.jsx)(c.Z,{title:k("organization"),style:{height:"100%"},loading:J,children:(0,S.jsxs)(o.Z,{gutter:[24,24],children:[(0,S.jsx)(d.Z,{span:24,children:(0,S.jsxs)(u.Z,{children:[(0,S.jsxs)("strong",{children:[k("keyword"),":"]}),null===C||void 0===C||null===(n=C.keywords)||void 0===n?void 0:n.map((function(e,n){return(0,S.jsx)(v.Z,{children:e},n)}))]})}),(0,S.jsx)(d.Z,{span:24,children:(0,S.jsxs)(u.Z,{children:[(0,S.jsxs)("strong",{children:[k("parent.category"),":"]}),(0,S.jsx)("span",{children:null===C||void 0===C||null===(i=C.parent)||void 0===i||null===(w=i.translation)||void 0===w?void 0:w.title})]})})]})})}),(0,S.jsx)(d.Z,{span:8,children:(0,S.jsx)(c.Z,{title:k("media"),style:{height:"100%"},loading:J,children:(0,S.jsx)(u.Z,{wrap:!0,children:null===C||void 0===C||null===(b=C.image)||void 0===b?void 0:b.map((function(e){return(0,S.jsx)(m.Z,{src:e.url,width:100,height:100})}))})})})]}),!!E&&(0,S.jsx)(y.Z,{type:"main"===(null===C||void 0===C?void 0:C.type)?"sub_main":"child",parent_type:null===C||void 0===C?void 0:C.type,parentId:E,handleAddAction:function(e){M(e)},isRefetch:B}),(0,S.jsx)(h.Z,{title:k("add.subcategory"),visible:R,onCancel:function(){M(null)},centered:!0,footer:null,destroyOnClose:!0,children:(0,S.jsx)(L,{setId:M,id:R,setIsRefetch:T,parent:{parent_id:{label:C["title[".concat(X,"]")],value:null===C||void 0===C?void 0:C.id},id:null===C||void 0===C?void 0:C.id,type:null===C||void 0===C?void 0:C.type}})})]})}}}]);