"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[5764],{32380:(e,t,a)=>{a.d(t,{o:()=>r});var l=a(47313),i=a(84762),n=a(72652),s=a(46417);const r=e=>{let{fetchOptions:t,refetch:a=!1,...r}=e;const[d,u]=(0,l.useState)(!1),[o,c]=(0,l.useState)([]);return(0,s.jsx)(i.Z,{treeLine:!0,treeData:d?[]:o,treeDefaultExpandAll:!0,labelInValue:!0,onFocus:()=>{o.length&&!a||(u(!0),t().then((e=>{c(e),u(!1)})))},notFoundContent:d?(0,s.jsx)(n.Z,{size:"small"}):"no results",...r})}},73431:(e,t,a)=>{a.d(t,{Z:()=>u});var l=a(47313),i=a(39180),n=a(2717),s=a(28830),r=a(60535),d=a(46417);const u=()=>{const e=(0,n.I0)(),{languages:t,defaultLang:a}=(0,n.v9)((e=>e.formLang),n.wU);(0,l.useEffect)((()=>{r.Z.getAllActive().then((t=>{let{data:a}=t;e((0,s.dc)(a)),e((0,s.mh)(a.find((e=>1===e.default)).locale))}))}),[]);return(0,d.jsx)(d.Fragment,{children:(0,d.jsx)(i.ZP.Group,{value:a,onChange:t=>{let{target:{value:a}}=t;e((0,s.mh)(a))},className:"float-right",buttonStyle:"solid",children:null===t||void 0===t?void 0:t.map((e=>(0,d.jsx)(i.ZP.Button,{value:e.locale,children:e.title},e.id)))})})}},85764:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S});var l=a(47313),i=a(10976),n=a(77181),s=a(68197),r=a(16124),d=a(59624),u=a(66672),o=a(74294),c=a(86345),m=a(59491),p=a(72652),v=a(23560),h=a(97890),g=a(73431),x=a(52421),j=a(2717),Z=a(90954),y=a(47647),f=a(97421),b=a(24511),w=a(5764),I=a(81218),k=a(42472),_=a(32380),q=a(46417);const S=()=>{var e,t;const{t:a}=(0,b.$)(),S=(0,h.s0)(),F=(0,j.I0)(),[L,U]=(0,l.useState)("main"),{activeMenu:C}=(0,j.v9)((e=>e.menu),j.wU),{params:V}=(0,j.v9)((e=>e.requestModels),j.wU),{user:z}=(0,j.v9)((e=>e.auth),j.wU),{state:A}=(0,h.TH)(),[N,P]=(0,l.useState)(!1),[E,O]=(0,l.useState)(null!==(e=C.data)&&void 0!==e&&e.image?[null===(t=C.data)||void 0===t?void 0:t.image]:[]),[M]=i.Z.useForm(),[B,D]=(0,l.useState)(!1),[T,$]=(0,l.useState)(null),{uuid:G}=(0,h.UO)(),{defaultLang:H,languages:J}=(0,j.v9)((e=>e.formLang),j.wU);(0,l.useEffect)((()=>()=>{const e=M.getFieldsValue(!0);F((0,Z.nc)({activeMenu:C,data:e})),F((0,k.z$)({...V,type:L,parent_id:null===A||void 0===A?void 0:A.parentId,shop_id:null===z||void 0===z?void 0:z.shop_id}))}),[]);const K=e=>({name:e,url:f.bV+e}),Q=e=>Object.assign({},...e);(0,l.useEffect)((()=>{var e;e=G,P(!0),y.Z.getById(e).then((e=>{var t,a;let l=e.data;const i={...l,title:Q(l.translations.map((e=>({[e.locale]:e.title})))),description:Q(l.translations.map((e=>({[e.locale]:e.description})))),image:[K(l.img)],keywords:l.keywords.split(","),id:l.id,parent_id:{label:null===(t=l.parent)||void 0===t||null===(a=t.translation)||void 0===a?void 0:a.title,value:l.parent_id,key:l.parent_id},input:(null===l||void 0===l?void 0:l.input)||0};M.setFieldsValue(i),O([K(l.img)])})).finally((()=>{P(!1),F((0,Z.A_)(C))}))}),[C.refetch,G,null===A||void 0===A?void 0:A.parentId]);return(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(n.Z,{title:null!==A&&void 0!==A&&A.parentId?a("edit.sub.category"):a("edit.category"),extra:(0,q.jsx)(g.Z,{}),children:N?(0,q.jsx)("div",{className:"d-flex justify-content-center align-items-center py-5",children:(0,q.jsx)(p.Z,{size:"large",className:"mt-5 pt-5"})}):(0,q.jsxs)(i.Z,{name:"basic",layout:"vertical",onFinish:e=>{var t,l;D(!0);const i={id:e.id,type:"category",data:{...e,type:null!==(t=e.parent_id)&&void 0!==t&&t.value?L:"main",active:e.active?1:0,keywords:e.keywords.join(","),parent_id:null===(l=e.parent_id)||void 0===l?void 0:l.value,images:null===E||void 0===E?void 0:E.map((e=>e.name))}},n="seller/categories";I.Z.requestChange(i).then((()=>{v.Am.success(a("successfully.updated")),F((0,Z.ph)({...C,nextUrl:n})),F((0,Z.xo)(C)),S("/".concat(n),{state:{tab:"request"}})})).catch((e=>$(e.response.data.params))).finally((()=>D(!1)))},initialValues:{active:!0,...C.data},form:M,children:[(0,q.jsxs)(s.Z,{gutter:12,children:[(0,q.jsx)(i.Z.Item,{name:"id",hidden:!0,children:(0,q.jsx)(r.Z,{})}),(0,q.jsx)(d.Z,{span:12,children:J.map(((e,t)=>(0,q.jsx)(i.Z.Item,{label:a("name"),name:["title",e.locale],help:T&&T.title[H]?T.title[H][0]:null,validateStatus:T?"error":"success",rules:[{required:e.locale===H,message:a("required")}],hidden:e.locale!==H,children:(0,q.jsx)(u.Z,{})},e.title+t)))}),(0,q.jsx)(d.Z,{span:12,children:J.map(((e,t)=>(0,q.jsx)(i.Z.Item,{label:a("description"),name:["description",e.locale],rules:[{required:e.locale===H,message:a("required")}],hidden:e.locale!==H,children:(0,q.jsx)(x.Z,{rows:4})},e.locale+t)))}),(0,q.jsx)(d.Z,{span:12,children:(0,q.jsx)(i.Z.Item,{label:a("keywords"),name:"keywords",rules:[{required:!0,message:a("required")}],children:(0,q.jsx)(o.Z,{mode:"tags",style:{width:"100%"}})})}),(0,q.jsx)(d.Z,{span:12,children:(0,q.jsx)(i.Z.Item,{label:a("parent.category"),name:"parent_id",rules:[{required:!1,message:a("required")}],children:(0,q.jsx)(_.o,{fetchOptions:async function(){const{id:e}=M.getFieldValue({});return y.Z.selectPaginate({perPage:100,type:"main"}).then((t=>t.data.filter((t=>t.id!==e)).map((e=>{var t,a;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"main",children:null===(a=e.children)||void 0===a?void 0:a.map((e=>{var t,a;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,type:"sub_main",children:null===(a=e.children)||void 0===a?void 0:a.map((e=>{var t;return{label:null===(t=e.translation)||void 0===t?void 0:t.title,value:e.id,key:e.id,disabled:!0,type:"child"}}))}}))}}))))},onSelect:(e,t)=>{const{type:a}=t||{};U("main"===a?"sub_main":"sub_main"===a?"child":"main")},allowClear:!0})})}),(0,q.jsx)(d.Z,{span:12,children:(0,q.jsx)(i.Z.Item,{name:"input",label:a("input"),rules:[{required:!0,message:a("required")}],children:(0,q.jsx)(r.Z,{min:0,parser:e=>parseInt(e,10),max:32767,className:"w-100"})})}),(0,q.jsx)(d.Z,{span:4,children:(0,q.jsx)(i.Z.Item,{label:a("image"),children:(0,q.jsx)(w.Z,{type:"categories",imageList:E,setImageList:O,form:M,multiple:!1})})}),(0,q.jsx)(d.Z,{span:2,children:(0,q.jsx)(i.Z.Item,{label:a("active"),name:"active",valuePropName:"checked",children:(0,q.jsx)(c.Z,{})})})]}),(0,q.jsx)(m.Z,{type:"primary",htmlType:"submit",loading:B,children:a("submit")})]})})})}}}]);