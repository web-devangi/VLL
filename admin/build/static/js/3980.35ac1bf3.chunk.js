"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[3980],{13622:function(e,n,t){t.d(n,{R:function(){return p}});var i=t(1413),l=t(29439),a=t(45987),r=t(47313),o=t(12279),u=t.n(o),d=t(74294),s=t(72652),c=t(46417),v=["fetchOptions","debounceTimeout","refetch"],p=function(e){var n=e.fetchOptions,t=e.debounceTimeout,o=void 0===t?400:t,p=e.refetch,m=void 0!==p&&p,f=(0,a.Z)(e,v),x=(0,r.useState)(!1),Z=(0,l.Z)(x,2),h=Z[0],j=Z[1],g=(0,r.useState)([]),y=(0,l.Z)(g,2),b=y[0],k=y[1],w=(0,r.useMemo)((function(){return u()((function(e){k([]),j(!0),n(e).then((function(e){k(e),j(!1)}))}),o)}),[n,o]);return(0,c.jsx)(d.Z,(0,i.Z)((0,i.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,onClear:function(){return w("")},filterOption:!1,onSearch:w,notFoundContent:h?(0,c.jsx)(s.Z,{size:"small"}):"no results"},f),{},{options:b,onFocus:function(){b.length&&!m||w("")}}))}},16190:function(e,n,t){t.d(n,{Z:function(){return b}});var i=t(93433),l=t(4942),a=t(1413),r=t(29439),o=t(47313),u=t(10976),d=t(9274),s=t(59491),c=t(66672),v=t(74294),p=t(24511),m=t(73431),f=t(2717),x=t(5170),Z=t(23560),h=t(97340),j=t(75336),g=t(51282),y=t(46417);function b(e){var n=e.modal,t=e.handleCancel,b=e.onSuccess,k=u.Z.useForm(),w=(0,r.Z)(k,1)[0],q=(0,p.$)().t,I=(0,f.I0)(),_=(0,o.useState)(!1),S=(0,r.Z)(_,2),C=S[0],F=S[1],N=(0,o.useState)(!1),O=(0,r.Z)(N,2),V=O[0],P=O[1],E=(0,f.v9)((function(e){return e.formLang}),f.wU),M=E.languages,A=E.defaultLang;function U(e){P(!0),x.Z.getGroupById(e).then((function(e){var n=e.data;w.setFieldsValue((0,a.Z)((0,a.Z)({},n),function(e){if(!e)return{};var n=e.translations,t=M.map((function(e){var t;return(0,l.Z)({},"title[".concat(e.locale,"]"),null===(t=n.find((function(n){return n.locale===e.locale})))||void 0===t?void 0:t.title)}));return Object.assign.apply(Object,[{}].concat((0,i.Z)(t)))}(n)))})).finally((function(){return P(!1)}))}(0,o.useEffect)((function(){null!==n&&void 0!==n&&n.id&&U(n.id)}),[n]);return(0,y.jsx)(d.Z,{title:null!==n&&void 0!==n&&n.id?q("edit.extra.group"):q("add.extra.group"),visible:!!n,onCancel:t,footer:[(0,y.jsx)(s.Z,{type:"primary",onClick:function(){return w.submit()},loading:C,children:q("save")},"save-button-group"),(0,y.jsx)(s.Z,{type:"default",onClick:t,children:q("cancel")},"cancel-button-group")],children:V?(0,y.jsx)(g.Z,{}):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"d-flex justify-content-end",children:(0,y.jsx)(m.Z,{})}),(0,y.jsxs)(u.Z,{layout:"vertical",name:"extra-group",form:w,onFinish:function(e){var i={title:(0,j.Z)(M,e),type:null===e||void 0===e?void 0:e.type};null!==n&&void 0!==n&&n.id?function(e,n){F(!0),x.Z.updateGroup(e,n).then((function(){Z.Am.success(q("successfully.updated")),I((0,h.gw)()),t()})).finally((function(){return F(!1)}))}(null===n||void 0===n?void 0:n.id,i):function(e){F(!0),x.Z.createGroup(e).then((function(){Z.Am.success(q("successfully.created")),t(),I((0,h.gw)()),b&&b()})).finally((function(){return F(!1)}))}(i)},children:[M.map((function(e){return(0,y.jsx)(u.Z.Item,{rules:[{required:e.locale===A,message:q("required")}],name:"title[".concat(e.locale,"]"),label:q("title"),hidden:e.locale!==A,children:(0,y.jsx)(c.Z,{placeholder:q("title")})},"title"+e.locale)})),(0,y.jsx)(u.Z.Item,{name:"type",label:q("type"),rules:[{required:!0,message:q("required")}],children:(0,y.jsxs)(v.Z,{style:{width:"100%"},placeholder:q("select.extra.type"),children:[(0,y.jsx)(v.Z.Option,{value:"color",children:q("color")}),(0,y.jsx)(v.Z.Option,{value:"text",children:q("text")})]})})]})]})})}},21726:function(e,n,t){t.d(n,{Z:function(){return j}});var i=t(29439),l=t(10976),a=t(66672),r=t(9274),o=t(59491),u=t(47313),d=t(8922),s=t(24511),c=t(2717),v=t(23560),p=t(20503),m=t(8550),f=t(34319),x=t(5170),Z=t(89281),h=t(46417);function j(e){var n,t,j,g,y=e.modal,b=e.handleCancel,k=e.isVisible,w=e.paramsData,q=l.Z.useForm(),I=(0,i.Z)(q,1)[0],_=(0,s.$)().t,S=(0,c.I0)(),C=(0,u.useState)(!1),F=(0,i.Z)(C,2),N=F[0],O=F[1],V=(0,u.useState)("text"),P=(0,i.Z)(V,2),E=P[0],M=P[1],A=(0,u.useState)(null),U=(0,i.Z)(A,2),L=U[0],G=U[1],T=(0,u.useState)(""),R=(0,i.Z)(T,2),W=R[0],$=R[1];(0,u.useEffect)((function(){if(null!==y&&void 0!==y&&y.id){switch(M(y.group.type),y.group.type){case"color":$(y.value);break;case"image":G((0,m.Z)(y.value))}I.setFieldsValue(y)}}),[y]);function B(e,n){switch(e){case"color":return n.hex;case"text":return n;case"image":return n.name;default:return""}}return(0,h.jsx)(r.Z,{title:null!==y&&void 0!==y&&y.id?_("edit.extra"):_("add.extra"),visible:k,onCancel:b,footer:[(0,h.jsx)(o.Z,{type:"primary",onClick:function(){return I.submit()},loading:N,children:_("save")}),(0,h.jsx)(o.Z,{type:"default",onClick:b,children:_("cancel")})],children:(0,h.jsxs)(l.Z,{name:"extra-form",layout:"vertical",form:I,onFinish:function(e){var n,t,i={extra_group_id:null!==(n=e.extra_group_id.value)&&void 0!==n?n:e.extra_group_id,value:null!==(t=B(E,e.value))&&void 0!==t?t:e.value};null!==y&&void 0!==y&&y.id?function(e,n){O(!0),x.Z.updateValue(e,n).then((function(){v.Am.success(_("successfully.updated")),b(),S((0,f.pZ)(w))})).finally((function(){O(!1),I.resetFields()}))}(null===y||void 0===y?void 0:y.id,i):function(e){O(!0),x.Z.createValue(e).then((function(){v.Am.success(_("successfully.created")),b(),S((0,f.pZ)(w))})).finally((function(){O(!1),I.resetFields()}))}(i)},initialValues:{extra_group_id:null!==y&&void 0!==y&&y.group?{label:null===y||void 0===y||null===(n=y.group)||void 0===n||null===(t=n.translation)||void 0===t?void 0:t.title,value:null===y||void 0===y||null===(j=y.group)||void 0===j?void 0:j.id,key:null===y||void 0===y||null===(g=y.group)||void 0===g?void 0:g.id}:[]},children:[(0,h.jsx)(l.Z.Item,{name:"extra_group_id",label:_("extra.group"),rules:[{required:!0,message:"required"}],children:(0,h.jsx)(Z.h,{fetchOptions:function(e){var n={perPage:10,page:1,search:e};return x.Z.getAllGroups(n).then((function(e){return e.data.map((function(e){var n;return{label:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title,value:null===e||void 0===e?void 0:e.id,key:"".concat(null===e||void 0===e?void 0:e.type,",").concat(null===e||void 0===e?void 0:e.id)}}))}))},placeholder:_("select.extra.group"),allowClear:!0,onChange:function(e){var n;M(null===e||void 0===e||null===(n=e.key)||void 0===n?void 0:n.split(",")[0]),I.setFieldsValue({value:""})}})}),(0,h.jsx)(l.Z.Item,{name:"value",label:_("value"),rules:[{required:!0,message:"required"}],children:function(e){switch(e){case"color":return(0,h.jsx)(d.xS,{onChangeComplete:function(e){return $(e.hex)},color:W,disableAlpha:!0});case"text":return(0,h.jsx)(a.Z,{placeholder:_("enter.extra.value")});case"image":return(0,h.jsx)(p.Z,{type:"extras",image:L,setImage:G,form:I,name:"value"});default:return""}}(E)})]})})}},47668:function(e,n,t){t.d(n,{Z:function(){return P}});var i=t(93433),l=t(1413),a=t(29439),r=t(47313),o=t(77181),u=t(10976),d=t(45705),s=t(59491),c=t(2717),v=t(90954),p=t(24511),m=t(97890),f=t(23560),x=t(3394),Z=t(9274),h=t(66672),j=t(42346),g=t(66204),y=t(5170),b=t(16190),k=t(82138),w=t(71136),q=t(46417),I=function(e){var n=e.open,t=e.onClose,i=e.selectedExtras,o=e.onSelect,u=(0,p.$)().t,d=(0,r.useState)([]),c=(0,a.Z)(d,2),v=c[0],m=c[1],f=(0,r.useState)(!1),x=(0,a.Z)(f,2),I=x[0],_=x[1],S=(0,r.useState)(!1),C=(0,a.Z)(S,2),F=C[0],N=C[1],O=(0,r.useState)(""),V=(0,a.Z)(O,2),P=V[0],E=V[1],M=(0,w.Z)(P,500),A=function(e){_(!0);var n={valid:1,perPage:100,search:e};y.Z.getAllGroups(n).then((function(e){var n=e.data.map((function(e){var n;return{id:e.id,label:null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id,shop_id:e.shop_id,group:(0,l.Z)({},e)}}));m(n)})).finally((function(){return _(!1)}))};return(0,r.useEffect)((function(){n&&A(M)}),[n,M]),(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(Z.Z,{visible:n,onCancel:function(){t(),E("")},footer:null,children:[(0,q.jsx)(h.Z,{className:"mt-3",value:P,onChange:function(e){return E(e.target.value)}}),(0,q.jsx)(j.ZP,{loading:I,dataSource:v.filter((function(e){return!(null!==i&&void 0!==i&&i.some((function(n){return n.id===e.id})))})),renderItem:function(e){return(0,q.jsx)(j.ZP.Item,{extra:null!==e&&void 0!==e&&e.shop_id?null:(0,q.jsx)(g.Z,{children:u("admin")}),style:{cursor:"pointer"},onClick:function(){o(e)},children:e.label})},footer:I?null:(0,q.jsx)(s.Z,{type:"link",onClick:function(){return N(!0)},style:{paddingLeft:0},icon:(0,q.jsx)(k.Z,{}),children:u("add.new.extra")})})]}),(0,q.jsx)(b.Z,{modal:F,handleCancel:function(){return N(!1)},onSuccess:function(){return A()}})]})},_=t(32697),S=t(98276),C=t(41068),F=t(21726),N=t(34273),O=t(7142),V=function(e){var n=e.extra,t=e.onClose,i=e.onSelect,l=(0,p.$)().t,o=(0,r.useState)(!1),u=(0,a.Z)(o,2),c=u[0],v=u[1],m=(0,r.useState)([]),f=(0,a.Z)(m,2),x=f[0],h=f[1],g=(0,r.useState)([]),b=(0,a.Z)(g,2),w=b[0],I=b[1],V=(0,r.useState)(!1),P=(0,a.Z)(V,2),E=P[0],M=P[1];function A(e){v(!0),y.Z.getGroupById(e).then((function(e){h(e.data.extra_values.map((function(e){return{label:e.value,value:e.id,group_type:e.group.type}})))})).finally((function(){v(!1)}))}return(0,r.useEffect)((function(){var e;null!==n&&void 0!==n&&n.value&&!E&&(A(n.value),I((null===n||void 0===n||null===(e=n.values)||void 0===e?void 0:e.map((function(e){return e.value})))||[]))}),[null===n||void 0===n?void 0:n.value,E]),(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(Z.Z,{visible:!!n,onCancel:t,footer:[(0,q.jsx)(s.Z,{onClick:t,children:l("cancel")}),!c&&x.length>0&&(0,q.jsx)(s.Z,{onClick:function(){var e=[];x.forEach((function(n){w.forEach((function(t){n.value===t&&e.push(n)}))})),i(null===n||void 0===n?void 0:n.value,e),t()},type:"primary",children:l("save")})],children:[(0,q.jsx)(O.ZP,{autoHide:!0,autoHeight:!0,autoHeightMin:"60vh",autoHeightMax:"60vh",children:(0,q.jsx)(_.Z.Group,{value:w,onChange:function(e){I(e)},className:"w-100",children:0!==(null===x||void 0===x?void 0:x.length)||c?(0,q.jsx)(j.ZP,{dataSource:x,loading:c,renderItem:function(e){return(0,q.jsx)(j.ZP.Item,{children:(0,q.jsx)(_.Z,{value:e.value,children:"color"===e.group_type?(0,q.jsxs)(d.Z,{size:"small",children:[(0,q.jsx)(C.Z,{className:"extras-color-badge",color:null===e||void 0===e?void 0:e.label}),(0,N.B)(null===e||void 0===e?void 0:e.label),(0,q.jsxs)("span",{children:["(",null===e||void 0===e?void 0:e.label,")"]})]}):(0,q.jsx)("span",{children:null===e||void 0===e?void 0:e.label})})})}}):(0,q.jsx)(S.Z,{})})}),c?null:(0,q.jsx)(s.Z,{type:"link",onClick:function(){return M(!0)},style:{paddingLeft:0},icon:(0,q.jsx)(k.Z,{}),children:l("add.new.extra")})]}),n&&(0,q.jsx)(F.Z,{isVisible:E,modal:{label:null===n||void 0===n?void 0:n.label,value:null===n||void 0===n?void 0:n.id,key:null===n||void 0===n?void 0:n.id},handleCancel:function(){return M(!1)},groupId:null===n||void 0===n?void 0:n.value,onSuccess:function(){return A(null===n||void 0===n?void 0:n.value)}})]})},P=function(e){var n,t=e.next,Z=e.prev,h=e.isRequest,j=(0,p.$)().t,g=(0,c.I0)(),y=(0,m.UO)(),b=(y.uuid,y.id),k=(0,m.s0)(),w=(0,c.v9)((function(e){return e.menu}),c.wU).activeMenu,_=(0,r.useState)(!1),S=(0,a.Z)(_,2),C=S[0],F=(S[1],(0,r.useState)(!1)),N=(0,a.Z)(F,2),O=N[0],P=N[1],E=(0,r.useState)((null===(n=w.data)||void 0===n?void 0:n.extras)||[]),M=(0,a.Z)(E,2),A=M[0],U=M[1],L=(0,r.useState)(null),G=(0,a.Z)(L,2),T=G[0],R=G[1],W=(0,r.useState)(!1),$=(0,a.Z)(W,2),B=$[0],z=$[1];return(0,q.jsx)(o.Z,{children:(0,q.jsxs)(u.Z,{layout:"vertical",initialValues:(0,l.Z)({},w.data),onFinish:function(){if(A.some((function(e){var n;return 0===(null===(n=e.values)||void 0===n?void 0:n.length)||!e.values})))f.Am.error(j("please.select.at.least.1.extra.value.for.each.extra"));else{if(A.map((function(e){return e.value})).sort((function(e,n){return e-n})),h)return g((0,v.nc)({activeMenu:w,data:(0,l.Z)((0,l.Z)({},w.data),{},{extras:A})})),void k("/product-request/".concat(b,"?step=2"),{state:{generate:B}});g((0,v.nc)({activeMenu:w,data:(0,l.Z)((0,l.Z)({},w.data),{},{extras:A})})),t()}},children:[(0,q.jsx)(I,{open:O,onClose:function(){return P(!1)},selectedExtras:A,onSelect:function(e){z(!0),U((function(n){return[].concat((0,i.Z)(n),[e])})),P(!1)}}),(0,q.jsx)(V,{extra:T,onClose:function(){return R(null)},onSelect:function(e,n){z(!0),U((function(t){return t.map((function(t){if(t.value===e){var i=n.map((function(e){var n,t,i=null===(n=w.data)||void 0===n||null===(t=n.extras)||void 0===t?void 0:t.flatMap((function(e){return e.values})).find((function(n){return n.value===e.value}));return(0,l.Z)((0,l.Z)({},e),{},{stock_id:null===i||void 0===i?void 0:i.stock_id})}));return(0,l.Z)((0,l.Z)({},t),{},{values:i})}return t}))}))}}),(0,q.jsx)(d.Z,{className:"w-100",size:"middle",direction:"vertical",children:A.map((function(e){var n;return(0,q.jsxs)(d.Z,{className:"w-100",direction:"vertical",children:[(0,q.jsxs)(d.Z,{className:"w-100",wrap:!0,children:[(0,q.jsx)(s.Z,{onClick:function(){return R(e)},ghost:!0,type:"primary",children:null===e||void 0===e?void 0:e.label}),null===e||void 0===e||null===(n=e.values)||void 0===n?void 0:n.map((function(n){return(0,q.jsxs)("div",{className:"extra-value",children:[null===n||void 0===n?void 0:n.label," ",(0,q.jsx)("button",{onClick:function(){return t=e.value,i=n.value,z(!0),void U((function(e){return e.map((function(e){return e.value===t?(0,l.Z)((0,l.Z)({},e),{},{values:(null===e||void 0===e?void 0:e.values.filter((function(e){return e.value!==i})))||[]}):e}))}));var t,i},type:"button",className:"extra-clear",children:(0,q.jsx)(x.IOM,{})})]},n.value)}))]}),(0,q.jsx)(d.Z,{className:"w-100",style:{justifyContent:"flex-end"},children:(0,q.jsx)(s.Z,{danger:!0,onClick:function(){return n=e,z(!0),void U((function(e){return e.filter((function(e){return e.id!==n.id}))}));var n},type:"text",children:j("delete")})})]},e.id)}))}),(0,q.jsx)(s.Z,{onClick:function(){return P(!0)},className:"w-100 my-3",type:"dashed",children:j("add.extra")}),(0,q.jsxs)(d.Z,{className:"mt-3",children:[(0,q.jsx)(s.Z,{onClick:Z,children:j("prev")}),(0,q.jsx)(s.Z,{type:"primary",htmlType:"submit",loading:C,children:j("next")})]})]})})}},78873:function(e,n,t){var i=t(1413),l=t(93433),a=t(4942),r=t(29439),o=t(47313),u=t(77181),d=t(83371),s=t(68197),c=t(59624),v=t(45705),p=t(59491),m=t(72652),f=t(2717),x=t(97890),Z=t(90954),h=t(95882),j=t(24511),g=t(17101),y=t(97421),b=t(23560),k=t(14349),w=t(46417);n.Z=function(e){var n,t,q,I,_,S,C,F,N,O,V,P,E,M=e.prev,A=e.isRequest,U=(0,j.$)().t,L=(0,f.v9)((function(e){return e.menu}),f.wU).activeMenu,G=(0,f.v9)((function(e){return e.formLang}),f.wU),T=G.defaultLang,R=G.languages,W=(0,x.s0)(),$=(0,f.I0)(),B=(0,o.useState)({}),z=(0,r.Z)(B,2),H=z[0],D=z[1],K=(0,o.useState)(null),X=(0,r.Z)(K,2),J=X[0],Q=X[1],Y=(0,x.UO)().uuid,ee=(0,o.useState)(!1),ne=(0,r.Z)(ee,2),te=ne[0],ie=ne[1];function le(e){Q(!0),g.Z.getById(e).then((function(e){var n=(0,i.Z)((0,i.Z)((0,i.Z)({},e.data),function(e){if(null===e||void 0===e||!e.translations)return{};var n=e.translations,t=R.map((function(e){var t,i,l;return l={},(0,a.Z)(l,"title[".concat(e.locale,"]"),null===(t=n.find((function(n){return n.locale===e.locale})))||void 0===t?void 0:t.title),(0,a.Z)(l,"description[".concat(e.locale,"]"),null===(i=n.find((function(n){return n.locale===e.locale})))||void 0===i?void 0:i.description),l}));return Object.assign.apply(Object,[{}].concat((0,l.Z)(t)))}(e.data)),{},{properties:e.data.properties.map((function(e,n){var t;return t={id:n},(0,a.Z)(t,"key[".concat(e.locale,"]"),e.key),(0,a.Z)(t,"value[".concat(e.locale,"]"),e.value),t})),translation:void 0,translations:void 0});D(n)})).finally((function(){return Q(!1)}))}(0,o.useEffect)((function(){A||le(Y)}),[A]);var ae=L.data,re=A?L.data.model:H;return J?(0,w.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,w.jsx)(m.Z,{size:"large",className:"py-5"})}):(0,w.jsxs)(u.Z,{children:[A&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(d.Z,{bordered:!0,title:U("changed.info"),children:[(0,w.jsx)(d.Z.Item,{label:"".concat(U("title")," (").concat(T,")"),span:3,children:ae["title[".concat(T,"]")]}),(0,w.jsx)(d.Z.Item,{label:"".concat(U("description")," (").concat(T,")"),span:3,children:ae["description[".concat(T,"]")]}),(0,w.jsx)(d.Z.Item,{label:U("shop"),span:1.5,children:null===ae||void 0===ae||null===(n=ae.shop)||void 0===n?void 0:n.translation.title}),(0,w.jsx)(d.Z.Item,{label:U("category"),span:1.5,children:null===ae||void 0===ae||null===(t=ae.category)||void 0===t?void 0:t.label}),(0,w.jsx)(d.Z.Item,{label:U("brand"),span:1.5,children:null===ae||void 0===ae||null===(q=ae.brand)||void 0===q?void 0:q.label}),(0,w.jsx)(d.Z.Item,{label:U("unit"),span:1.5,children:null===ae||void 0===ae||null===(I=ae.unit)||void 0===I?void 0:I.label}),(0,w.jsx)(d.Z.Item,{label:U("images"),span:3,children:(0,w.jsx)(s.Z,{gutter:12,children:null===ae||void 0===ae||null===(_=ae.images)||void 0===_?void 0:_.filter((function(e){return!e.isVideo})).map((function(e,n){return(0,w.jsx)(c.Z,{children:(0,w.jsx)("img",{width:80,alt:"product",src:e.url})},"image"+n)}))})}),(0,w.jsx)(d.Z.Item,{label:U("tax"),children:(null===ae||void 0===ae?void 0:ae.tax)||0}),(0,w.jsx)(d.Z.Item,{label:U("min.quantity"),children:null===ae||void 0===ae?void 0:ae.min_qty}),(0,w.jsx)(d.Z.Item,{label:U("max.quantity"),children:null===ae||void 0===ae?void 0:ae.max_qty})]}),null===ae||void 0===ae?void 0:ae.stocks.map((function(e,n){var t;return e?(0,w.jsxs)(d.Z,{bordered:!0,className:"mt-4",children:[(0,w.jsx)(d.Z.Item,{label:U("price"),span:2,children:e.price}),(0,w.jsx)(d.Z.Item,{label:U("quantity"),span:2,children:e.quantity}),null===e||void 0===e||null===(t=e.ids)||void 0===t?void 0:t.map((function(e,n){return(0,w.jsx)(d.Z.Item,{label:null===ae||void 0===ae?void 0:ae.extras[n].label,children:null===e||void 0===e?void 0:e.label},"extra"+n)}))]},"desc"+n):""}))]}),(0,w.jsxs)(d.Z,{bordered:!0,className:"mt-4",title:U("original.info"),children:[(0,w.jsx)(d.Z.Item,{label:"".concat(U("title")," (").concat(T,")"),span:3,column:3,children:(null===(S=re.translation)||void 0===S?void 0:S.title)||re["title[".concat(T,"]")]}),(0,w.jsx)(d.Z.Item,{label:"".concat(U("description")," (").concat(T,")"),span:3,column:3,children:(null===re||void 0===re||null===(C=re.translation)||void 0===C?void 0:C.description)||re["description[".concat(T,"]")]}),(0,w.jsx)(d.Z.Item,{label:U("shop"),span:1.5,column:1.5,children:null===(F=re.shop)||void 0===F?void 0:F.translation.title}),(0,w.jsx)(d.Z.Item,{label:U("category"),span:1.5,column:1.5,children:null===(N=re.category)||void 0===N?void 0:N.translation.title}),(0,w.jsx)(d.Z.Item,{label:U("brand"),span:1.5,column:1.5,children:null===(O=re.brand)||void 0===O?void 0:O.title}),(0,w.jsx)(d.Z.Item,{label:U("unit"),span:1.5,column:1.5,children:null===(V=re.unit)||void 0===V?void 0:V.translation.title}),(0,w.jsx)(d.Z.Item,{label:U("images"),span:3,column:3,children:(0,w.jsx)(s.Z,{gutter:12,children:null===re||void 0===re||null===(P=re.galleries)||void 0===P?void 0:P.filter((function(e){return!e.preview})).map((function(e,n){return(0,w.jsx)(c.Z,{children:(0,w.jsx)("img",{width:80,alt:"product",src:y.bV+e.path})},"image"+n)}))})}),(0,w.jsx)(d.Z.Item,{span:3,column:3,label:U("tax"),children:re.tax||0}),(0,w.jsx)(d.Z.Item,{span:3,column:3,label:U("min.quantity"),children:re.min_qty}),(0,w.jsx)(d.Z.Item,{span:3,column:3,label:U("max.quantity"),children:re.max_qty})]}),null===(E=re.stocks)||void 0===E?void 0:E.map((function(e,n){return e?(0,w.jsxs)(d.Z,{bordered:!0,className:"mt-4",children:[(0,w.jsx)(d.Z.Item,{label:U("price"),span:2,column:2,children:e.price}),(0,w.jsx)(d.Z.Item,{label:U("quantity"),span:2,column:2,children:e.quantity}),e.extras.map((function(e,n){var t,i,l;return(0,w.jsx)(d.Z.Item,{label:null===e||void 0===e||null===(t=e.group)||void 0===t||null===(i=t.translation)||void 0===i?void 0:i.title,span:2,column:2,children:null===e||void 0===e||null===(l=e.value)||void 0===l?void 0:l.value},"extra"+n)}))]},"desc"+n):""})),(0,w.jsx)("div",{className:"d-flex justify-content-end mt-4",children:(0,w.jsxs)(v.Z,{children:[(0,w.jsx)(p.Z,{onClick:M,children:U("prev")}),(0,w.jsx)(p.Z,{loading:te,type:"primary",onClick:function(){var e={status:void 0},n="catalog/products";if(A&&L.data){ie(!0);var t={id:L.data.model_id,type:"product",data:L.data};k.Z.requestChangeUpdate(L.data.request_id,t).then((function(){W("/".concat(n),{state:{tab:"request"}}),b.Am.success(U("successfully.updated")),$((0,Z.ph)((0,i.Z)((0,i.Z)({},L),{},{nextUrl:n})))})).finally((function(){ie(!1)}))}else $((0,Z.ph)((0,i.Z)((0,i.Z)({},L),{},{nextUrl:n}))),$((0,h.t2)(e)),W("/".concat(n))},children:U("finish")})]})})]})}},35321:function(e,n,t){t(15861);var i=t(93433),l=t(1413),a=t(29439),r=(t(87757),t(47313)),o=t(10976),u=t(45705),d=t(55291),s=t(9274),c=t(77181),v=t(68197),p=t(59624),m=t(59491),f=t(78508),x=t(47515),Z=t(2717),h=t(90954),j=t(17101),g=t(24511),y=t(97890),b=t(55940),k=t(13966),w=t(89281),q=t(46417);n.Z=function(e){var n=e.next,t=e.prev,I=o.Z.useForm(),_=(0,a.Z)(I,1)[0],S=(0,g.$)().t,C=(0,Z.I0)(),F=(0,y.UO)().uuid,N=(0,Z.v9)((function(e){return e.menu}),Z.wU).activeMenu,O=(0,r.useState)([]),V=(0,a.Z)(O,2),P=V[0],E=V[1],M=(0,r.useState)(!1),A=(0,a.Z)(M,2),U=A[0],L=A[1],G=(0,r.useState)(!1),T=(0,a.Z)(G,2),R=T[0],W=T[1],$=(0,r.useState)(null),B=(0,a.Z)($,2),z=B[0],H=B[1],D=[{key:"2",title:S("property.group"),dataIndex:"group",render:function(e,n){var t;return(null===e||void 0===e||null===(t=e.translation)||void 0===t?void 0:t.title)||"-"}},{key:"4",title:S("property.value"),dataIndex:"value",render:function(e,n){return(null===e||void 0===e?void 0:e.value)||"-"}},{key:"5",title:S("options"),render:function(e){return(0,q.jsx)(u.Z,{children:(0,q.jsx)(b.Z,{type:"primary",danger:!0,icon:(0,q.jsx)(x.Z,{}),onClick:function(){return X(e)}})})}}];(0,r.useEffect)((function(){if(P.length&&F){var e=P;C((0,h.nc)({activeMenu:N,data:(0,l.Z)((0,l.Z)({},N.data),{},{properties:e})}))}}),[P]);var K=function(e){j.Z.properties(F,{properties:e}).then((function(){d.ZP.success(S("product.properties.saved")),J(F)})).finally((function(){return L(!1)}))},X=function(e){s.Z.confirm({title:S("delete.product"),okText:S("yes"),okType:"danger",onOk:function(){var n,t=null===P||void 0===P||null===(n=P.filter((function(n){return n.id!==e.id})))||void 0===n?void 0:n.map((function(e){var n;return null===e||void 0===e||null===(n=e.value)||void 0===n?void 0:n.id}));K(t)}})},J=function(e){W(!0),j.Z.getById(e).then((function(e){var n,t=e.data;E(null===t||void 0===t||null===(n=t.properties)||void 0===n?void 0:n.filter((function(e){return null===e||void 0===e?void 0:e.value}))),_.resetFields()})).catch((function(e){console.log(e)})).finally((function(){W(!1)}))};(0,r.useEffect)((function(){F&&J(F)}),[]);return(0,q.jsxs)(c.Z,{children:[(0,q.jsx)(o.Z,{name:"property-form",layout:"vertical",form:_,onFinish:function(e){L(!0);var n=e.propertyValue.map((function(e){return e.value})),t=null===P||void 0===P?void 0:P.map((function(e){var n;return null===e||void 0===e||null===(n=e.value)||void 0===n?void 0:n.id})),a=new Set([].concat((0,i.Z)(n),(0,i.Z)(t))),r=Array.from(a);K((0,l.Z)({},r))},children:(0,q.jsxs)(v.Z,{gutter:24,className:"mb-3",style:{display:"flex",alignItems:"center"},children:[(0,q.jsx)(p.Z,{span:10,children:(0,q.jsx)(o.Z.Item,{name:"propertyGroup",label:S("property.group"),rules:[{required:!0,message:S("required")}],children:(0,q.jsx)(w.h,{fetchOptions:function(e){var n={search:e,perPage:10,page:1};return k.Z.getAllGroups(n).then((function(e){return e.data.map((function(e){var n;return{label:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},placeholder:S("select.group"),onSelect:function(e){H(e),_.setFieldsValue({propertyValue:[]})},onClear:function(){H(null),_.setFieldsValue({propertyValue:[]})}})})}),(0,q.jsx)(p.Z,{span:10,children:(0,q.jsx)(o.Z.Item,{name:"propertyValue",label:S("property.value"),rules:[{required:!0,message:S("required")}],children:(0,q.jsx)(w.h,{fetchOptions:function(e){var n={search:e,perPage:10,page:1,group_id:null===z||void 0===z?void 0:z.value};return k.Z.getAllValues(n).then((function(e){return e.data.map((function(e){return{label:null===e||void 0===e?void 0:e.value,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))},placeholder:S("select.value"),refetchOptions:!0,disabled:!z,mode:"multiple"})})}),(0,q.jsx)(p.Z,{span:4,children:(0,q.jsx)(m.Z,{type:"primary",htmlType:"submit",loading:U,children:S("save")})})]})}),(0,q.jsx)(f.Z,{scroll:{x:!0},columns:D,dataSource:P,pagination:!1,rowKey:function(e){return e.id},loading:R}),(0,q.jsxs)(u.Z,{className:"mt-4",children:[(0,q.jsx)(m.Z,{onClick:t,children:S("prev")}),(0,q.jsx)(m.Z,{type:"primary",onClick:n,children:S("next")})]})]})}},8597:function(e,n,t){var i=t(4942),l=t(93433),a=t(1413),r=t(29439),o=t(47313),u=t(10976),d=t(77181),s=t(46155),c=t(68197),v=t(59624),p=t(66672),m=t(59491),f=t(16124),x=t(45705),Z=t(2717),h=t(85104),j=t(47515),g=t(17101),y=t(5170),b=t(24511),k=t(97890),w=t(51282),q=t(33724),I=t(90954),_=t(89802),S=t(37630),C=t(46417);n.Z=function(e){var n,t=e.prev,F=e.next,N=e.isRequest,O=(0,b.$)().t,V=u.Z.useForm(),P=(0,r.Z)(V,1)[0],E=(0,k.UO)().uuid,M=(0,Z.v9)((function(e){return e.menu}),Z.wU).activeMenu,A=(0,o.useState)(null),U=(0,r.Z)(A,2),L=U[0],G=U[1],T=(0,o.useState)(null),R=(0,r.Z)(T,2),W=R[0],$=R[1],B=(0,o.useState)([]),z=(0,r.Z)(B,2),H=z[0],D=z[1],K=(0,Z.I0)(),X=(0,k.TH)(),J=(0,Z.v9)((function(e){return e.formLang}),Z.wU).defaultLang,Q=(0,Z.v9)((function(e){return e.currency}),Z.wU).defaultCurrency;(0,o.useEffect)((function(){var e;if(N)if(null!==(e=X.state)&&void 0!==e&&e.generate){var n,t,r,o,u,d,s=null!==M&&void 0!==M&&M.data.extras?(0,q.Z)(null===M||void 0===M||null===(n=M.data.extras)||void 0===n?void 0:n.map((function(e){return e.values||[]}))):[],c=s.map((function(e){var n,t;if(e.every((function(e){return"undefined"!==typeof e.stock_id}))){var r,o,u,d=null===(r=M.data)||void 0===r||null===(o=r.actualStocks)||void 0===o?void 0:o.find((function(n){return n.extras.every((function(n){return e.some((function(e){var t;return e.value===(null===n||void 0===n||null===(t=n.value)||void 0===t?void 0:t.id)}))}))}));return(0,a.Z)({galleries:(null===d||void 0===d?void 0:d.galleries)||[],price:(null===d||void 0===d?void 0:d.price)||0,quantity:(null===d||void 0===d?void 0:d.quantity)||0,stock_id:null===d||void 0===d?void 0:d.id,tax:(null===M||void 0===M?void 0:M.data.tax)||0,addons:(null===d||void 0===d||null===(u=d.addons)||void 0===u?void 0:u.map((function(e){var n,t,i;return{label:(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(t=n.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.id)||(null===e||void 0===e?void 0:e.value)}})))||[]},Object.assign.apply(Object,[{}].concat((0,l.Z)(e.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value,group:M.data.extras[n].label})}))))))}return(0,a.Z)({price:0,quantity:0,tax:(null===(n=M.data)||void 0===n?void 0:n.tax)||0,sku:null===M||void 0===M||null===(t=M.data)||void 0===t?void 0:t.sku,addons:[]},Object.assign.apply(Object,[{}].concat((0,l.Z)(e.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value})}))))))})),v=[];if(0===s.length&&0!==(null===(t=M.data)||void 0===t||null===(r=t.actualStocks)||void 0===r?void 0:r.length)){var p,m,f,x=null===(p=M.data.actualStocks)||void 0===p?void 0:p.at(0);v=[{price:(null===x||void 0===x?void 0:x.price)||0,quantity:(null===x||void 0===x?void 0:x.quantity)||0,sku:null===x||void 0===x?void 0:x.sku,tax:(null===(m=M.data)||void 0===m?void 0:m.tax)||0,addons:x?null===(f=x.addons)||void 0===f?void 0:f.map((function(e){var n,t,i;return{label:(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(t=n.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.id)||(null===e||void 0===e?void 0:e.value)}})):[]}]}if(0===s.length&&0===(null===M||void 0===M||null===(o=M.data)||void 0===o||null===(u=o.actualStocks)||void 0===u?void 0:u.length))v=[{price:void 0,quantity:0,sku:null===M||void 0===M?void 0:M.data.sku,tax:(null===(d=M.data)||void 0===d?void 0:d.tax)||0,addons:[]}];var Z=v.concat(c);D(M.data.actualStocks.map((function(e){return e.id}))),P.setFieldsValue({stocks:Z})}else{var h,j,y=null===(h=M.data.stocks)||void 0===h?void 0:h.map((function(e){return(0,a.Z)((0,a.Z)({galleries:(null===e||void 0===e?void 0:e.galleries)||[],price:e.price,quantity:e.quantity,tax:M.data.tax,stock_id:e.stock_id,sku:e.sku},Object.assign.apply(Object,[{}].concat((0,l.Z)(e.ids.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value,group:e.group})})))))),{},{addons:e.addons})}));D((null===(j=M.data)||void 0===j?void 0:j.delete_ids)||[]),P.setFieldsValue({stocks:y})}else!function(e){$(!0),g.Z.getById(e).then((function(e){var n,t,r,o,u,d,s,c=null!==M&&void 0!==M&&null!==(n=M.data)&&void 0!==n&&n.extras?(0,q.Z)(null===M||void 0===M||null===(t=M.data)||void 0===t||null===(r=t.extras)||void 0===r?void 0:r.map((function(e){return(null===e||void 0===e?void 0:e.values)||[]}))):[],v=c.map((function(n){var t,r;if(n.every((function(e){return"undefined"!==typeof e.stock_id}))){var o,u,d,s=e.data.stocks.find((function(e){return e.extras.every((function(e){return n.some((function(n){var t;return n.value===(null===e||void 0===e||null===(t=e.value)||void 0===t?void 0:t.id)}))}))}));return(0,a.Z)({galleries:(null===s||void 0===s?void 0:s.galleries)||[],price:(null===s||void 0===s?void 0:s.price)||0,quantity:(null===s||void 0===s?void 0:s.quantity)||0,sku:null!==(o=null===(u=M.data)||void 0===u?void 0:u.sku)&&void 0!==o?o:null===s||void 0===s?void 0:s.sku,stock_id:null===s||void 0===s?void 0:s.id,tax:(null===M||void 0===M?void 0:M.data.tax)||0,addons:(null===s||void 0===s||null===(d=s.addons)||void 0===d?void 0:d.map((function(e){var n,t,i;return{label:(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(t=n.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.id)||(null===e||void 0===e?void 0:e.value)}})))||[]},Object.assign.apply(Object,[{}].concat((0,l.Z)(n.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value})}))))))}return(0,a.Z)({price:0,quantity:0,sku:null===(t=M.data)||void 0===t?void 0:t.sku,tax:(null===(r=M.data)||void 0===r?void 0:r.tax)||0,addons:[]},Object.assign.apply(Object,[{}].concat((0,l.Z)(n.map((function(e,n){return(0,i.Z)({},"extras[".concat(n,"]"),{label:e.label,value:e.value})}))))))})),p=[];if(0===c.length&&0!==(null===(o=e.data.stocks)||void 0===o?void 0:o.length)){var m,f,x,Z,h,j=null===(m=e.data.stocks)||void 0===m?void 0:m.at(0);p=[{price:(null===j||void 0===j?void 0:j.price)||0,quantity:(null===j||void 0===j?void 0:j.quantity)||0,sku:null!==(f=null===(x=M.data)||void 0===x?void 0:x.sku)&&void 0!==f?f:null===j||void 0===j?void 0:j.sku,tax:(null===(Z=M.data)||void 0===Z?void 0:Z.tax)||0,addons:j?null===(h=j.addons)||void 0===h?void 0:h.map((function(e){var n,t,i;return{label:(null===e||void 0===e||null===(n=e.product)||void 0===n||null===(t=n.translation)||void 0===t?void 0:t.title)||(null===e||void 0===e?void 0:e.label),value:(null===e||void 0===e||null===(i=e.product)||void 0===i?void 0:i.id)||(null===e||void 0===e?void 0:e.value)}})):[]}]}0===c.length&&0===(null===(u=e.data.stocks)||void 0===u?void 0:u.length)&&(p=[{price:void 0,quantity:0,sku:null===(d=M.data)||void 0===d?void 0:d.sku,tax:(null===(s=M.data)||void 0===s?void 0:s.tax)||0,addons:[]}]);var g=p.concat(v);D(e.data.stocks.map((function(e){return e.id}))),P.setFieldsValue({stocks:g})})).finally((function(){$(!1)}))}(E)}),[N,null===(n=X.state)||void 0===n?void 0:n.generate]);var Y=function(e,n,t){return e.map((function(e){return Object.assign(e,(0,i.Z)({},n,t))}))},ee=function(e,n){var t=e?(0,S.Z)(6):n,i=P.getFieldsValue().stocks;P.setFieldsValue({"set.all.sku":t,stock:Y(i,"sku",t)})};return(0,C.jsx)(d.Z,{title:"".concat(O("product.name"),": ").concat(M.data["title[".concat(J,"]")]?'"'.concat(M.data["title[".concat(J,"]")],'"'):""),children:W?(0,C.jsx)(w.Z,{}):(0,C.jsxs)(u.Z,{layout:"vertical",form:P,onFinish:function(e){var n,t,i,l,r,o,u,d,s,c,v=e.stocks,p=H.filter((function(e,n){var t;return!(null===(t=v[n])||void 0===t||!t.stock_id)&&!v.some((function(n){return(null===n||void 0===n?void 0:n.stock_id)===e}))}));null===(n=M.data)||void 0===n||null===(t=n.extras)||void 0===t||!t.length?i=[{price:null===v||void 0===v||null===(l=v[0])||void 0===l?void 0:l.price,quantity:null===v||void 0===v||null===(r=v[0])||void 0===r?void 0:r.quantity,addons:null!==v&&void 0!==v&&null!==(o=v[0])&&void 0!==o&&o.addons?N?null===v||void 0===v||null===(u=v[0])||void 0===u?void 0:u.addons.map((function(e){return e})):null===v||void 0===v||null===(d=v[0])||void 0===d?void 0:d.addons.map((function(e){return null===e||void 0===e?void 0:e.value})):[],stock_id:null===v||void 0===v||null===(s=v[0])||void 0===s?void 0:s.stock_id,sku:null===v||void 0===v||null===(c=v[0])||void 0===c?void 0:c.sku,ids:[]}]:i=v.map((function(e){var n,t,i,l;return{galleries:e.galleries,price:e.price,quantity:e.quantity,sku:e.sku,ids:N?null===(n=M.data)||void 0===n?void 0:n.extras.map((function(n,t){return e["extras[".concat(t,"]")]})):null===(t=M.data)||void 0===t?void 0:t.extras.map((function(n,t){return e["extras[".concat(t,"]")].value})),addons:e.addons?N?null===(i=e.addons)||void 0===i?void 0:i.map((function(e){return e})):null===(l=e.addons)||void 0===l?void 0:l.map((function(e){return e.value})):[],stock_id:e.stock_id}}));if(N)return K((0,I.nc)({activeMenu:M,data:(0,a.Z)((0,a.Z)({},M.data),{},{stocks:i,delete_ids:p})})),void F();G(!0),g.Z.stocks(E,{extras:i,delete_ids:p}).then((function(e){var n=e.data.stocks,t=null===n||void 0===n?void 0:n.flatMap((function(e){return e.extras})),i=t.map((function(e){return(0,a.Z)((0,a.Z)({},e.value),{},{stock_id:e.stock_id,group_type:e.group.type})})),l=null===t||void 0===t?void 0:t.find((function(e){return"color"===e.group.type})),r={};n.forEach((function(e){e.extras.forEach((function(n){var t,i,l,a,o;n.extra_group_id in r?null!==(t=r[n.extra_group_id].values)&&void 0!==t&&t.some((function(e){var t;return e.value===(null===(t=n.value)||void 0===t?void 0:t.id)}))||null===(i=r[n.extra_group_id].values)||void 0===i||i.push({value:n.value.id,label:null===(l=n.value)||void 0===l?void 0:l.value,stock_id:e.id}):r[n.extra_group_id]={group:n.group,label:null===(a=n.group.translation)||void 0===a?void 0:a.title,value:n.extra_group_id,id:n.extra_group_id,stock_id:e.id,values:[{value:n.value.id,label:null===(o=n.value)||void 0===o?void 0:o.value,stock_id:e.id}]}}))})),K((0,I.nc)({activeMenu:M,data:(0,a.Z)((0,a.Z)({},M.data),{},{newExtras:[{group:null===l||void 0===l?void 0:l.group,values:i}],delete_ids:p,stocks:n,stocksData:n,extras:Object.values(r)})})),F()})).finally((function(){return G(!1)}))},children:[(0,C.jsx)(s.Z,{}),(0,C.jsx)("h2",{children:O("set.all.values")}),(0,C.jsxs)(c.Z,{gutter:12,align:"middle",children:[(0,C.jsx)(v.Z,{span:5,style:{marginRight:"10px"},children:(0,C.jsx)(u.Z.Item,{label:O("sku"),name:"set.all.sku",children:(0,C.jsx)(p.Z,{className:"w-100",onChange:function(e){return ee(!1,e.target.value)}})})}),(0,C.jsx)(v.Z,{children:(0,C.jsx)(u.Z.Item,{label:" ",name:"sku",children:(0,C.jsx)(m.Z,{icon:(0,C.jsx)(h.Z,{}),onClick:function(){return ee(!0)}})})}),(0,C.jsx)(v.Z,{span:4,children:(0,C.jsx)(u.Z.Item,{label:O("price"),name:"set.all.price",rules:[{type:"number",min:0,message:O("must.be.positive.number")}],children:(0,C.jsx)(f.Z,{className:"w-100",onChange:function(e){var n=P.getFieldsValue().stocks;P.setFieldsValue({stocks:Y(n,"price",e)})}})})}),(0,C.jsx)(v.Z,{span:4,children:(0,C.jsx)(u.Z.Item,{label:O("quantity"),name:"set.all.quantity",rules:[{type:"number",min:0,message:O("must.be.positive.number")}],children:(0,C.jsx)(f.Z,{className:"w-100",onChange:function(e){var n=P.getFieldsValue().stocks;P.setFieldsValue({stocks:Y(n,"quantity",e)})}})})})]}),(0,C.jsx)(s.Z,{}),(0,C.jsx)("h2",{children:O("values")}),(0,C.jsx)(u.Z.List,{name:"stocks",children:function(e,n){n.add;var t=n.remove;return(0,C.jsx)("div",{children:e.map((function(n,i){var l,a,r,o;return(0,C.jsxs)(c.Z,{gutter:12,align:"middle",style:{flexWrap:"nowrap",overflowX:"auto"},hidden:!(null!==(l=M.data)&&void 0!==l&&null!==(a=l.extras)&&void 0!==a&&a.length)&&n.key,children:[null===(r=M.data)||void 0===r||null===(o=r.extras)||void 0===o?void 0:o.map((function(e,n){return(0,C.jsx)(v.Z,{children:(0,C.jsx)(u.Z.Item,{label:null===e||void 0===e?void 0:e.label,name:[i,"extras[".concat(n,"]")],rules:[{required:!0,message:O("required")}],children:(0,C.jsx)(_.q,{fetchOptions:function(){return n=e.value,y.Z.getGroupById(n).then((function(e){return e.data.extra_values.map((function(e){return{label:null===e||void 0===e?void 0:e.value,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}));var n},className:"w-100",disabled:!0,style:{minWidth:200}})})},"extra"+e.value)})),(0,C.jsx)(v.Z,{children:(0,C.jsx)(u.Z.Item,{label:O("sku"),name:[i,"sku"],children:(0,C.jsx)(p.Z,{className:"w-100",style:{minWidth:200}})})}),(0,C.jsx)(v.Z,{children:(0,C.jsx)(u.Z.Item,{label:O("quantity"),name:[i,"quantity"],rules:[{required:!0,message:O("required")}],children:(0,C.jsx)(f.Z,{min:0,className:"w-100",style:{minWidth:200}})})}),(0,C.jsxs)(v.Z,{children:[(0,C.jsx)(u.Z.Item,{label:"".concat(O("price")," (").concat(null===Q||void 0===Q?void 0:Q.symbol,")"),name:[i,"price"],rules:[{required:!0,message:O("requried")}],children:(0,C.jsx)(f.Z,{min:0,className:"w-100",style:{minWidth:200}})}),(0,C.jsx)(u.Z.Item,{hidden:!0,label:O("id"),name:[i,"stock_id"],children:(0,C.jsx)(f.Z,{min:1,className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})]}),(0,C.jsxs)(v.Z,{children:[(0,C.jsx)(u.Z.Item,{label:O("tax"),name:[i,"tax"],children:(0,C.jsx)(f.Z,{className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})}),(0,C.jsx)(u.Z.Item,{label:O("tax"),name:[i,"galleries"],hidden:!0,children:(0,C.jsx)(f.Z,{className:"w-100",disabled:!0,style:{minWidth:200},addonAfter:"%"})})]}),(0,C.jsx)(v.Z,{children:(0,C.jsx)(u.Z.Item,{noStyle:!0,shouldUpdate:function(e,t){var i,l;return(null===(i=e.stocks[n.name])||void 0===i?void 0:i.price)!==(null===(l=t.stocks[n.name])||void 0===l?void 0:l.price)},children:function(e){var t=e.getFieldValue,i=t(["stocks",n.name,"tax"])||0,l=t(["stocks",n.name,"price"]),a=0===i?null===l||void 0===l?void 0:l.toFixed(2):(l*i/100+l).toFixed(2);return(0,C.jsx)(u.Z.Item,{label:"".concat(O("total.price")," (").concat(null===Q||void 0===Q?void 0:Q.symbol,")"),children:(0,C.jsx)(f.Z,{min:1,disabled:!0,value:a,className:"w-100",style:{minWidth:200}})})}})}),(0,C.jsx)(v.Z,{children:(null===e||void 0===e?void 0:e.length)>1?(0,C.jsx)(m.Z,{type:"primary",className:"mt-2",danger:!0,icon:(0,C.jsx)(j.Z,{}),onClick:function(){t(n.name)}}):""})]},n.key)}))})}}),(0,C.jsxs)(x.Z,{className:"mt-4",children:[(0,C.jsx)(m.Z,{onClick:t,children:O("prev")}),(0,C.jsx)(m.Z,{type:"primary",htmlType:"submit",loading:!!L,children:O("next")})]})]})})}},97307:function(e,n,t){var i=t(4942),l=t(93433),a=t(15861),r=t(1413),o=t(29439),u=t(87757),d=t.n(u),s=t(47313),c=t(10976),v=t(68197),p=t(59624),m=t(77181),f=t(66672),x=t(16124),Z=t(86345),h=t(59491),j=t(89281),g=t(53149),y=t(11216),b=t(30763),k=t(2717),w=t(17101),q=t(90954),I=t(31055),_=t(97890),S=t(24511),C=t(5764),F=t(49080),N=t(13622),O=t(82138),V=t(20776),P=t(385),E=t(46417);n.Z=function(e){var n,t,u,M=e.next,A=e.action_type,U=void 0===A?"":A,L=e.isRequest,G=(0,S.$)().t,T=c.Z.useForm(),R=(0,o.Z)(T,1)[0],W=(0,k.I0)(),$=(0,_.UO)().uuid,B=(0,_.s0)(),z=(0,s.useState)(null),H=(0,o.Z)(z,2),D=H[0],K=H[1],X=(0,k.v9)((function(e){return e.menu}),k.wU).activeMenu,J=(0,k.v9)((function(e){return e.formLang}),k.wU),Q=J.defaultLang,Y=J.languages,ee=(0,s.useState)((null===X||void 0===X||null===(n=X.data)||void 0===n?void 0:n.initialMediaFile)||{images:[],previews:[]}),ne=(0,o.Z)(ee,2),te=ne[0],ie=ne[1],le=(0,s.useState)((null===(t=X.data)||void 0===t||null===(u=t.images)||void 0===u?void 0:u.filter((function(e){return!e.isVideo})))||[]),ae=(0,o.Z)(le,2),re=ae[0],oe=ae[1],ue=(0,s.useState)(!1),de=(0,o.Z)(ue,2),se=de[0],ce=de[1];function ve(){return(ve=(0,a.Z)(d().mark((function e(n){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={search:n,active:1},e.abrupt("return",g.Z.get(t).then((function(e){return e.data.map((function(e){return{label:e.translation?e.translation.title:"no name",value:e.id,key:e.id}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(){return(pe=(0,a.Z)(d().mark((function e(n){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={perPage:10,type:"main",search:n,active:1},e.abrupt("return",y.Z.getAll(t).then((function(e){return e.data.map((function(e){return{label:e.title,value:e.id,key:e.id}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(){return(me=(0,a.Z)(d().mark((function e(n){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={perPage:100,type:"main",search:n},e.abrupt("return",b.Z.getAll(t).then((function(e){return e.data.map((function(e){var n,t,i;return{label:null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id,key:e.id,type:"main",disabled:null===(t=e.children)||void 0===t?void 0:t.length,children:null===(i=e.children)||void 0===i?void 0:i.map((function(e){var n,t,i;return{label:null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id,key:e.id,type:"sub_main",disabled:null===(t=e.children)||void 0===t?void 0:t.length,children:null===(i=e.children)||void 0===i?void 0:i.map((function(e){var n;return{label:null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id,key:e.id,type:"child"}}))}}))}}))})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,s.useEffect)((function(){var e=R.getFieldsValue(!0);W((0,q.nc)({activeMenu:X,data:(0,r.Z)((0,r.Z)({},X.data),e)}))}),[]);var fe=function(e){var n={images:[],previews:[]},t=e.filter((function(e){return e.preview})).map((function(e){return{uid:e.id,name:e.preview,url:e.preview}})),i=e.filter((function(e){return e.preview})).map((function(e){return{uid:e.id,name:e.path,url:e.path,isVideo:!0}}));return n.previews=t,n.images=i,n};function xe(e){var n={perPage:10,page:1,active:1,search:e};return I.Z.getAll(n).then((function(e){var n=e.data;return null===n||void 0===n?void 0:n.map((function(e){var n;return{label:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title,value:null===e||void 0===e?void 0:e.id,key:null===e||void 0===e?void 0:e.id}}))}))}(0,s.useEffect)((function(){return xe(),function(){var e=R.getFieldsValue(!0);W((0,q.nc)({activeMenu:X,data:(0,r.Z)((0,r.Z)({},X.data),e)}))}}),[]);var Ze=function(){W((0,q.bL)({id:"category-add",url:"category/add",name:G("add.category")})),B("/category/add")},he=function(){W((0,q.bL)({id:"unit-add",url:"unit/add",name:G("add.unit")})),B("/unit/add")};return(0,E.jsxs)(c.Z,{layout:"vertical",form:R,initialValues:(0,r.Z)({active:!0,vegetarian:!0,min_qty:1,max_qty:1,tax:0,interval:1,age_limit:12,digital:!1},X.data),onFinish:function(e){var n,t,a,o,u;ce(!0);var d=(0,r.Z)((0,r.Z)((0,r.Z)({},e),{},{digital:e.digital?1:0,active:Number(e.active),brand_id:null===(n=e.brand)||void 0===n?void 0:n.value,category_id:(null===(t=e.category)||void 0===t?void 0:t.value)||e.category,shop_id:null===(a=e.shop)||void 0===a?void 0:a.value,unit_id:null===(o=e.unit)||void 0===o?void 0:o.value,images:void 0,brand:void 0,category:void 0,shop:void 0,unit:void 0,tax:e.tax||0},Object.assign.apply(Object,[{}].concat((0,l.Z)([].concat((0,l.Z)(null===te||void 0===te?void 0:te.images),(0,l.Z)(re)).map((function(e,n){return(0,i.Z)({},"images[".concat(n,"]"),e.name)})))))),Object.assign.apply(Object,[{}].concat((0,l.Z)(null===te||void 0===te||null===(u=te.previews)||void 0===u?void 0:u.map((function(e,n){return(0,i.Z)({},"previews[".concat(n,"]"),e.name)}))))));if(L)return W((0,q.nc)({activeMenu:X,data:(0,r.Z)((0,r.Z)((0,r.Z)({},X.data),d),{},{images:re,brand:e.brand,category:e.category,shop:e.shop,unit:e.unit,tax:e.tax||0,title:(0,r.Z)({},Object.assign.apply(Object,[{}].concat((0,l.Z)(Y.map((function(n){return(0,i.Z)({},n.locale,e["title[".concat(n.locale,"]")])})))))),description:(0,r.Z)({},Object.assign.apply(Object,[{}].concat((0,l.Z)(Y.map((function(n){return(0,i.Z)({},n.locale,e["description[".concat(n.locale,"]")])}))))))})})),void M();"edit"===U?function(e,n){w.Z.update($,n).then((function(){W((0,q.nc)({activeMenu:X,data:(0,r.Z)((0,r.Z)((0,r.Z)({},e),null===X||void 0===X?void 0:X.data),{},{digital:Boolean(null===n||void 0===n?void 0:n.digital)})})),M()})).catch((function(e){return K(e.response.data.params)})).finally((function(){return ce(!1)}))}(e,d):function(e,n){w.Z.create(n).then((function(n){var t=n.data;W((0,q.SS)({id:"product-".concat(t.uuid),url:"product/".concat(t.uuid),name:G("add.product"),data:(0,r.Z)((0,r.Z)((0,r.Z)({},e),t),{},{initialMediaFile:fe(t.galleries)}),refetch:!1})),B("/product/".concat(t.uuid,"/?step=1"))})).catch((function(e){return K(e.response.data.params)})).finally((function(){return ce(!1)}))}(e,d)},children:[(0,E.jsxs)(v.Z,{gutter:12,children:[(0,E.jsx)(p.Z,{span:16,children:(0,E.jsxs)(v.Z,{children:[(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(m.Z,{title:G("basic.info"),children:(0,E.jsxs)(v.Z,{children:[(0,E.jsx)(p.Z,{span:24,children:Y.map((function(e){return(0,E.jsx)(c.Z.Item,{label:G("name"),name:"title[".concat(e.locale,"]"),rules:[{validator:function(n,t){return t||(null===e||void 0===e?void 0:e.locale)!==Q?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(G("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(G("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(G("required")))}}],hidden:e.locale!==Q,children:(0,E.jsx)(f.Z,{})},"name"+e.id)}))}),(0,E.jsx)(p.Z,{span:24,children:Y.map((function(e){return(0,E.jsx)(c.Z.Item,{label:G("description"),name:"description[".concat(e.locale,"]"),rules:[{validator:function(n,t){return t||(null===e||void 0===e?void 0:e.locale)!==Q?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(G("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<5?Promise.reject(new Error(G("must.be.at.least.5"))):Promise.resolve():Promise.reject(new Error(G("required")))}}],hidden:e.locale!==Q,children:(0,E.jsx)(F.Z,{rows:3})},"description"+e.id)}))})]})})}),(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(m.Z,{title:G("pricing"),children:(0,E.jsxs)(v.Z,{gutter:12,children:[(0,E.jsx)(p.Z,{span:6,children:(0,E.jsx)(c.Z.Item,{label:G("min.qty"),name:"min_qty",rules:[{required:!0,message:G("required")}],children:(0,E.jsx)(x.Z,{min:1,className:"w-100"})})}),(0,E.jsx)(p.Z,{span:6,children:(0,E.jsx)(c.Z.Item,{label:G("max.qty"),name:"max_qty",rules:[{required:!0,message:G("required")}],children:(0,E.jsx)(x.Z,{min:1,className:"w-100"})})}),(0,E.jsx)(p.Z,{span:6,children:(0,E.jsx)(c.Z.Item,{label:G("tax"),name:"tax",rules:[{validator:function(e,n){return n&&(n<0||n>100)?Promise.reject(new Error(G("must.be.between.0.and.100"))):Promise.resolve()}}],children:(0,E.jsx)(x.Z,{className:"w-100",addonAfter:"%"})})}),(0,E.jsx)(p.Z,{span:6,children:(0,E.jsx)(c.Z.Item,{label:G("interval.unit"),name:"interval",rules:[{required:!0,message:G("required")},{type:"number",min:0,message:G("must.be.positive")}],help:null!==D&&void 0!==D&&D.interval?D.interval[0]:null,validateStatus:null!==D&&void 0!==D&&D.interval?"error":"success",children:(0,E.jsx)(x.Z,{className:"w-100"})})})]})})}),(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(m.Z,{title:G("additions"),children:(0,E.jsxs)(v.Z,{gutter:12,children:[(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(c.Z.Item,{label:G("age.limit"),name:"age_limit",rules:[{required:!0,message:G("required")}],children:(0,E.jsx)(x.Z,{min:0,className:"w-100"})})}),(0,E.jsx)(p.Z,{span:6,children:(0,E.jsx)(c.Z.Item,{label:G("active"),name:"active",valuePropName:"checked",children:(0,E.jsx)(Z.Z,{})})}),(0,E.jsx)(p.Z,{span:6,children:(0,E.jsx)(c.Z.Item,{label:G("digital"),name:"digital",valuePropName:"checked",children:(0,E.jsx)(Z.Z,{})})})]})})}),(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(m.Z,{title:G("video"),children:(0,E.jsx)(P.Z,{form:R,mediaList:te,setMediaList:ie})})})]})}),(0,E.jsx)(p.Z,{span:8,children:(0,E.jsxs)(v.Z,{children:[(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(m.Z,{title:G("organization"),children:(0,E.jsxs)(v.Z,{children:[!L&&(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(c.Z.Item,{label:G("shop/restaurant"),name:"shop",rules:[{required:!0,message:G("required")}],children:(0,E.jsx)(N.R,{fetchOptions:function(e){return ve.apply(this,arguments)},onChange:function(){return R.setFieldsValue({category:void 0})}})})}),(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(c.Z.Item,{label:G("category"),name:"category",rules:[{required:!0,message:G("required")}],children:(0,E.jsx)(V.o,{refetch:!0,fetchOptions:function(e){return me.apply(this,arguments)},dropdownRender:function(e){return(0,E.jsxs)(E.Fragment,{children:[e,(0,E.jsx)("div",{className:"p-1",children:(0,E.jsx)(h.Z,{icon:(0,E.jsx)(O.Z,{}),className:"w-100",onClick:Ze,children:G("add.category")})})]})},allowClear:!0})})}),(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(c.Z.Item,{label:G("brand"),name:"brand",children:(0,E.jsx)(j.h,{fetchOptions:function(e){return pe.apply(this,arguments)}})})}),(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(c.Z.Item,{label:G("unit"),name:"unit",rules:[{required:!0,message:G("required")}],children:(0,E.jsx)(j.h,{fetchOptions:xe,dropdownRender:function(e){return(0,E.jsxs)(E.Fragment,{children:[e,(0,E.jsx)("div",{className:"p-1",children:(0,E.jsx)(h.Z,{icon:(0,E.jsx)(O.Z,{}),className:"w-100",onClick:he,children:G("add.unit")})})]})}})})})]})})}),(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(m.Z,{title:G("media"),children:(0,E.jsx)(v.Z,{children:(0,E.jsx)(p.Z,{span:24,children:(0,E.jsx)(c.Z.Item,{name:"images",rules:[{validator:function(){return 0===(null===re||void 0===re?void 0:re.length)?Promise.reject(new Error(G("required"))):Promise.resolve()}}],children:(0,E.jsx)(C.Z,{type:"products",imageList:re,setImageList:oe,form:R,multiple:!0})})})})})})]})})]}),(0,E.jsx)(h.Z,{type:"primary",htmlType:"submit",loading:se,children:G("next")})]})}},96077:function(e,n,t){t.d(n,{S:function(){return i}});var i=[{title:"product",content:"First-content"},{title:"product.digital",content:"Product-digital"},{title:"product.extras",content:"Second-content"},{title:"stocks",content:"Third-content"},{title:"wholesale",content:"wholesale-content"},{title:"Gallery",content:"Gallery-content"},{title:"product.property",content:"Fourth-content"},{title:"finish",content:"Finish-content"}]}}]);