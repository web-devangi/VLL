"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[6124],{89281:(e,t,s)=>{s.d(t,{h:()=>c});var a=s(47313),l=s(12279),n=s.n(l),i=s(74294),r=s(72652),u=s(46417);const c=e=>{let{fetchOptions:t,debounceTimeout:s=400,onClear:l,refetchOptions:c=!1,...o}=e;const[d,m]=(0,a.useState)(!1),[h,p]=(0,a.useState)([]),f=(0,a.useMemo)((()=>n()((e=>{p([]),m(!0),t(e).then((e=>{p(e),m(!1)}))}),s)),[t,s]);return(0,u.jsx)(i.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:f,onClear:()=>{f(""),l&&l()},notFoundContent:d?(0,u.jsx)(r.Z,{size:"small"}):"no results",...o,options:h,onFocus:()=>{h.length&&!c||f("")}})}},72161:(e,t,s)=>{s.r(t),s.d(t,{default:()=>b});var a=s(47313),l=s(97890),n=s(23560),i=s(10976),r=s(77181),u=s(68197),c=s(59624),o=s(59491),d=s(2717),m=s(90954),h=s(18333),p=s(89281),f=s(24511),x=s(4446),v=s(84980),g=s(51282),j=s(5764),Z=s(46417);const b=()=>{var e,t;const{t:s}=(0,f.$)(),{activeMenu:b}=(0,d.v9)((e=>e.menu),d.wU),y=(0,d.I0)(),[S]=i.Z.useForm(),w=(0,l.s0)(),{id:C}=(0,l.UO)(),{myShop:_}=(0,d.v9)((e=>e.myShop),d.wU),[F,I]=(0,a.useState)(null!==(e=b.data)&&void 0!==e&&e.images?[null===(t=b.data)||void 0===t?void 0:t.images[0]]:[]),[O,k]=(0,a.useState)(!1),[U,q]=(0,a.useState)(!1);(0,a.useEffect)((()=>()=>{const e=S.getFieldsValue(!0);y((0,m.nc)({activeMenu:b,data:e}))}),[]);const N=e=>e.map((e=>({name:e,url:e})));return(0,a.useEffect)((()=>{var e;b.refetch&&(e=C,q(!0),x.Z.getById(e).then((e=>{let{data:t}=e;S.setFieldsValue({...t,image:N(t.file_urls),products:{label:t.product.translation.title,value:t.product.id}}),I(N(t.file_urls))})).finally((()=>{q(!1),y((0,m.A_)(b))})))}),[b.refetch]),(0,Z.jsx)(r.Z,{title:s("edit.story"),className:"h-100",children:U?(0,Z.jsx)(g.Z,{}):(0,Z.jsxs)(i.Z,{name:"story-add",layout:"vertical",onFinish:e=>{const t={...Object.assign({},...F.map(((e,t)=>({["file_urls[".concat(t,"]")]:e.name})))),product_id:e.products.value};k(!0);const a="seller/stories";x.Z.update(C,t).then((()=>{const e={shop_id:_.id};n.Am.success(s("successfully.updated")),(0,d.dC)((()=>{y((0,m.ph)({...b,nextUrl:a})),y((0,v.U7)(e))})),w("/".concat(a))})).finally((()=>k(!1)))},form:S,initialValues:{active:!0,...b.data},className:"d-flex flex-column h-100",children:[(0,Z.jsxs)(u.Z,{gutter:12,children:[(0,Z.jsx)(c.Z,{span:12,children:(0,Z.jsx)(i.Z.Item,{label:s("products"),name:"products",rules:[{required:!1,message:s("required")}],children:(0,Z.jsx)(p.h,{fetchOptions:function(e){const t={search:e,shop_id:_.id,status:"published",active:1,rest:1};return h.Z.getAll(t).then((e=>e.data.map((e=>({label:e.translation.title,value:e.id,key:e.id})))))},debounceTimeout:200})})}),(0,Z.jsx)(c.Z,{span:12,children:(0,Z.jsx)(i.Z.Item,{label:s("image"),name:"image",rules:[{required:0===F.length,message:s("required")}],children:(0,Z.jsx)(j.Z,{type:"banners",imageList:F,setImageList:I,form:S,multiple:!1})})})]}),(0,Z.jsx)("div",{className:"flex-grow-1 d-flex flex-column justify-content-end",children:(0,Z.jsx)("div",{className:"pb-5",children:(0,Z.jsx)(o.Z,{type:"primary",htmlType:"submit",loading:O,children:s("submit")})})})]})})}}}]);