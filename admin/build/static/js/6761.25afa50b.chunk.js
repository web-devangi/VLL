"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[6761],{89281:function(e,n,i){i.d(n,{h:function(){return f}});var t=i(1413),r=i(29439),a=i(45987),l=i(47313),s=i(12279),o=i.n(s),u=i(74294),c=i(72652),d=i(46417),m=["fetchOptions","debounceTimeout","onClear","refetchOptions"],f=function(e){var n=e.fetchOptions,i=e.debounceTimeout,s=void 0===i?400:i,f=e.onClear,v=e.refetchOptions,p=void 0!==v&&v,h=(0,a.Z)(e,m),Z=(0,l.useState)(!1),g=(0,r.Z)(Z,2),x=g[0],j=g[1],w=(0,l.useState)([]),b=(0,r.Z)(w,2),y=b[0],N=b[1],S=(0,l.useMemo)((function(){return o()((function(e){N([]),j(!0),n(e).then((function(e){N(e),j(!1)}))}),s)}),[n,s]);return(0,d.jsx)(u.Z,(0,t.Z)((0,t.Z)({showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:S,onClear:function(){S(""),f&&f()},notFoundContent:x?(0,d.jsx)(c.Z,{size:"small"}):"no results"},h),{},{options:y,onFocus:function(){y.length&&!p||S("")}}))}},385:function(e,n,i){var t=i(93433),r=i(1413),a=i(15861),l=i(29439),s=i(87757),o=i.n(s),u=i(47313),c=i(10976),d=i(26824),m=i(68197),f=i(59624),v=i(45705),p=i(15178),h=i(9274),Z=i(59491),g=i(82138),x=i(47515),j=i(5764),w=i(36104),b=i(24511),y=i(46417);n.Z=function(e){var n,i=e.mediaList,s=e.setMediaList,N=e.name,S=void 0===N?"products":N,L=(0,b.$)().t,k=c.Z.useForm(),C=(0,l.Z)(k,1)[0],F=(0,u.useState)(null),q=(0,l.Z)(F,2),O=q[0],I=q[1],M=(0,u.useState)([]),P=(0,l.Z)(M,2),V=P[0],E=P[1],T=(0,u.useState)(!1),U=(0,l.Z)(T,2),z=U[0],A=U[1],$=(0,u.useState)(!1),B=(0,l.Z)($,2),D=B[0],R=B[1],_=function(){var e=(0,a.Z)(o().mark((function e(n){var i,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=n.file,t=n.type,i.name?(I("video"===t?(0,y.jsx)("video",{controls:!0,src:i.name,width:450,height:450}):(0,y.jsx)(d.Z,{src:i.name,width:"100%",height:450,alt:"preview-img"})),A(!0)):I(null);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),G=function(e){return{uid:e.title,name:e.title,status:"done",url:e.title,created:!0}};return(0,y.jsxs)(m.Z,{gutter:[24,24],children:[(0,y.jsx)(f.Z,{span:24,children:(0,y.jsx)(v.Z,{className:"align-items-start",children:(0,y.jsx)(p.Z,{customRequest:function(e){var n=e.file,i=e.onSuccess;R(!0);var a=new FormData;a.append("image",n),a.append("type",S),w.Z.upload(a).then((function(e){var n=e.data;s((function(e){return(0,r.Z)((0,r.Z)({},e),{},{images:[].concat((0,t.Z)(e.images),[(0,r.Z)((0,r.Z)({},G(n)),{},{isVideo:!0})])})})),i("ok")}))},accept:"video/*",listType:"text",className:"video-upload",multiple:!1,fileList:[],children:(0,y.jsxs)("div",{className:"media-upload",children:[(0,y.jsx)(g.Z,{})," ",(0,y.jsx)("span",{children:L("upload.video")})]})})})}),(0,y.jsx)(f.Z,{span:24,children:null===i||void 0===i||null===(n=i.previews)||void 0===n?void 0:n.map((function(e,n){var t,r;return(0,y.jsxs)(v.Z,{className:"uploaded-file",wrap:!0,children:[(0,y.jsx)("span",{className:"media-item",onClick:function(){return _({type:"img",file:null===i||void 0===i?void 0:i.previews[n]})},children:null===i||void 0===i||null===(t=i.previews[n])||void 0===t?void 0:t.name}),(0,y.jsx)("span",{className:"media-item",onClick:function(){return _({type:"video",file:null===i||void 0===i?void 0:i.images[n]})},children:null===i||void 0===i||null===(r=i.images[n])||void 0===r?void 0:r.name}),(0,y.jsx)(x.Z,{className:"delete-media-item",onClick:function(){return function(e){var n=i.images.filter((function(n,i){if(i!==e)return n})),t=i.previews.filter((function(n,i){if(i!==e)return n}));s({images:n,previews:t})}(n)}})]})}))}),(0,y.jsx)(h.Z,{title:"Video Preview",visible:z,onCancel:function(){A(!1)},footer:null,children:O}),(0,y.jsx)(h.Z,{title:"Preview image",visible:D,footer:null,children:(0,y.jsx)(c.Z,{form:C,onFinish:function(){s((function(e){return(0,r.Z)((0,r.Z)({},e),{},{previews:[].concat((0,t.Z)(e.previews),(0,t.Z)(V))})})),E([]),R(!1)},layout:"vertical",children:(0,y.jsxs)(m.Z,{gutter:[24,24],children:[(0,y.jsx)(f.Z,{span:24,children:(0,y.jsx)(c.Z.Item,{label:L("preview.image"),name:"preview-image",rules:[{required:!(null!==V&&void 0!==V&&V.length),message:L("required")}],children:(0,y.jsx)(j.Z,{type:S,imageList:V,setImageList:E,multiple:!1,text:"upload.image",form:C})})}),(0,y.jsx)(f.Z,{span:24,className:"d-flex justify-content-end",children:(0,y.jsx)(Z.Z,{type:"primary",onClick:function(){return C.submit()},children:L("save")})})]})})})]})}},75336:function(e,n,i){i.d(n,{Z:function(){return a}});var t=i(93433),r=i(4942);function a(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"title",a=e.map((function(e){return(0,r.Z)({},e.locale,""===n["".concat(i,"[").concat(e.locale,"]")]?void 0:n["".concat(i,"[").concat(e.locale,"]")])}));return Object.assign.apply(Object,[{}].concat((0,t.Z)(a)))}},36761:function(e,n,i){i.r(n);var t=i(1413),r=i(93433),a=i(4942),l=i(29439),s=i(47313),o=i(97890),u=i(23560),c=i(10976),d=i(72652),m=i(2717),f=i(90954),v=i(32447),p=i(54872),h=i(24511),Z=i(75336),g=i(20364),x=i(46417);n.default=function(){var e=(0,h.$)().t,n=(0,m.v9)((function(e){return e.menu}),m.wU).activeMenu,i=(0,m.I0)(),j=c.Z.useForm(),w=(0,l.Z)(j,1)[0],b=(0,o.s0)(),y=(0,o.UO)().id,N=(0,s.useState)(!1),S=(0,l.Z)(N,2),L=S[0],k=S[1],C=(0,m.v9)((function(e){return e.formLang}),m.wU).languages;(0,s.useEffect)((function(){return function(){var e=w.getFieldsValue(!0);i((0,f.nc)({activeMenu:n,data:e}))}}),[]);var F=function(e){var n={images:[],previews:[]},i=e.filter((function(e){return e.preview})).map((function(e){return{uid:e.id,name:e.preview,url:e.preview}})),t=e.filter((function(e){return e.preview})).map((function(e){return{uid:e.id,name:e.path,url:e.path,isVideo:!0}}));return n.previews=i,n.images=t,n};var q=function(e){k(!0),p.Z.getById(e).then((function(e){var l,s,o=e.data,u=(0,t.Z)((0,t.Z)({},o),{},{initialMediaFile:F(e.data.galleries),img:(s=o.galleries,s.map((function(e){return{uid:e.id,name:e.path,url:e.path,isVideo:Boolean(e.preview)}}))),products:null===o||void 0===o||null===(l=o.products)||void 0===l?void 0:l.map((function(e){var n;return{label:null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id}}))},function(e){if(!e)return{};var n=e.translations,i=C.map((function(e){var i,t,r;return r={},(0,a.Z)(r,"title[".concat(e.locale,"]"),null===(i=n.find((function(n){return n.locale===e.locale})))||void 0===i?void 0:i.title),(0,a.Z)(r,"description[".concat(e.locale,"]"),null===(t=n.find((function(n){return n.locale===e.locale})))||void 0===t?void 0:t.description),r}));return Object.assign.apply(Object,[{}].concat((0,r.Z)(i)))}(o));w.setFieldsValue(u),i((0,f.nc)({activeMenu:n,data:u}))})).finally((function(){i((0,f.A_)(n)),k(!1)}))};return(0,s.useEffect)((function(){n.refetch&&q(y)}),[n.refetch]),(0,x.jsx)(x.Fragment,{children:L?(0,x.jsx)("div",{className:"d-flex justify-content-center align-items-center",children:(0,x.jsx)(d.Z,{size:"large",className:"py-5"})}):(0,x.jsx)(g.Z,{form:w,handleSubmit:function(a,l,s){var o,c=s.images.map((function(e){return e.name})),d=s.previews.map((function(e){return e.name})),h={products:null===(o=a.products)||void 0===o?void 0:o.map((function(e){return e.value})),images:[].concat((0,r.Z)(c),(0,r.Z)(l.map((function(e){return e.name})))),previews:d,clickable:!0,title:(0,Z.Z)(C,a,"title"),description:(0,Z.Z)(C,a,"description")},g="banners";return p.Z.update(y,h).then((function(){u.Am.success(e("successfully.updated")),(0,m.dC)((function(){i((0,f.ph)((0,t.Z)((0,t.Z)({},n),{},{nextUrl:g}))),i((0,v.f)({}))})),b("/".concat(g))}))}})})}},20364:function(e,n,i){i.d(n,{Z:function(){return x}});var t=i(1413),r=i(29439),a=i(47313),l=i(10976),s=i(68197),o=i(59624),u=i(77181),c=i(66672),d=i(59491),m=i(89281),f=i(5764),v=i(24511),p=i(2717),h=i(17101),Z=i(385),g=i(46417);function x(e){var n,i,x=e.form,j=e.handleSubmit,w=(0,v.$)().t,b=(0,p.v9)((function(e){return e.menu}),p.wU).activeMenu,y=(0,p.v9)((function(e){return e.formLang}),p.wU),N=y.languages,S=y.defaultLang,L=(0,a.useState)((null===(n=b.data)||void 0===n?void 0:n.img.filter((function(e){return!e.isVideo})))||[]),k=(0,r.Z)(L,2),C=k[0],F=k[1],q=(0,a.useState)(!1),O=(0,r.Z)(q,2),I=O[0],M=O[1],P=(0,a.useState)((null===b||void 0===b||null===(i=b.data)||void 0===i?void 0:i.initialMediaFile)||{images:[],previews:[]}),V=(0,r.Z)(P,2),E=V[0],T=V[1];return(0,g.jsx)(l.Z,{name:"banner-form",layout:"vertical",onFinish:function(e){M(!0),j(e,C,E).finally((function(){return M(!1)}))},form:x,initialValues:(0,t.Z)({clickable:!0},b.data),className:"d-flex flex-column h-100",children:(0,g.jsxs)(s.Z,{gutter:[24,24],children:[(0,g.jsx)(o.Z,{span:16,children:(0,g.jsxs)(s.Z,{gutter:[24,24],children:[(0,g.jsx)(o.Z,{span:24,children:(0,g.jsx)(u.Z,{title:w("images"),className:"h-100",children:(0,g.jsx)(l.Z.Item,{rules:[{required:!C.length,message:w("required")}],label:w("image"),name:"images",children:(0,g.jsx)(f.Z,{type:"banners",imageList:C,setImageList:F,form:x,length:"1",multiple:!1})})})}),(0,g.jsx)(o.Z,{span:24,children:(0,g.jsx)(u.Z,{title:w("video"),className:"h-100",children:(0,g.jsx)(Z.Z,{name:"banners",form:x,mediaList:E,setMediaList:T})})})]})}),(0,g.jsx)(o.Z,{span:8,children:(0,g.jsxs)(u.Z,{title:w("basic.info"),className:"h-100",children:[N.map((function(e){return(0,g.jsx)(l.Z.Item,{label:w("title"),name:"title[".concat(e.locale,"]"),rules:[{required:e.locale===S,message:w("required")},{validator:function(e,n){return n&&""===(null===n||void 0===n?void 0:n.trim())?Promise.reject(new Error(w("no.empty.space"))):n&&(null===n||void 0===n?void 0:n.trim().length)<2?Promise.reject(new Error(w("must.be.at.least.2"))):Promise.resolve()}}],hidden:e.locale!==S,children:(0,g.jsx)(c.Z,{maxLength:50})},"title"+e.locale)})),N.map((function(e){return(0,g.jsx)(l.Z.Item,{label:w("description"),name:"description[".concat(e.locale,"]"),rules:[{required:e.locale===S,message:w("required")},{validator:function(e,n){return n&&""===(null===n||void 0===n?void 0:n.trim())?Promise.reject(new Error(w("no.empty.space"))):n&&(null===n||void 0===n?void 0:n.trim().length)<5?Promise.reject(new Error(w("must.be.at.least.5"))):Promise.resolve()}}],hidden:e.locale!==S,children:(0,g.jsx)(c.Z.TextArea,{maxLength:150})},"description"+e.locale)})),(0,g.jsx)(l.Z.Item,{label:w("products"),name:"products",rules:[{required:!0,message:w("required")}],children:(0,g.jsx)(m.h,{mode:"multiple",fetchOptions:function(e){var n={search:e,perPage:10,status:"published"};return h.Z.getAll(n).then((function(e){return e.data.map((function(e){var n;return{label:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id,key:e.id}}))}))},debounceTimeout:200})})]})}),(0,g.jsx)(o.Z,{span:24,children:(0,g.jsx)("div",{className:"d-flex justify-content-end",children:(0,g.jsx)("div",{className:"pb-5",children:(0,g.jsx)(d.Z,{type:"primary",htmlType:"submit",loading:I,children:w("submit")})})})})]})})}}}]);