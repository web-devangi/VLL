"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[4177],{13622:(e,s,a)=>{a.d(s,{R:()=>d});var l=a(47313),r=a(12279),i=a.n(r),n=a(74294),t=a(72652),m=a(46417);const d=e=>{let{fetchOptions:s,debounceTimeout:a=400,refetch:r=!1,...d}=e;const[c,u]=(0,l.useState)(!1),[o,p]=(0,l.useState)([]),h=(0,l.useMemo)((()=>i()((e=>{p([]),u(!0),s(e).then((e=>{p(e),u(!1)}))}),a)),[s,a]);return(0,m.jsx)(n.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,onClear:()=>h(""),filterOption:!1,onSearch:h,notFoundContent:c?(0,m.jsx)(t.Z,{size:"small"}):"no results",...d,options:o,onFocus:()=>{o.length&&!r||h("")}})}},54177:(e,s,a)=>{a.r(s),a.d(s,{default:()=>I});var l=a(47313),r=a(10976),i=a(77181),n=a(68197),t=a(59624),m=a(66672),d=a(16124),c=a(86345),u=a(59491),o=a(23560),p=a(97890),h=a(71927),x=a(2717),j=a(90954),Z=a(24511),g=a(8550),v=a(51282),_=a(5764),f=a(29186),w=a(98231),q=a(13622),b=a(46417);function I(){var e,s;const{t:a}=(0,Z.$)(),I=(0,p.s0)(),{id:y}=(0,p.UO)(),N=(0,x.I0)(),[A]=r.Z.useForm(),{activeMenu:k}=(0,x.v9)((e=>e.menu),x.wU),[S,F]=(0,l.useState)(!1),[P,C]=(0,l.useState)(!1),[E,O]=(0,l.useState)((null===k||void 0===k||null===(e=k.data)||void 0===e?void 0:e.image)||[]),[U,V]=(0,l.useState)(null===k||void 0===k||null===(s=k.data)||void 0===s?void 0:s.special);(0,l.useEffect)((()=>()=>{const e=A.getFieldsValue(!0);N((0,j.nc)({activeMenu:k,data:{...k.data,...e}}))}),[]);return(0,l.useEffect)((()=>{k.refetch&&y&&(e=>{F(!0),h.Z.getById(e).then((e=>{let s=e.data;O([(0,g.Z)(s.img)]),V(s.special),A.setFieldsValue({...s,options:null===s||void 0===s?void 0:s.options.map((e=>{var s;return{label:null===(s=e.translation)||void 0===s?void 0:s.title,value:e.id}}))})})).finally((()=>{F(!1),N((0,j.A_)(k))}))})(y)}),[k.refetch]),(0,b.jsx)(i.Z,{title:a(y?"edit.parcel.type":"add.parcel.type"),children:S?(0,b.jsx)(v.Z,{}):(0,b.jsxs)(r.Z,{form:A,name:"parcel-type",layout:"vertical",initialValues:{...k.data},onFinish:e=>{var s;C(!0);const l={...e,special:Boolean(e.special),special_price:e.special_price||0,special_price_per_km:e.special_price_per_km||0,images:null===E||void 0===E?void 0:E.map((e=>e.name)),image:void 0,options:null===(s=e.options)||void 0===s?void 0:s.map((e=>e.value))},r="parcel-types";y?h.Z.update(y,l).then((()=>{N((0,f.K)()),o.Am.success(a("successfully.updated")),N((0,j.ph)({...k,nextUrl:r})),I("/".concat(r))})).finally((()=>C(!1))):h.Z.create(l).then((()=>{N((0,f.K)()),o.Am.success(a("successfully.created")),N((0,j.ph)({...k,nextUrl:r})),I("/".concat(r))})).finally((()=>C(!1)))},children:[(0,b.jsxs)(n.Z,{gutter:12,children:[(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("title"),name:"type",rules:[{validator:(e,s)=>s?s&&""===(null===s||void 0===s?void 0:s.trim())?Promise.reject(new Error(a("no.empty.space"))):s&&(null===s||void 0===s?void 0:s.trim().length)<2?Promise.reject(new Error(a("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(a("required")))}],children:(0,b.jsx)(m.Z,{})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("image"),name:"images",rules:[{validator:()=>0===(null===E||void 0===E?void 0:E.length)?Promise.reject(new Error(a("required"))):Promise.resolve()}],children:(0,b.jsx)(_.Z,{type:"languages",imageList:E,setImageList:O,form:A,multiple:!1})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("start.price"),name:"price",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,className:"w-100"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("price.per.km"),name:"price_per_km",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,className:"w-100"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("min_width"),name:"min_width",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("max_width"),name:"max_width",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("min_height"),name:"min_height",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("max_height"),name:"max_height",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("min_length"),name:"min_length",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("max_length"),name:"max_length",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,max:32678,className:"w-100",addonAfter:"sm"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("min_weight"),name:"min_g",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,max:32678,className:"w-100",addonAfter:"gramm"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("max_weight"),name:"max_g",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,max:2147e6,className:"w-100",addonAfter:"gramm"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("options"),name:"options",children:(0,b.jsx)(q.R,{fetchOptions:async e=>w.Z.getAll({search:e}).then((e=>{let{data:s}=e;return s.map((e=>{var s;return{label:null===e||void 0===e||null===(s=e.translation)||void 0===s?void 0:s.title,value:null===e||void 0===e?void 0:e.id}}))})),mode:"multiple"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("max.range"),name:"max_range",children:(0,b.jsx)(d.Z,{min:0,className:"w-100",addonAfter:"km"})})}),(0,b.jsx)(t.Z,{span:24,children:(0,b.jsx)(r.Z.Item,{label:a("special"),name:"special",valuePropName:"checked",children:(0,b.jsx)(c.Z,{onChange:e=>V(e)})})}),!!U&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("start.price"),name:"special_price",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,className:"w-100"})})}),(0,b.jsx)(t.Z,{span:12,children:(0,b.jsx)(r.Z.Item,{label:a("price.per.km"),name:"special_price_per_km",rules:[{required:!0,message:a("required")}],children:(0,b.jsx)(d.Z,{min:0,className:"w-100"})})})]})]}),(0,b.jsx)(u.Z,{type:"primary",htmlType:"submit",loading:P,children:a("save")})]})})}}}]);