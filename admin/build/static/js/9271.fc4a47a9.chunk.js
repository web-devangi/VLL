"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[9271],{53233:(e,t,n)=>{n.d(t,{Z:()=>p});var a=n(47313),s=n(56140),l=n(67251),i=n(45705),r=n(86345),o=n(78267),d=n(37388),c=n(59491),u=n(99587),h=n(24511),v=n(46417);const{Text:m}=s.Z,p=e=>{let{columns:t=[],setColumns:n,style:s,size:p="",iconOnly:x}=e;const{t:Z}=(0,h.$)(),[j,f]=(0,a.useState)(!1),y=(0,v.jsx)(l.Z,{children:null===t||void 0===t?void 0:t.map(((e,a)=>(0,v.jsx)(l.Z.Item,{children:(0,v.jsxs)(i.Z,{className:"d-flex justify-content-between",children:[(0,v.jsx)(m,{children:e.title}),(0,v.jsx)(r.Z,{defaultChecked:!0,onClick:()=>function(e){const a=null===t||void 0===t?void 0:t.map((t=>(t.dataIndex===e.dataIndex&&(t.is_show=!(null!==t&&void 0!==t&&t.is_show)),t)));n(a)}(e),disabled:1===a})]})},e+a)))});return(0,v.jsx)(o.Z,{overlay:y,trigger:["click"],onVisibleChange:e=>{f(e)},visible:j,children:(0,v.jsx)(d.Z,{title:Z("change.columns"),children:(0,v.jsx)(c.Z,{style:{...s},size:p,icon:(0,v.jsx)(u.Z,{}),children:x?null:Z("Columns")})})})}},89281:(e,t,n)=>{n.d(t,{h:()=>d});var a=n(47313),s=n(12279),l=n.n(s),i=n(74294),r=n(72652),o=n(46417);const d=e=>{let{fetchOptions:t,debounceTimeout:n=400,onClear:s,refetchOptions:d=!1,...c}=e;const[u,h]=(0,a.useState)(!1),[v,m]=(0,a.useState)([]),p=(0,a.useMemo)((()=>l()((e=>{m([]),h(!0),t(e).then((e=>{m(e),h(!1)}))}),n)),[t,n]);return(0,o.jsx)(i.Z,{showSearch:!0,allowClear:!0,labelInValue:!0,filterOption:!1,onSearch:p,onClear:()=>{p(""),s&&s()},notFoundContent:u?(0,o.jsx)(r.Z,{size:"small"}):"no results",...c,options:v,onFocus:()=>{v.length&&!d||p("")}})}},13945:(e,t,n)=>{function a(e){switch(e){case"ascend":return"asc";case"descend":return"desc"}}n.d(t,{Z:()=>a})},84017:(e,t,n)=>{function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"$",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"after";const a=Number(e).toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,");return"after"===n?"".concat(a," ").concat(t):"".concat(t," ").concat(a)}n.d(t,{Z:()=>a})},39271:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var a=n(47313),s=n(73591),l=n(66204),i=n(59491),r=n(77181),o=n(45705),d=n(78508),c=n(12019),u=n(31741),h=n(2717),v=n(90954),m=n(24511),p=n(80314),x=n(13945),Z=n(89281),j=n(49986),f=n(93655),y=n(9274),g=n(83371),b=n(51282),C=n(1003),I=n(84017),w=n(70816),_=n.n(w),k=n(46417);function z(e){var t,n,s,r,o,d;let{id:c,handleCancel:u}=e;const[h,v]=(0,a.useState)({}),[p,x]=(0,a.useState)(!1),{t:Z}=(0,m.$)();return(0,a.useEffect)((()=>{!function(e){x(!0),C.Z.getById(e).then((e=>v(e.data))).finally((()=>x(!1)))}(c)}),[c]),(0,k.jsx)(y.Z,{visible:!!c,title:Z("transaction"),onCancel:u,footer:(0,k.jsx)(i.Z,{type:"default",onClick:u,children:Z("cancel")}),children:p?(0,k.jsx)(b.Z,{}):(0,k.jsxs)(g.Z,{bordered:!0,children:[(0,k.jsx)(g.Z.Item,{span:3,label:Z("transaction.id"),children:h.id}),(0,k.jsxs)(g.Z.Item,{span:3,label:Z("client"),children:[null===(t=h.user)||void 0===t?void 0:t.firstname," ",(null===(n=h.user)||void 0===n?void 0:n.lastname)||""]}),(0,k.jsx)(g.Z.Item,{span:3,label:Z("price"),children:(0,I.Z)(h.price,null===(s=h.payable)||void 0===s||null===(r=s.order)||void 0===r||null===(o=r.currency)||void 0===o?void 0:o.symbol)}),(0,k.jsx)(g.Z.Item,{span:3,label:Z("payment.type"),children:Z(null===(d=h.payment_system)||void 0===d?void 0:d.tag)}),(0,k.jsx)(g.Z.Item,{span:3,label:Z("created.at"),children:_()(h.created_at).format("DD.MM.YYYY HH:mm")}),(0,k.jsx)(g.Z.Item,{span:3,label:Z("status"),children:"progress"===h.status?(0,k.jsx)(l.Z,{color:"gold",children:Z(h.status)}):"rejected"===h.status?(0,k.jsx)(l.Z,{color:"error",children:Z(h.status)}):(0,k.jsx)(l.Z,{color:"cyan",children:Z(h.status)})}),(0,k.jsx)(g.Z.Item,{span:3,label:Z("status.description"),children:h.status_description}),(0,k.jsx)(g.Z.Item,{span:3,label:Z("note"),children:h.note})]})})}var S=n(53233),H=n(10976),V=n(68197),M=n(59624),D=n(74294),P=n(23560);const Y=["paid","canceled"];function O(e){let{transactionDetails:t,handleCancel:n,paramsData:s}=e;const{activeMenu:l}=(0,h.v9)((e=>e.menu),h.wU),[r]=H.Z.useForm(),o=(0,h.I0)(),{t:d}=(0,m.$)(),[c,u]=(0,a.useState)(!1);return(0,k.jsx)(y.Z,{visible:!!t,title:d("transaction.status"),closable:!1,footer:[(0,k.jsx)(i.Z,{type:"primary",onClick:()=>r.submit(),loading:c,children:d("save")},"save-form"),(0,k.jsx)(i.Z,{type:"default",onClick:n,children:d("cancel")},"cansel-modal")],children:(0,k.jsx)(H.Z,{form:r,layout:"vertical",onFinish:e=>{u(!0),C.Z.updateTransactionStatus(t.id,e).then((()=>{n(),o((0,f.mC)(s))})).catch((e=>P.Am.error(e.message))).finally((()=>u(!1)))},initialValues:{status:t.status},children:(0,k.jsx)(V.Z,{gutter:12,children:(0,k.jsx)(M.Z,{span:24,children:(0,k.jsx)(H.Z.Item,{label:d("status"),name:"status",rules:[{validator:(e,t)=>t&&"progress"!==t?Promise.resolve():Promise.reject(new Error(d("required")))}],children:(0,k.jsx)(D.Z,{children:Y.map(((e,t)=>(0,k.jsx)(D.Z.Option,{value:e,children:d(e)},t)))})})})})})})}const{TabPane:$}=s.Z,F=["all","progress","paid","canceled","rejected"];function T(){var e,t,n,y;const g=(0,h.I0)(),{t:b}=(0,m.$)(),[C,w]=(0,a.useState)(null),[H,V]=(0,a.useState)(null),[M,D]=(0,a.useState)([{title:b("id"),dataIndex:"id",key:"id",sorter:!0,is_show:!0},{title:b("client"),dataIndex:"user",key:"user",is_show:!0,render:e=>null===e?(0,k.jsx)(l.Z,{color:"red",children:b("deleted.user")}):(0,k.jsxs)("div",{children:[null===e||void 0===e?void 0:e.firstname," ",(null===e||void 0===e?void 0:e.lastname)||""]})},{title:b("amount"),dataIndex:"price",key:"price",is_show:!0,render:(e,t)=>{var n,a,s;return(0,I.Z)(e,null===(n=t.payable)||void 0===n||null===(a=n.order)||void 0===a||null===(s=a.currency)||void 0===s?void 0:s.symbol)}},{title:b("payment.type"),dataIndex:"payment_system",key:"payment_system",is_show:!0,render:e=>null===e||void 0===e?void 0:e.tag},{title:b("status"),dataIndex:"status",key:"status",is_show:!0,render:(e,t)=>(0,k.jsxs)("div",{children:["progress"===e?(0,k.jsx)(l.Z,{color:"gold",children:b(e)}):"rejected"===e||"canceled"===e?(0,k.jsx)(l.Z,{color:"error",children:b(e)}):(0,k.jsx)(l.Z,{color:"cyan",children:b(e)}),(0,k.jsx)(c.Z,{onClick:()=>{V(t)}})]})},{title:b("status.note"),dataIndex:"status_description",key:"status_description",is_show:!0},{title:b("created.at"),dataIndex:"created_at",key:"created_at",is_show:!0,render:e=>_()(e).format("DD.MM.YYYY HH:mm")},{title:b("options"),key:"options",is_show:!0,render:(e,t)=>(0,k.jsx)(i.Z,{icon:(0,k.jsx)(u.Z,{}),onClick:()=>(e=>{w(e.id)})(t)})}]),{activeMenu:P}=(0,h.v9)((e=>e.menu),h.wU),[Y,T]=(0,a.useState)("all"),{transactions:E,meta:N,loading:U,params:A}=(0,h.v9)((e=>e.transaction),h.wU),B=(null===(e=P.data)||void 0===e?void 0:e.role)||Y,K=P.data,q={sort:null===K||void 0===K?void 0:K.sort,column:null===K||void 0===K?void 0:K.column,perPage:null===K||void 0===K?void 0:K.perPage,page:null===K||void 0===K?void 0:K.page,user_id:null===K||void 0===K?void 0:K.userId,status:"all"===(null===K||void 0===K?void 0:K.role)||null===K||void 0===K?void 0:K.role};(0,p.Z)((()=>{g((0,f.mC)(q))}),[P.data]),(0,a.useEffect)((()=>{P.refetch&&(g((0,f.mC)(A)),g((0,v.A_)(P)))}),[P.refetch]);const R=e=>{const t=P.data;g((0,v.nc)({activeMenu:P,data:{...t,...e}}))};return(0,k.jsxs)(r.Z,{title:b("transactions"),extra:(0,k.jsxs)(o.Z,{wrap:!0,children:[(0,k.jsx)(Z.h,{placeholder:b("select.client"),fetchOptions:async function(e){const t={search:e,perPage:10};return j.Z.search(t).then((e=>{let{data:t}=e;return t.map((e=>({label:"".concat(e.firstname," ").concat(e.lastname),value:e.id})))}))},onSelect:e=>R({userId:e.value}),onDeselect:()=>R({userId:null}),style:{minWidth:200}}),(0,k.jsx)(S.Z,{columns:M,setColumns:D})]}),children:[(0,k.jsx)(s.Z,{onChange:e=>{R({role:e,page:1}),T(e)},type:"card",activeKey:B,children:F.map((e=>(0,k.jsx)($,{tab:b(e)},e)))}),(0,k.jsx)(d.Z,{scroll:{x:!0},columns:null===M||void 0===M?void 0:M.filter((e=>e.is_show)),dataSource:E,loading:U,pagination:{pageSize:A.perPage,page:(null===(t=P.data)||void 0===t?void 0:t.page)||1,total:N.total,defaultCurrent:null===(n=P.data)||void 0===n?void 0:n.page,current:null===(y=P.data)||void 0===y?void 0:y.page},rowKey:e=>e.id,onChange:function(e,t,n){const{pageSize:a,current:s}=e,{field:l,order:i}=n,r=(0,x.Z)(i);g((0,v.nc)({activeMenu:P,data:{...K,perPage:a,page:s,column:l,sort:r}}))}}),C&&(0,k.jsx)(z,{id:C,handleCancel:()=>w(null)}),H&&(0,k.jsx)(O,{transactionDetails:H,handleCancel:()=>V(null),paramsData:q})]})}},99587:(e,t,n)=>{n.d(t,{Z:()=>o});var a=n(1413),s=n(47313);const l={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 208H676V232h212v136zm0 224H676V432h212v160zM412 432h200v160H412V432zm200-64H412V232h200v136zm-476 64h212v160H136V432zm0-200h212v136H136V232zm0 424h212v136H136V656zm276 0h200v136H412V656zm476 136H676V656h212v136z"}}]},name:"table",theme:"outlined"};var i=n(17469),r=function(e,t){return s.createElement(i.Z,(0,a.Z)((0,a.Z)({},e),{},{ref:t,icon:l}))};r.displayName="TableOutlined";const o=s.forwardRef(r)}}]);