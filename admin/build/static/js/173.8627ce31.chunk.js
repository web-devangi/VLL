"use strict";(self.webpackChunkuzmart=self.webpackChunkuzmart||[]).push([[173],{49655:function(e,n,t){t.d(n,{_:function(){return g}});var i=t(1413),r=t(93433),a=t(15861),l=t(29439),u=t(45987),o=t(87757),c=t.n(o),s=t(47313),d=t(12279),f=t.n(d),v=t(74294),h=t(72652),Z=t(46417),p=["fetchOptions","debounceTimeout","hasMore"],g=function(e){var n=e.fetchOptions,t=e.debounceTimeout,o=void 0===t?400:t,d=e.hasMore,g=(0,u.Z)(e,p),m=(0,s.useState)(!1),x=(0,l.Z)(m,2),j=x[0],y=x[1],b=(0,s.useState)([]),_=(0,l.Z)(b,2),S=_[0],C=_[1],k=(0,s.useState)(!1),w=(0,l.Z)(k,2),I=w[0],O=w[1],B=(0,s.useState)(null),P=(0,l.Z)(B,2),V=P[0],z=P[1],A=(0,s.useState)(1),E=(0,l.Z)(A,2),F=E[0],M=E[1],q=(0,s.useMemo)((function(){return f()((function(e){C([]),z(e),y(!0),n({search:e}).then((function(e){C(e),M(2),y(!1)})).finally((function(){return O(!1)}))}),o)}),[n,o,F]),L=function(){var e=(0,a.Z)(c().mark((function e(t){var i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.target,I||i.scrollTop+i.offsetHeight!==i.scrollHeight||d&&(O(!0),i.scrollTo(0,i.scrollHeight),n({search:V,page:F}).then((function(e){M((function(e){return e+1})),C([].concat((0,r.Z)(S),(0,r.Z)(e)))})).finally((function(){return O(!1)})));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,Z.jsxs)(v.Z,(0,i.Z)((0,i.Z)({showSearch:!0,allowClear:!0,onPopupScroll:L,labelInValue:!0,filterOption:!1,onSearch:q,notFoundContent:j?(0,Z.jsx)(h.Z,{size:"small"}):"no results",onFocus:function(){S.length||q("")}},g),{},{children:[S.map((function(e,n){return(0,Z.jsx)(v.Z.Option,{value:e.value,children:e.label},n)})),I&&(0,Z.jsx)(v.Z.Option,{children:(0,Z.jsx)(h.Z,{size:"small"})})]}))}},73431:function(e,n,t){var i=t(47313),r=t(39180),a=t(2717),l=t(28830),u=t(60535),o=t(46417);n.Z=function(){var e=(0,a.I0)(),n=(0,a.v9)((function(e){return e.formLang}),a.wU),t=n.languages,c=n.defaultLang;(0,i.useEffect)((function(){u.Z.getAllActive().then((function(n){var t=n.data;e((0,l.dc)(t)),e((0,l.mh)(t.find((function(e){return 1===e.default})).locale))}))}),[]);return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(r.ZP.Group,{value:c,onChange:function(n){var t=n.target.value;e((0,l.mh)(t))},className:"float-right",buttonStyle:"solid",children:null===t||void 0===t?void 0:t.map((function(e){return(0,o.jsx)(r.ZP.Button,{value:e.locale,children:e.title},e.id)}))})})}},41481:function(e,n,t){t.d(n,{Z:function(){return f}});var i=t(1413),r=t(29439),a=t(45987),l=t(47313),u=t(66672),o=t(16031),c=t(40765),s=t(46417),d=["handleChange","defaultValue","resetSearch"];function f(e){var n=e.handleChange,t=e.defaultValue,f=e.resetSearch,v=(0,a.Z)(e,d),h=(0,l.useState)(t),Z=(0,r.Z)(h,2),p=Z[0],g=Z[1],m=(0,l.useMemo)((function(){return(0,o.debounce)((function(e){n(e)}),800)}),[]);return(0,l.useEffect)((function(){g(t)}),[f]),(0,s.jsx)(u.Z,(0,i.Z)({value:p,onChange:function(e){g(e.target.value),m(e.target.value)},prefix:(0,s.jsx)(c.Z,{})},v))}},80173:function(e,n,t){t.r(n),t.d(n,{default:function(){return q}});var i=t(4942),r=t(1413),a=t(29439),l=t(47313),u=t(86345),o=t(45705),c=t(59491),s=t(77181),d=t(78508),f=t(74580),v=t(2717),h=t(90954),Z=t(23560),p=t(24511),g=t(7607),m=t(41481),x=t(80314),j=t(79637),y=t(29466),b=t(97890),_=t(12019),S=t(47515),C=t(93433),k=t(10976),w=t(9274),I=t(72652),O=t(68197),B=t(59624),P=t(66672),V=t(73431),z=t(47139),A=t(49655),E=t(27453),F=t(46417);function M(e){var n=e.visible,t=e.setVisible,o=e.id,s=e.setId,d=k.Z.useForm(),f=(0,a.Z)(d,1)[0],h=(0,v.I0)(),m=(0,p.$)().t,x=(0,v.v9)((function(e){return e.formLang}),v.wU),y=x.defaultLang,b=x.languages,_=(0,l.useState)(!1),S=(0,a.Z)(_,2),M=S[0],q=S[1],L=(0,l.useState)(!1),T=(0,a.Z)(L,2),U=T[0],H=T[1],N=(0,l.useState)(null),$=(0,a.Z)(N,2),D=$[0],G=$[1],K=function(){G(null),t(!1),f.resetFields(),s(null)};return(0,l.useEffect)((function(){o&&(H(!0),j.Z.show(o).then((function(e){var n=e.data;G(n),f.setFieldsValue((0,r.Z)({active:null===n||void 0===n?void 0:n.active,country_id:{label:n.country.translation.title,value:n.country.id},region_id:{label:n.region.translation.title,value:n.region.id}},function(e){if(null===e||void 0===e||!e.translations)return{};var n=e.translations,t=b.map((function(e){var t;return(0,i.Z)({},"title[".concat(e.locale,"]"),null===(t=n.find((function(n){return n.locale===e.locale})))||void 0===t?void 0:t.title)}));return Object.assign.apply(Object,[{}].concat((0,C.Z)(t)))}(n)))})).finally((function(){return H(!1)})))}),[o]),(0,F.jsx)(w.Z,{visible:n,onCancel:K,onOk:K,footer:null,loading:U,title:m("add.country"),children:(0,F.jsxs)(k.Z,{form:f,onFinish:function(e){var n,t;q(!0);var a={country_id:null===e||void 0===e||null===(n=e.country_id)||void 0===n?void 0:n.value,region_id:null===e||void 0===e||null===(t=e.region_id)||void 0===t?void 0:t.value,active:e.active,title:(0,r.Z)({},Object.assign.apply(Object,[{}].concat((0,C.Z)(b.map((function(n){return(0,i.Z)({},n.locale,e["title[".concat(n.locale,"]")])}))))))};null!==D&&void 0!==D&&D.id?function(e){j.Z.update(D.id,e).then((function(){Z.Am.success(m("successfully.updated")),(0,v.dC)((function(){h((0,g.B)({}))})),K()})).finally((function(){return q(!1)}))}(a):function(e){j.Z.create(e).then((function(){Z.Am.success(m("successfully.added")),(0,v.dC)((function(){h((0,g.B)({}))})),K()})).finally((function(){return q(!1)}))}(a)},layout:"vertical",initialValues:{active:!0},children:[(0,F.jsx)(I.Z,{spinning:U,children:(0,F.jsxs)(O.Z,{gutter:24,children:[(0,F.jsx)(B.Z,{span:24,children:(0,F.jsx)(V.Z,{})}),(0,F.jsx)(B.Z,{span:24,children:b.map((function(e){return(0,F.jsx)(k.Z.Item,{label:m("title"),name:"title[".concat(e.locale,"]"),hidden:e.locale!==y,rules:[{validator:function(n,t){return t||(null===e||void 0===e?void 0:e.locale)!==y?t&&""===(null===t||void 0===t?void 0:t.trim())?Promise.reject(new Error(m("no.empty.space"))):t&&(null===t||void 0===t?void 0:t.trim().length)<2?Promise.reject(new Error(m("must.be.at.least.2"))):Promise.resolve():Promise.reject(new Error(m("required")))}}],children:(0,F.jsx)(P.Z,{})},"title"+e.id)}))}),(0,F.jsx)(B.Z,{span:24,children:(0,F.jsx)(k.Z.Item,{name:"region_id",label:m("region_id"),rules:[{required:!0,message:m("required")}],children:(0,F.jsx)(A._,{fetchOptions:function(e){var n=e.search,t=e.page;return E.Z.get({search:n,page:t,has_price:!0}).then((function(e){return e.data.map((function(e){var n;return{label:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id}}))}))}})})}),(0,F.jsx)(B.Z,{span:24,children:(0,F.jsx)(k.Z.Item,{name:"country_id",label:m("country_id"),rules:[{required:!0,message:m("required")}],children:(0,F.jsx)(A._,{fetchOptions:function(e){var n=e.search,t=e.page;return z.Z.get({search:n,page:t,has_price:!0}).then((function(e){return e.data.map((function(e){var n;return{label:null===e||void 0===e||null===(n=e.translation)||void 0===n?void 0:n.title,value:e.id}}))}))}})})}),(0,F.jsx)(B.Z,{span:4,children:(0,F.jsx)(k.Z.Item,{label:m("active"),name:"active",valuePropName:"checked",children:(0,F.jsx)(u.Z,{defaultChecked:!0})})})]})}),(0,F.jsx)(c.Z,{type:"primary",htmlType:"submit",loading:M,children:m("submit")})]})})}var q=function(){var e=(0,p.$)().t,n=(0,v.I0)(),t=(0,b.s0)(),C=(0,y.lr)(),k=(0,a.Z)(C,2),w=k[0],I=(k[1],(0,l.useContext)(f._).setIsModalVisible),O=(0,v.v9)((function(e){return e.menu}),v.wU).activeMenu,B=null===O||void 0===O?void 0:O.data,P=w.get("country_id"),V=(0,v.v9)((function(e){return e.deliveryCity}),v.wU),z=V.list,A=V.meta,E=V.loading,q=(0,l.useState)(!1),L=(0,a.Z)(q,2),T=L[0],U=L[1],H=(0,l.useState)(!1),N=(0,a.Z)(H,2),$=N[0],D=N[1],G=(0,l.useState)(!1),K=(0,a.Z)(G,2),J=K[0],Q=K[1],R=(0,l.useState)(null),W=(0,a.Z)(R,2),X=W[0],Y=W[1],ee=[{title:e("id"),dataIndex:"id",key:"id"},{title:e("name"),dataIndex:"translation",key:"translation",render:function(i,r){return(0,F.jsx)("div",{style:{cursor:"pointer",textDecoration:"underline"},onClick:function(){return function(i){n((0,h.bL)({url:"deliveryzone/area?city_id=".concat(i.id),id:"area",name:e("area")})),t("/deliveryzone/area?city_id=".concat(i.id))}(r)},children:(null===i||void 0===i?void 0:i.title)||"-"})}},{title:e("active"),dataIndex:"active",key:"active",render:function(t,i){return(0,F.jsx)(u.Z,{onChange:function(){return function(t){U(t),j.Z.status(t).then((function(){I(!1),n((0,g.B)({country_id:P})),Z.Am.success(e("successfully.updated"))})).finally((function(){U(null)}))}(i.id)},checked:t,loading:Boolean(T===i.id)},i.id)}},{title:e("options"),dataIndex:"options",is_show:!0,render:function(t,i){return(0,F.jsxs)(o.Z,{children:[(0,F.jsx)(c.Z,{type:"primary",icon:(0,F.jsx)(_.Z,{}),onClick:function(){return function(e){D(!0),Y(e)}(i.id)}}),(0,F.jsx)(c.Z,{loading:Boolean(J===i.id),icon:(0,F.jsx)(S.Z,{onClick:function(){return function(t){Q(t),j.Z.delete(t).then((function(){n((0,g.B)()),Z.Am.success(e("successfully.deleted"))})).finally((function(){Q(!1)}))}(i.id)}})})]})}}];(0,l.useEffect)((function(){O.refetch&&(n((0,g.B)({country_id:P})),n((0,h.A_)(O)))}),[O.refetch]),(0,x.Z)((function(){var e={search:null===B||void 0===B?void 0:B.search,country_id:P};n((0,g.B)(e))}),[null===O||void 0===O?void 0:O.data]);return(0,F.jsxs)(s.Z,{title:e("cities"),extra:(0,F.jsxs)(o.Z,{children:[(0,F.jsx)(m.Z,{placeholder:e("search"),handleChange:function(e){return t=e,a="search",void n((0,h.nc)({activeMenu:O,data:(0,r.Z)((0,r.Z)({},B),{},(0,i.Z)({},a,t))}));var t,a},defaultValue:null===B||void 0===B?void 0:B.search,resetSearch:!(null!==B&&void 0!==B&&B.search)}),(0,F.jsx)(c.Z,{type:"primary",onClick:function(){return D(!0)},children:e("add.city")})]}),children:[(0,F.jsx)(d.Z,{columns:ee,dataSource:z,pagination:{pageSize:A.per_page,page:A.current_page,total:A.total},rowKey:function(e){return e.id},loading:E,onChange:function(e){var t=e.pageSize,i=e.current;n((0,g.B)({perPage:t,page:i,country_id:P}))}}),(0,F.jsx)(M,{visible:$,setVisible:D,id:X,setId:Y})]})}}}]);